LearnedRoundingConverter initialized on device: cuda
  - Using optimizer: 'original'
  - Scaling mode: tensor
Scanning model and generating simulated calibration data...
Simulated calibration data generated.

Found 208 weight tensors to potentially process.
(1/208) Skipping tensor: cap_embedder.1.weight (Reason: In high-precision list)
(2/208) Processing tensor: context_refiner.0.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.181e+00, best=2.181e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.172e+00, best=2.172e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.161e+00, best=2.161e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.149e+00, best=2.149e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.135e+00, best=2.135e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.120e+00, best=2.120e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.102e+00, best=2.102e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.082e+00, best=2.082e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.059e+00, best=2.059e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.032e+00, best=2.032e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.002e+00, best=2.002e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.968e+00, best=1.968e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.929e+00, best=1.929e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.885e+00, best=1.885e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.834e+00, best=1.834e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.776e+00, best=1.776e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.710e+00, best=1.710e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.635e+00, best=1.635e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.549e+00, best=1.549e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.452e+00, best=1.452e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.340e+00, best=1.340e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.214e+00, best=1.214e+00, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.069e+00, best=1.069e+00, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.040e-01, best=9.040e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.160e-01, best=7.160e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.017e-01, best=5.017e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.574e-01, best=2.574e-01, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.107e-02, best=2.107e-02, lr=3.17e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.964e-01, best=2.107e-02, lr=2.87e-01, worse_count=1]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=2.964e-01, best=2.107e-02, lr=2.87e-01, worse_count=1]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=9.891e-03, best=9.891e-03, lr=3.27e-01, worse_count=0]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=3.168e-01, best=9.891e-03, lr=2.95e-01, worse_count=1]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=2.196e-02, best=9.891e-03, lr=2.66e-01, worse_count=2]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=2.441e-01, best=9.891e-03, lr=2.40e-01, worse_count=3]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=3.983e-03, best=3.983e-03, lr=2.74e-01, worse_count=0]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=2.698e-01, best=3.983e-03, lr=2.47e-01, worse_count=1]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=2.271e-02, best=3.983e-03, lr=2.23e-01, worse_count=2]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=2.003e-01, best=3.983e-03, lr=2.01e-01, worse_count=3]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=9.678e-04, best=9.678e-04, lr=2.29e-01, worse_count=0]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=2.284e-01, best=9.678e-04, lr=2.07e-01, worse_count=1]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=2.140e-02, best=9.678e-04, lr=1.87e-01, worse_count=2]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=1.654e-01, best=9.678e-04, lr=1.69e-01, worse_count=3]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=3.181e-03, best=9.678e-04, lr=1.52e-01, worse_count=4]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=1.490e-01, best=9.678e-04, lr=1.37e-01, worse_count=5]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=1.166e-02, best=9.678e-04, lr=1.24e-01, worse_count=6]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=1.123e-01, best=9.678e-04, lr=1.12e-01, worse_count=7]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=4.287e-04, best=4.287e-04, lr=1.28e-01, worse_count=0]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=1.271e-01, best=4.287e-04, lr=1.15e-01, worse_count=1]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=1.201e-02, best=4.287e-04, lr=1.04e-01, worse_count=2]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=9.187e-02, best=4.287e-04, lr=9.37e-02, worse_count=3]
    Optimizing (Original):  58%|█████▊    | 29/50 [00:00<00:00, 287.16it/s, loss=1.878e-03, best=4.287e-04, lr=8.46e-02, worse_count=4]
                                                                                                                                       
(3/208) Processing tensor: context_refiner.0.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.818e+00, best=1.818e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.809e+00, best=1.809e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.797e+00, best=1.797e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.783e+00, best=1.783e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.766e+00, best=1.766e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.746e+00, best=1.746e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.722e+00, best=1.722e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.693e+00, best=1.693e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.658e+00, best=1.658e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.616e+00, best=1.616e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.566e+00, best=1.566e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.506e+00, best=1.506e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.434e+00, best=1.434e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.347e+00, best=1.347e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.243e+00, best=1.243e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.118e+00, best=1.118e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=1.118e+00, best=1.118e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=9.687e-01, best=9.687e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=7.890e-01, best=7.890e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=5.734e-01, best=5.734e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=3.147e-01, best=3.147e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=4.202e-03, best=4.202e-03, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=3.684e-01, best=4.202e-03, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=1.443e-02, best=4.202e-03, lr=3.36e-01, worse_count=2]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=3.218e-01, best=4.202e-03, lr=3.19e-01, worse_count=3]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=2.386e-03, best=2.386e-03, lr=3.83e-01, worse_count=0]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=3.809e-01, best=2.386e-03, lr=3.64e-01, worse_count=1]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=1.678e-02, best=2.386e-03, lr=3.46e-01, worse_count=2]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=3.292e-01, best=2.386e-03, lr=3.29e-01, worse_count=3]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=5.174e-04, best=5.174e-04, lr=3.94e-01, worse_count=0]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=3.939e-01, best=5.174e-04, lr=3.75e-01, worse_count=1]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=1.920e-02, best=5.174e-04, lr=3.56e-01, worse_count=2]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=3.367e-01, best=5.174e-04, lr=3.38e-01, worse_count=3]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=1.405e-03, best=5.174e-04, lr=3.21e-01, worse_count=4]
    Optimizing (Original):  32%|███▏      | 16/50 [00:00<00:00, 155.99it/s, loss=3.198e-01, best=5.174e-04, lr=3.05e-01, worse_count=5]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=3.198e-01, best=5.174e-04, lr=3.05e-01, worse_count=5]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=1.466e-02, best=5.174e-04, lr=2.90e-01, worse_count=6]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=2.753e-01, best=5.174e-04, lr=2.75e-01, worse_count=7]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=1.612e-04, best=1.612e-04, lr=3.30e-01, worse_count=0]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=3.303e-01, best=1.612e-04, lr=3.14e-01, worse_count=1]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=1.636e-02, best=1.612e-04, lr=2.98e-01, worse_count=2]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=2.819e-01, best=1.612e-04, lr=2.83e-01, worse_count=3]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=1.450e-03, best=1.612e-04, lr=2.69e-01, worse_count=4]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=2.677e-01, best=1.612e-04, lr=2.56e-01, worse_count=5]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=1.201e-02, best=1.612e-04, lr=2.43e-01, worse_count=6]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=2.309e-01, best=1.612e-04, lr=2.31e-01, worse_count=7]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=1.381e-04, best=1.381e-04, lr=2.77e-01, worse_count=0]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=2.768e-01, best=1.381e-04, lr=2.63e-01, worse_count=1]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=1.371e-02, best=1.381e-04, lr=2.50e-01, worse_count=2]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=2.362e-01, best=1.381e-04, lr=2.37e-01, worse_count=3]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=1.212e-03, best=1.381e-04, lr=2.26e-01, worse_count=4]
    Optimizing (Original):  68%|██████▊   | 34/50 [00:00<00:00, 166.50it/s, loss=2.244e-01, best=1.381e-04, lr=2.14e-01, worse_count=5]
                                                                                                                                       
(4/208) Processing tensor: context_refiner.0.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.934e+00, best=1.934e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.925e+00, best=1.925e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.913e+00, best=1.913e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.899e+00, best=1.899e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.882e+00, best=1.882e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.862e+00, best=1.862e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.838e+00, best=1.838e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.809e+00, best=1.809e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.774e+00, best=1.774e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.732e+00, best=1.732e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.682e+00, best=1.682e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.622e+00, best=1.622e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.550e+00, best=1.550e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.463e+00, best=1.463e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.359e+00, best=1.359e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.234e+00, best=1.234e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.085e+00, best=1.085e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.049e-01, best=9.049e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.893e-01, best=6.893e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.306e-01, best=4.306e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=4.306e-01, best=4.306e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=1.201e-01, best=1.201e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=2.525e-01, best=1.201e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=1.015e-01, best=1.015e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=3.233e-01, best=1.015e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=8.025e-02, best=8.025e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=4.040e-01, best=8.025e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=5.604e-02, best=5.604e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=4.960e-01, best=5.604e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=2.844e-02, best=2.844e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=6.008e-01, best=2.844e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=3.024e-03, best=3.024e-03, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=7.143e-01, best=3.024e-03, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=3.284e-02, best=3.024e-03, lr=6.47e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=6.146e-01, best=3.024e-03, lr=6.15e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=4.742e-04, best=4.742e-04, lr=7.38e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=7.376e-01, best=4.742e-04, lr=7.01e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=3.643e-02, best=4.742e-04, lr=6.66e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=6.297e-01, best=4.742e-04, lr=6.33e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=3.124e-03, best=4.742e-04, lr=6.01e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.11it/s, loss=5.980e-01, best=4.742e-04, lr=5.71e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.98it/s, loss=5.980e-01, best=4.742e-04, lr=5.71e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.98it/s, loss=2.693e-02, best=4.742e-04, lr=5.43e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.98it/s, loss=5.156e-01, best=4.742e-04, lr=5.15e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.98it/s, loss=1.944e-04, best=1.944e-04, lr=6.18e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.98it/s, loss=6.183e-01, best=1.944e-04, lr=5.88e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.98it/s, loss=3.073e-02, best=1.944e-04, lr=5.58e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.98it/s, loss=5.275e-01, best=1.944e-04, lr=5.30e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.98it/s, loss=2.821e-03, best=1.944e-04, lr=5.04e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.98it/s, loss=5.009e-01, best=1.944e-04, lr=4.79e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.98it/s, loss=2.237e-02, best=1.944e-04, lr=4.55e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.98it/s, loss=4.323e-01, best=1.944e-04, lr=4.32e-01, worse_count=7]
                                                                                                                                       
(5/208) Processing tensor: context_refiner.0.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.850e+00, best=1.850e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.840e+00, best=1.840e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.829e+00, best=1.829e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.815e+00, best=1.815e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.798e+00, best=1.798e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.778e+00, best=1.778e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.754e+00, best=1.754e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.725e+00, best=1.725e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.690e+00, best=1.690e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.648e+00, best=1.648e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.598e+00, best=1.598e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.538e+00, best=1.538e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.465e+00, best=1.465e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.379e+00, best=1.379e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.275e+00, best=1.275e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.150e+00, best=1.150e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.000e+00, best=1.000e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.206e-01, best=8.206e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.050e-01, best=6.050e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=6.050e-01, best=6.050e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=3.462e-01, best=3.462e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=3.573e-02, best=3.573e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=3.368e-01, best=3.573e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=1.710e-02, best=1.710e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=4.076e-01, best=1.710e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=4.135e-03, best=4.135e-03, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=4.801e-01, best=4.135e-03, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=2.008e-02, best=4.135e-03, lr=4.37e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=4.169e-01, best=4.135e-03, lr=4.15e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=1.774e-03, best=1.774e-03, lr=4.98e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=4.964e-01, best=1.774e-03, lr=4.73e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=2.313e-02, best=1.774e-03, lr=4.50e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=4.265e-01, best=1.774e-03, lr=4.27e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=6.546e-04, best=6.546e-04, lr=5.13e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=5.119e-01, best=6.546e-04, lr=4.87e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=2.497e-02, best=6.546e-04, lr=4.63e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=4.376e-01, best=6.546e-04, lr=4.39e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=1.844e-03, best=6.546e-04, lr=4.17e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=4.156e-01, best=6.546e-04, lr=3.97e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.01it/s, loss=1.903e-02, best=6.546e-04, lr=3.77e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.79it/s, loss=1.903e-02, best=6.546e-04, lr=3.77e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.79it/s, loss=3.577e-01, best=6.546e-04, lr=3.58e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.79it/s, loss=1.916e-04, best=1.916e-04, lr=4.29e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.79it/s, loss=4.293e-01, best=1.916e-04, lr=4.08e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.79it/s, loss=2.128e-02, best=1.916e-04, lr=3.88e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.79it/s, loss=3.664e-01, best=1.916e-04, lr=3.68e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.79it/s, loss=1.902e-03, best=1.916e-04, lr=3.50e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.79it/s, loss=3.479e-01, best=1.916e-04, lr=3.32e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.79it/s, loss=1.559e-02, best=1.916e-04, lr=3.16e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.79it/s, loss=3.001e-01, best=1.916e-04, lr=3.00e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.79it/s, loss=1.972e-04, best=1.916e-04, lr=2.85e-01, worse_count=8]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.79it/s, loss=2.848e-01, best=1.916e-04, lr=2.71e-01, worse_count=9]
                                                                                                                                       
(6/208) Processing tensor: context_refiner.0.feed_forward.w3.weight

    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.222e+00, best=2.222e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.212e+00, best=2.212e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.201e+00, best=2.201e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.187e+00, best=2.187e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.170e+00, best=2.170e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.150e+00, best=2.150e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.125e+00, best=2.125e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.096e+00, best=2.096e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.062e+00, best=2.062e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.020e+00, best=2.020e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.970e+00, best=1.970e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.910e+00, best=1.910e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.837e+00, best=1.837e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.751e+00, best=1.751e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.647e+00, best=1.647e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.522e+00, best=1.522e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.372e+00, best=1.372e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.193e+00, best=1.193e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.769e-01, best=9.769e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.182e-01, best=7.182e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=7.182e-01, best=7.182e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=4.077e-01, best=4.077e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=3.512e-02, best=3.512e-02, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=4.120e-01, best=3.512e-02, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=1.276e-02, best=1.276e-02, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=4.969e-01, best=1.276e-02, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=1.272e-02, best=1.272e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=5.683e-01, best=1.272e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=1.633e-02, best=1.272e-02, lr=5.24e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=5.081e-01, best=1.272e-02, lr=4.98e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=9.887e-03, best=9.887e-03, lr=5.98e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=5.879e-01, best=9.887e-03, lr=5.68e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=2.000e-02, best=9.887e-03, lr=5.39e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=5.195e-01, best=9.887e-03, lr=5.13e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=6.972e-03, best=6.972e-03, lr=6.15e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=6.081e-01, best=6.972e-03, lr=5.84e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=2.378e-02, best=6.972e-03, lr=5.55e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=5.313e-01, best=6.972e-03, lr=5.27e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=3.974e-03, best=3.974e-03, lr=6.33e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=6.288e-01, best=3.974e-03, lr=6.01e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.61it/s, loss=2.767e-02, best=3.974e-03, lr=5.71e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.25it/s, loss=2.767e-02, best=3.974e-03, lr=5.71e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.25it/s, loss=5.434e-01, best=3.974e-03, lr=5.43e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.25it/s, loss=8.895e-04, best=8.895e-04, lr=6.51e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.25it/s, loss=6.502e-01, best=8.895e-04, lr=6.18e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.25it/s, loss=3.166e-02, best=8.895e-04, lr=5.88e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.25it/s, loss=5.559e-01, best=8.895e-04, lr=5.58e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.25it/s, loss=2.284e-03, best=8.895e-04, lr=5.30e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.25it/s, loss=5.280e-01, best=8.895e-04, lr=5.04e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.25it/s, loss=2.423e-02, best=8.895e-04, lr=4.79e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.25it/s, loss=4.544e-01, best=8.895e-04, lr=4.55e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.25it/s, loss=3.012e-04, best=3.012e-04, lr=5.46e-01, worse_count=0]
                                                                                                                                       
(7/208) Processing tensor: context_refiner.1.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.005e+00, best=2.005e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.996e+00, best=1.996e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.985e+00, best=1.985e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.973e+00, best=1.973e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.959e+00, best=1.959e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.944e+00, best=1.944e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.926e+00, best=1.926e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.906e+00, best=1.906e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.883e+00, best=1.883e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.856e+00, best=1.856e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.826e+00, best=1.826e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.792e+00, best=1.792e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.753e+00, best=1.753e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.708e+00, best=1.708e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.658e+00, best=1.658e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.600e+00, best=1.600e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.534e+00, best=1.534e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.459e+00, best=1.459e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.373e+00, best=1.373e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.276e+00, best=1.276e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.164e+00, best=1.164e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.037e+00, best=1.037e+00, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.929e-01, best=8.929e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.280e-01, best=7.280e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.400e-01, best=5.400e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.257e-01, best=3.257e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.137e-02, best=8.137e-02, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.971e-01, best=8.137e-02, lr=2.51e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.422e-02, best=5.422e-02, lr=2.87e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.323e-01, best=5.422e-02, lr=2.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.628e-02, best=2.628e-02, lr=2.95e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.685e-01, best=2.628e-02, lr=2.66e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.462e-03, best=2.462e-03, lr=3.03e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.008e-01, best=2.462e-03, lr=2.74e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.711e-02, best=2.462e-03, lr=2.47e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.199e-01, best=2.462e-03, lr=2.23e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.024e-03, best=2.462e-03, lr=2.01e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.982e-01, best=2.462e-03, lr=1.82e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.660e-02, best=2.462e-03, lr=1.64e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.473e-01, best=2.462e-03, lr=1.48e-01, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.154e-04, best=6.154e-04, lr=1.69e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.680e-01, best=6.154e-04, lr=1.52e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.583e-02, best=6.154e-04, lr=1.37e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.215e-01, best=6.154e-04, lr=1.24e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.434e-03, best=6.154e-04, lr=1.12e-01, worse_count=4]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 444.33it/s, loss=2.434e-03, best=6.154e-04, lr=1.12e-01, worse_count=4]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 444.33it/s, loss=1.094e-01, best=6.154e-04, lr=1.01e-01, worse_count=5]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 444.33it/s, loss=8.473e-03, best=6.154e-04, lr=9.11e-02, worse_count=6]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 444.33it/s, loss=8.265e-02, best=6.154e-04, lr=8.22e-02, worse_count=7]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 444.33it/s, loss=4.111e-04, best=4.111e-04, lr=9.37e-02, worse_count=0]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 444.33it/s, loss=9.334e-02, best=4.111e-04, lr=8.46e-02, worse_count=1]
                                                                                                                                       
(8/208) Processing tensor: context_refiner.1.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.926e+00, best=1.926e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.916e+00, best=1.916e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.904e+00, best=1.904e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.890e+00, best=1.890e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.874e+00, best=1.874e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.853e+00, best=1.853e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.829e+00, best=1.829e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.800e+00, best=1.800e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.765e+00, best=1.765e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.724e+00, best=1.724e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.674e+00, best=1.674e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.613e+00, best=1.613e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.541e+00, best=1.541e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.454e+00, best=1.454e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.350e+00, best=1.350e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.226e+00, best=1.226e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.076e+00, best=1.076e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.963e-01, best=8.963e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=8.963e-01, best=8.963e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=6.807e-01, best=6.807e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=4.220e-01, best=4.220e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=1.115e-01, best=1.115e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=2.611e-01, best=1.115e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=9.286e-02, best=9.286e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=3.319e-01, best=9.286e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=7.162e-02, best=7.162e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=4.126e-01, best=7.162e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=4.741e-02, best=4.741e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=5.046e-01, best=4.741e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=1.981e-02, best=1.981e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=6.095e-01, best=1.981e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=1.165e-02, best=1.165e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=7.057e-01, best=1.165e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=2.422e-02, best=1.165e-02, lr=6.47e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=6.232e-01, best=1.165e-02, lr=6.15e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=8.153e-03, best=8.153e-03, lr=7.38e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.18it/s, loss=7.299e-01, best=8.153e-03, lr=7.01e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.53it/s, loss=7.299e-01, best=8.153e-03, lr=7.01e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.53it/s, loss=2.875e-02, best=8.153e-03, lr=6.66e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.53it/s, loss=6.373e-01, best=8.153e-03, lr=6.33e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.53it/s, loss=4.555e-03, best=4.555e-03, lr=7.59e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.53it/s, loss=7.548e-01, best=4.555e-03, lr=7.21e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.53it/s, loss=3.341e-02, best=4.555e-03, lr=6.85e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.53it/s, loss=6.519e-01, best=4.555e-03, lr=6.51e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.53it/s, loss=8.540e-04, best=8.540e-04, lr=7.81e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.53it/s, loss=7.804e-01, best=8.540e-04, lr=7.42e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.53it/s, loss=3.821e-02, best=8.540e-04, lr=7.05e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.53it/s, loss=6.669e-01, best=8.540e-04, lr=6.70e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.53it/s, loss=2.955e-03, best=8.540e-04, lr=6.36e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.53it/s, loss=6.334e-01, best=8.540e-04, lr=6.04e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.53it/s, loss=2.886e-02, best=8.540e-04, lr=5.74e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.53it/s, loss=5.454e-01, best=8.540e-04, lr=5.46e-01, worse_count=7]
                                                                                                                                       
(9/208) Processing tensor: context_refiner.1.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.939e+00, best=1.939e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.929e+00, best=1.929e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.917e+00, best=1.917e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.903e+00, best=1.903e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.886e+00, best=1.886e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.866e+00, best=1.866e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.842e+00, best=1.842e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.813e+00, best=1.813e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.778e+00, best=1.778e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.736e+00, best=1.736e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.686e+00, best=1.686e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.626e+00, best=1.626e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.554e+00, best=1.554e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.467e+00, best=1.467e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.363e+00, best=1.363e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.239e+00, best=1.239e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.089e+00, best=1.089e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.091e-01, best=9.091e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.935e-01, best=6.935e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.348e-01, best=4.348e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=4.348e-01, best=4.348e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=1.243e-01, best=1.243e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=2.483e-01, best=1.243e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=1.056e-01, best=1.056e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=3.191e-01, best=1.056e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=8.441e-02, best=8.441e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=3.998e-01, best=8.441e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=6.020e-02, best=6.020e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=4.918e-01, best=6.020e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=3.260e-02, best=3.260e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=5.967e-01, best=3.260e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=1.136e-03, best=1.136e-03, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=7.162e-01, best=1.136e-03, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=3.473e-02, best=1.136e-03, lr=6.47e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=6.127e-01, best=1.136e-03, lr=6.15e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=2.361e-03, best=1.136e-03, lr=5.84e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=5.819e-01, best=1.136e-03, lr=5.55e-01, worse_count=5]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=2.685e-02, best=1.136e-03, lr=5.27e-01, worse_count=6]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=5.005e-01, best=1.136e-03, lr=5.01e-01, worse_count=7]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=4.875e-04, best=4.875e-04, lr=6.01e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.32it/s, loss=6.007e-01, best=4.875e-04, lr=5.71e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.12it/s, loss=6.007e-01, best=4.875e-04, lr=5.71e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.12it/s, loss=2.957e-02, best=4.875e-04, lr=5.43e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.12it/s, loss=5.130e-01, best=4.875e-04, lr=5.15e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.12it/s, loss=2.443e-03, best=4.875e-04, lr=4.90e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.12it/s, loss=4.872e-01, best=4.875e-04, lr=4.65e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.12it/s, loss=2.204e-02, best=4.875e-04, lr=4.42e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.12it/s, loss=4.199e-01, best=4.875e-04, lr=4.20e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.12it/s, loss=5.822e-05, best=5.822e-05, lr=5.04e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.12it/s, loss=5.037e-01, best=5.822e-05, lr=4.79e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.12it/s, loss=2.513e-02, best=5.822e-05, lr=4.55e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.12it/s, loss=4.295e-01, best=5.822e-05, lr=4.32e-01, worse_count=3]
                                                                                                                                       
(10/208) Processing tensor: context_refiner.1.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.889e+00, best=1.889e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.880e+00, best=1.880e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.868e+00, best=1.868e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.854e+00, best=1.854e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.837e+00, best=1.837e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.817e+00, best=1.817e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.793e+00, best=1.793e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.764e+00, best=1.764e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.729e+00, best=1.729e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.687e+00, best=1.687e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.637e+00, best=1.637e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.577e+00, best=1.577e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.505e+00, best=1.505e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.418e+00, best=1.418e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.314e+00, best=1.314e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.189e+00, best=1.189e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.039e+00, best=1.039e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.598e-01, best=8.598e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.441e-01, best=6.441e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=6.441e-01, best=6.441e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=3.854e-01, best=3.854e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=7.493e-02, best=7.493e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=2.977e-01, best=7.493e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=5.630e-02, best=5.630e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=3.684e-01, best=5.630e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=3.506e-02, best=3.506e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=4.491e-01, best=3.506e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=1.085e-02, best=1.085e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=5.411e-01, best=1.085e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=1.675e-02, best=1.085e-02, lr=4.98e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=4.814e-01, best=1.085e-02, lr=4.73e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=8.160e-03, best=8.160e-03, lr=5.68e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=5.598e-01, best=8.160e-03, lr=5.39e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=2.024e-02, best=8.160e-03, lr=5.13e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=4.923e-01, best=8.160e-03, lr=4.87e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=5.391e-03, best=5.391e-03, lr=5.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=5.789e-01, best=5.391e-03, lr=5.55e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=2.382e-02, best=5.391e-03, lr=5.27e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.62it/s, loss=5.035e-01, best=5.391e-03, lr=5.01e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.15it/s, loss=5.035e-01, best=5.391e-03, lr=5.01e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.15it/s, loss=2.543e-03, best=2.543e-03, lr=6.01e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.15it/s, loss=5.986e-01, best=2.543e-03, lr=5.71e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.15it/s, loss=2.752e-02, best=2.543e-03, lr=5.43e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.15it/s, loss=5.150e-01, best=2.543e-03, lr=5.15e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.15it/s, loss=3.881e-04, best=3.881e-04, lr=6.18e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.15it/s, loss=6.181e-01, best=3.881e-04, lr=5.88e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.15it/s, loss=3.054e-02, best=3.881e-04, lr=5.58e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.15it/s, loss=5.277e-01, best=3.881e-04, lr=5.30e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.15it/s, loss=2.627e-03, best=3.881e-04, lr=5.04e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.15it/s, loss=5.012e-01, best=3.881e-04, lr=4.79e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.15it/s, loss=2.256e-02, best=3.881e-04, lr=4.55e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.15it/s, loss=4.321e-01, best=3.881e-04, lr=4.32e-01, worse_count=7]
                                                                                                                                       
(11/208) Processing tensor: context_refiner.1.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.272e+00, best=2.272e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.262e+00, best=2.262e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.250e+00, best=2.250e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.236e+00, best=2.236e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.220e+00, best=2.220e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.199e+00, best=2.199e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.175e+00, best=2.175e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.146e+00, best=2.146e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.111e+00, best=2.111e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.070e+00, best=2.070e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.019e+00, best=2.019e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.959e+00, best=1.959e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.887e+00, best=1.887e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.800e+00, best=1.800e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.696e+00, best=1.696e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.572e+00, best=1.572e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.422e+00, best=1.422e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.242e+00, best=1.242e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.027e+00, best=1.027e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.679e-01, best=7.679e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=7.679e-01, best=7.679e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=4.574e-01, best=4.574e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=8.485e-02, best=8.485e-02, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=3.622e-01, best=8.485e-02, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=6.250e-02, best=6.250e-02, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=4.472e-01, best=6.250e-02, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=3.701e-02, best=3.701e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=5.440e-01, best=3.701e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=7.961e-03, best=7.961e-03, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=6.544e-01, best=7.961e-03, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=2.516e-02, best=7.961e-03, lr=5.98e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=5.726e-01, best=7.961e-03, lr=5.68e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=4.732e-03, best=4.732e-03, lr=6.81e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=6.768e-01, best=4.732e-03, lr=6.47e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=2.934e-02, best=4.732e-03, lr=6.15e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=5.857e-01, best=4.732e-03, lr=5.84e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=1.410e-03, best=1.410e-03, lr=7.01e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=6.997e-01, best=1.410e-03, lr=6.66e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=3.365e-02, best=1.410e-03, lr=6.33e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=5.991e-01, best=1.410e-03, lr=6.01e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.84it/s, loss=2.008e-03, best=1.410e-03, lr=5.71e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.04it/s, loss=2.008e-03, best=1.410e-03, lr=5.71e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.04it/s, loss=5.691e-01, best=1.410e-03, lr=5.43e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.04it/s, loss=2.655e-02, best=1.410e-03, lr=5.15e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.04it/s, loss=4.889e-01, best=1.410e-03, lr=4.90e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.04it/s, loss=7.763e-04, best=7.763e-04, lr=5.88e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.04it/s, loss=5.868e-01, best=7.763e-04, lr=5.58e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.04it/s, loss=2.860e-02, best=7.763e-04, lr=5.30e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.04it/s, loss=5.017e-01, best=7.763e-04, lr=5.04e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.04it/s, loss=2.088e-03, best=7.763e-04, lr=4.79e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.04it/s, loss=4.765e-01, best=7.763e-04, lr=4.55e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.04it/s, loss=2.184e-02, best=7.763e-04, lr=4.32e-01, worse_count=6]
                                                                                                                                       
(12/208) Skipping tensor: final_layer.adaLN_modulation.1.weight (Reason: In high-precision list)
(13/208) Skipping tensor: final_layer.linear.weight (Reason: In high-precision list)
(14/208) Skipping tensor: layers.0.adaLN_modulation.0.weight (Reason: In high-precision list)
(15/208) Processing tensor: layers.0.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.399e+00, best=1.399e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.390e+00, best=1.390e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.380e+00, best=1.380e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.368e+00, best=1.368e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.354e+00, best=1.354e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.338e+00, best=1.338e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.321e+00, best=1.321e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.300e+00, best=1.300e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.277e+00, best=1.277e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.251e+00, best=1.251e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.221e+00, best=1.221e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.187e+00, best=1.187e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.148e+00, best=1.148e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.103e+00, best=1.103e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.052e+00, best=1.052e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.946e-01, best=9.946e-01, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.287e-01, best=9.287e-01, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.536e-01, best=8.536e-01, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.679e-01, best=7.679e-01, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.703e-01, best=6.703e-01, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.590e-01, best=5.590e-01, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.321e-01, best=4.321e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.875e-01, best=2.875e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.226e-01, best=1.226e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.539e-02, best=6.539e-02, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.489e-01, best=6.539e-02, lr=1.93e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.450e-02, best=4.450e-02, lr=2.20e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.760e-01, best=4.450e-02, lr=1.99e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.300e-02, best=2.300e-02, lr=2.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.038e-01, best=2.300e-02, lr=2.05e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.832e-04, best=8.832e-04, lr=2.33e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.325e-01, best=8.832e-04, lr=2.11e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.187e-02, best=8.832e-04, lr=1.90e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.682e-01, best=8.832e-04, lr=1.72e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.338e-03, best=8.832e-04, lr=1.55e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.515e-01, best=8.832e-04, lr=1.40e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.176e-02, best=8.832e-04, lr=1.26e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.144e-01, best=8.832e-04, lr=1.14e-01, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.374e-04, best=5.374e-04, lr=1.30e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.292e-01, best=5.374e-04, lr=1.17e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.211e-02, best=5.374e-04, lr=1.06e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.357e-02, best=5.374e-04, lr=9.54e-02, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.809e-03, best=5.374e-04, lr=8.61e-02, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.427e-02, best=5.374e-04, lr=7.77e-02, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.583e-03, best=5.374e-04, lr=7.01e-02, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.353e-02, best=5.374e-04, lr=6.33e-02, worse_count=7]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 459.74it/s, loss=6.353e-02, best=5.374e-04, lr=6.33e-02, worse_count=7]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 459.74it/s, loss=2.524e-04, best=2.524e-04, lr=7.21e-02, worse_count=0]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 459.74it/s, loss=7.188e-02, best=2.524e-04, lr=6.51e-02, worse_count=1]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 459.74it/s, loss=6.781e-03, best=2.524e-04, lr=5.88e-02, worse_count=2]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 459.74it/s, loss=5.197e-02, best=2.524e-04, lr=5.30e-02, worse_count=3]
                                                                                                                                       
(16/208) Processing tensor: layers.0.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.695e+00, best=1.695e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.686e+00, best=1.686e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.674e+00, best=1.674e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.660e+00, best=1.660e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.643e+00, best=1.643e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.623e+00, best=1.623e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.599e+00, best=1.599e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.570e+00, best=1.570e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.535e+00, best=1.535e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.493e+00, best=1.493e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.443e+00, best=1.443e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.383e+00, best=1.383e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.311e+00, best=1.311e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.224e+00, best=1.224e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.120e+00, best=1.120e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.954e-01, best=9.954e-01, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.456e-01, best=8.456e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.660e-01, best=6.660e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=6.660e-01, best=6.660e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=4.503e-01, best=4.503e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=1.916e-01, best=1.916e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=1.189e-01, best=1.189e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=2.537e-01, best=1.189e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=1.002e-01, best=1.002e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=3.245e-01, best=1.002e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=7.899e-02, best=7.899e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=4.052e-01, best=7.899e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=5.478e-02, best=5.478e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=4.972e-01, best=5.478e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=2.718e-02, best=2.718e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=6.021e-01, best=2.718e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=4.280e-03, best=4.280e-03, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=7.131e-01, best=4.280e-03, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=3.159e-02, best=4.280e-03, lr=6.47e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=6.158e-01, best=4.280e-03, lr=6.15e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=7.828e-04, best=7.828e-04, lr=7.38e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.74it/s, loss=7.373e-01, best=7.828e-04, lr=7.01e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.55it/s, loss=7.373e-01, best=7.828e-04, lr=7.01e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.55it/s, loss=3.612e-02, best=7.828e-04, lr=6.66e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.55it/s, loss=6.300e-01, best=7.828e-04, lr=6.33e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.55it/s, loss=2.815e-03, best=7.828e-04, lr=6.01e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.55it/s, loss=5.983e-01, best=7.828e-04, lr=5.71e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.55it/s, loss=2.724e-02, best=7.828e-04, lr=5.43e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.55it/s, loss=5.153e-01, best=7.828e-04, lr=5.15e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.55it/s, loss=1.172e-04, best=1.172e-04, lr=6.18e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.55it/s, loss=6.184e-01, best=1.172e-04, lr=5.88e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.55it/s, loss=3.081e-02, best=1.172e-04, lr=5.58e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.55it/s, loss=5.274e-01, best=1.172e-04, lr=5.30e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.55it/s, loss=2.898e-03, best=1.172e-04, lr=5.04e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.55it/s, loss=5.009e-01, best=1.172e-04, lr=4.79e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.55it/s, loss=2.229e-02, best=1.172e-04, lr=4.55e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.55it/s, loss=4.324e-01, best=1.172e-04, lr=4.32e-01, worse_count=7]
                                                                                                                                       
(17/208) Processing tensor: layers.0.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.819e+00, best=1.819e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.809e+00, best=1.809e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.797e+00, best=1.797e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.783e+00, best=1.783e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.766e+00, best=1.766e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.746e+00, best=1.746e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.722e+00, best=1.722e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.693e+00, best=1.693e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.658e+00, best=1.658e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.616e+00, best=1.616e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.566e+00, best=1.566e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.506e+00, best=1.506e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.434e+00, best=1.434e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.347e+00, best=1.347e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.243e+00, best=1.243e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.119e+00, best=1.119e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.688e-01, best=9.688e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.891e-01, best=7.891e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.735e-01, best=5.735e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.147e-01, best=3.147e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=3.147e-01, best=3.147e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=4.266e-03, best=4.266e-03, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=3.683e-01, best=4.266e-03, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=1.436e-02, best=4.266e-03, lr=3.36e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=3.219e-01, best=4.266e-03, lr=3.19e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=2.449e-03, best=2.449e-03, lr=3.83e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=3.809e-01, best=2.449e-03, lr=3.64e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=1.672e-02, best=2.449e-03, lr=3.46e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=3.292e-01, best=2.449e-03, lr=3.29e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=5.809e-04, best=5.809e-04, lr=3.94e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=3.938e-01, best=5.809e-04, lr=3.75e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=1.914e-02, best=5.809e-04, lr=3.56e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=3.368e-01, best=5.809e-04, lr=3.38e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=1.342e-03, best=5.809e-04, lr=3.21e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=3.199e-01, best=5.809e-04, lr=3.05e-01, worse_count=5]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=1.472e-02, best=5.809e-04, lr=2.90e-01, worse_count=6]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=2.752e-01, best=5.809e-04, lr=2.75e-01, worse_count=7]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=2.245e-04, best=2.245e-04, lr=3.30e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=3.303e-01, best=2.245e-04, lr=3.14e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=1.630e-02, best=2.245e-04, lr=2.98e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.68it/s, loss=2.820e-01, best=2.245e-04, lr=2.83e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.16it/s, loss=2.820e-01, best=2.245e-04, lr=2.83e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.16it/s, loss=1.387e-03, best=2.245e-04, lr=2.69e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.16it/s, loss=2.678e-01, best=2.245e-04, lr=2.56e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.16it/s, loss=1.207e-02, best=2.245e-04, lr=2.43e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.16it/s, loss=2.309e-01, best=2.245e-04, lr=2.31e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.16it/s, loss=7.500e-05, best=7.500e-05, lr=2.77e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.16it/s, loss=2.769e-01, best=7.500e-05, lr=2.63e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.16it/s, loss=1.377e-02, best=7.500e-05, lr=2.50e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.16it/s, loss=2.362e-01, best=7.500e-05, lr=2.37e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.16it/s, loss=1.275e-03, best=7.500e-05, lr=2.26e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.16it/s, loss=2.243e-01, best=7.500e-05, lr=2.14e-01, worse_count=5]
                                                                                                                                       
(18/208) Processing tensor: layers.0.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.820e+00, best=1.820e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.810e+00, best=1.810e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.798e+00, best=1.798e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.784e+00, best=1.784e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.768e+00, best=1.768e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.748e+00, best=1.748e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.723e+00, best=1.723e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.694e+00, best=1.694e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.660e+00, best=1.660e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.618e+00, best=1.618e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.568e+00, best=1.568e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.507e+00, best=1.507e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.435e+00, best=1.435e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.349e+00, best=1.349e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.245e+00, best=1.245e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.120e+00, best=1.120e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.701e-01, best=9.701e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.904e-01, best=7.904e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.748e-01, best=5.748e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=5.748e-01, best=5.748e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=3.161e-01, best=3.161e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=5.599e-03, best=5.599e-03, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=3.670e-01, best=5.599e-03, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=1.303e-02, best=5.599e-03, lr=3.36e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=3.232e-01, best=5.599e-03, lr=3.19e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=3.783e-03, best=3.783e-03, lr=3.83e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=3.795e-01, best=3.783e-03, lr=3.64e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=1.538e-02, best=3.783e-03, lr=3.46e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=3.306e-01, best=3.783e-03, lr=3.29e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=1.914e-03, best=1.914e-03, lr=3.94e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=3.925e-01, best=1.914e-03, lr=3.75e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=1.781e-02, best=1.914e-03, lr=3.56e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=3.381e-01, best=1.914e-03, lr=3.38e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=1.785e-05, best=1.785e-05, lr=4.06e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=4.057e-01, best=1.785e-05, lr=3.85e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=2.027e-02, best=1.785e-05, lr=3.66e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=3.459e-01, best=1.785e-05, lr=3.48e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=1.961e-03, best=1.785e-05, lr=3.30e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=3.285e-01, best=1.785e-05, lr=3.14e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.18it/s, loss=1.456e-02, best=1.785e-05, lr=2.98e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.54it/s, loss=1.456e-02, best=1.785e-05, lr=2.98e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.54it/s, loss=2.837e-01, best=1.785e-05, lr=2.83e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.54it/s, loss=3.498e-04, best=1.785e-05, lr=2.69e-01, worse_count=8]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.54it/s, loss=2.688e-01, best=1.785e-05, lr=2.56e-01, worse_count=9]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.54it/s, loss=1.311e-02, best=1.785e-05, lr=2.43e-01, worse_count=10]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.54it/s, loss=2.298e-01, best=1.785e-05, lr=2.31e-01, worse_count=11]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.54it/s, loss=9.626e-04, best=1.785e-05, lr=2.19e-01, worse_count=12]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.54it/s, loss=2.183e-01, best=1.785e-05, lr=2.08e-01, worse_count=13]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.54it/s, loss=1.000e-02, best=1.785e-05, lr=1.98e-01, worse_count=14]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.54it/s, loss=1.879e-01, best=1.785e-05, lr=1.88e-01, worse_count=15]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.54it/s, loss=1.070e-04, best=1.785e-05, lr=1.79e-01, worse_count=16]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.54it/s, loss=1.785e-01, best=1.785e-05, lr=1.70e-01, worse_count=17]
                                                                                                                                        
(19/208) Processing tensor: layers.0.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.423e+00, best=2.423e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.414e+00, best=2.414e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.402e+00, best=2.402e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.388e+00, best=2.388e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.371e+00, best=2.371e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.351e+00, best=2.351e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.327e+00, best=2.327e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.298e+00, best=2.298e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.263e+00, best=2.263e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.221e+00, best=2.221e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.171e+00, best=2.171e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.111e+00, best=2.111e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.039e+00, best=2.039e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.952e+00, best=1.952e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.848e+00, best=1.848e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.723e+00, best=1.723e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.574e+00, best=1.574e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.394e+00, best=1.394e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.178e+00, best=1.178e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=1.178e+00, best=1.178e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=9.195e-01, best=9.195e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=6.090e-01, best=6.090e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=2.365e-01, best=2.365e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=2.106e-01, best=2.106e-01, lr=5.36e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=3.259e-01, best=2.106e-01, lr=5.10e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=1.838e-01, best=1.838e-01, lr=6.12e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=4.278e-01, best=1.838e-01, lr=5.81e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=1.532e-01, best=1.532e-01, lr=6.97e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=5.440e-01, best=1.532e-01, lr=6.62e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=1.184e-01, best=1.184e-01, lr=7.95e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=6.765e-01, best=1.184e-01, lr=7.55e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=7.862e-02, best=7.862e-02, lr=9.06e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=8.275e-01, best=7.862e-02, lr=8.61e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=3.331e-02, best=3.331e-02, lr=1.03e+00, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=9.997e-01, best=3.331e-02, lr=9.81e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=1.834e-02, best=1.834e-02, lr=1.18e+00, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=1.159e+00, best=1.834e-02, lr=1.12e+00, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=4.054e-02, best=1.834e-02, lr=1.06e+00, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=1.022e+00, best=1.834e-02, lr=1.01e+00, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.93it/s, loss=1.260e-02, best=1.260e-02, lr=1.21e+00, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.68it/s, loss=1.260e-02, best=1.260e-02, lr=1.21e+00, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.68it/s, loss=1.199e+00, best=1.260e-02, lr=1.15e+00, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.68it/s, loss=4.798e-02, best=1.260e-02, lr=1.09e+00, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.68it/s, loss=1.045e+00, best=1.260e-02, lr=1.04e+00, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.68it/s, loss=6.689e-03, best=6.689e-03, lr=1.25e+00, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.68it/s, loss=1.240e+00, best=6.689e-03, lr=1.18e+00, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.68it/s, loss=5.564e-02, best=6.689e-03, lr=1.12e+00, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.68it/s, loss=1.069e+00, best=6.689e-03, lr=1.07e+00, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.68it/s, loss=6.144e-04, best=6.144e-04, lr=1.28e+00, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.68it/s, loss=1.282e+00, best=6.144e-04, lr=1.22e+00, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.68it/s, loss=6.351e-02, best=6.144e-04, lr=1.16e+00, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.68it/s, loss=1.094e+00, best=6.144e-04, lr=1.10e+00, worse_count=3]
                                                                                                                                       
(20/208) Skipping tensor: layers.1.adaLN_modulation.0.weight (Reason: In high-precision list)
(21/208) Processing tensor: layers.1.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.654e-01, best=9.654e-01, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.561e-01, best=9.561e-01, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.456e-01, best=9.456e-01, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.336e-01, best=9.336e-01, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.199e-01, best=9.199e-01, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.043e-01, best=9.043e-01, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.866e-01, best=8.866e-01, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.663e-01, best=8.663e-01, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.432e-01, best=8.432e-01, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.169e-01, best=8.169e-01, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.868e-01, best=7.868e-01, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.526e-01, best=7.526e-01, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.136e-01, best=7.136e-01, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.691e-01, best=6.691e-01, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.184e-01, best=6.184e-01, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.606e-01, best=5.606e-01, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.947e-01, best=4.947e-01, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.196e-01, best=4.196e-01, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.339e-01, best=3.339e-01, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.363e-01, best=2.363e-01, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.250e-01, best=1.250e-01, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.870e-03, best=1.870e-03, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.428e-01, best=1.870e-03, lr=1.31e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.223e-02, best=1.870e-03, lr=1.18e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.056e-01, best=1.870e-03, lr=1.06e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.462e-04, best=7.462e-04, lr=1.21e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.205e-01, best=7.462e-04, lr=1.09e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.107e-02, best=7.462e-04, lr=9.87e-02, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.766e-02, best=7.462e-04, lr=8.91e-02, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.446e-03, best=7.462e-04, lr=8.04e-02, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.897e-02, best=7.462e-04, lr=7.26e-02, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.394e-03, best=7.462e-04, lr=6.55e-02, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.910e-02, best=7.462e-04, lr=5.91e-02, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.767e-06, best=8.767e-06, lr=6.74e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.738e-02, best=8.767e-06, lr=6.08e-02, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.562e-03, best=8.767e-06, lr=5.49e-02, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.833e-02, best=8.767e-06, lr=4.95e-02, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.210e-03, best=8.767e-06, lr=4.47e-02, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.350e-02, best=8.767e-06, lr=4.03e-02, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.149e-03, best=8.767e-06, lr=3.64e-02, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.327e-02, best=8.767e-06, lr=3.29e-02, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.015e-04, best=8.767e-06, lr=2.97e-02, worse_count=8]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.926e-02, best=8.767e-06, lr=2.68e-02, worse_count=9]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.490e-03, best=8.767e-06, lr=2.42e-02, worse_count=10]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.167e-02, best=8.767e-06, lr=2.18e-02, worse_count=11]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.349e-04, best=8.767e-06, lr=1.97e-02, worse_count=12]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.954e-02, best=8.767e-06, lr=1.78e-02, worse_count=13]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 469.47it/s, loss=1.954e-02, best=8.767e-06, lr=1.78e-02, worse_count=13]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 469.47it/s, loss=1.784e-03, best=8.767e-06, lr=1.60e-02, worse_count=14]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 469.47it/s, loss=1.424e-02, best=8.767e-06, lr=1.45e-02, worse_count=15]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 469.47it/s, loss=2.210e-04, best=8.767e-06, lr=1.31e-02, worse_count=16]
                                                                                                                                        
(22/208) Processing tensor: layers.1.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.812e+00, best=1.812e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.802e+00, best=1.802e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.791e+00, best=1.791e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.777e+00, best=1.777e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.760e+00, best=1.760e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.740e+00, best=1.740e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.715e+00, best=1.715e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.686e+00, best=1.686e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.652e+00, best=1.652e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.610e+00, best=1.610e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.560e+00, best=1.560e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.500e+00, best=1.500e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.427e+00, best=1.427e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.341e+00, best=1.341e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.237e+00, best=1.237e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.112e+00, best=1.112e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.622e-01, best=9.622e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.825e-01, best=7.825e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=7.825e-01, best=7.825e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=5.669e-01, best=5.669e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=3.082e-01, best=3.082e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=2.272e-03, best=2.272e-03, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=3.703e-01, best=2.272e-03, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=1.636e-02, best=2.272e-03, lr=3.36e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=3.199e-01, best=2.272e-03, lr=3.19e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=4.563e-04, best=4.563e-04, lr=3.83e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=3.829e-01, best=4.563e-04, lr=3.64e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=1.871e-02, best=4.563e-04, lr=3.46e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=3.272e-01, best=4.563e-04, lr=3.29e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=1.412e-03, best=4.563e-04, lr=3.12e-01, worse_count=4]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=3.108e-01, best=4.563e-04, lr=2.97e-01, worse_count=5]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=1.420e-02, best=4.563e-04, lr=2.82e-01, worse_count=6]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=2.676e-01, best=4.563e-04, lr=2.68e-01, worse_count=7]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=1.103e-04, best=1.103e-04, lr=3.21e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=3.211e-01, best=1.103e-04, lr=3.05e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=1.595e-02, best=1.103e-04, lr=2.90e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.38it/s, loss=2.740e-01, best=1.103e-04, lr=2.75e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.48it/s, loss=2.740e-01, best=1.103e-04, lr=2.75e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.48it/s, loss=1.456e-03, best=1.103e-04, lr=2.62e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.48it/s, loss=2.602e-01, best=1.103e-04, lr=2.49e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.48it/s, loss=1.163e-02, best=1.103e-04, lr=2.36e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.48it/s, loss=2.245e-01, best=1.103e-04, lr=2.24e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.48it/s, loss=1.804e-04, best=1.103e-04, lr=2.13e-01, worse_count=8]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.48it/s, loss=2.129e-01, best=1.103e-04, lr=2.02e-01, worse_count=9]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.48it/s, loss=1.047e-02, best=1.103e-04, lr=1.92e-01, worse_count=10]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.48it/s, loss=1.819e-01, best=1.103e-04, lr=1.83e-01, worse_count=11]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.48it/s, loss=8.585e-04, best=1.103e-04, lr=1.74e-01, worse_count=12]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.48it/s, loss=1.727e-01, best=1.103e-04, lr=1.65e-01, worse_count=13]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.48it/s, loss=7.820e-03, best=1.103e-04, lr=1.57e-01, worse_count=14]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.48it/s, loss=1.488e-01, best=1.103e-04, lr=1.49e-01, worse_count=15]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.48it/s, loss=1.409e-05, best=1.409e-05, lr=1.79e-01, worse_count=0] 
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.48it/s, loss=1.786e-01, best=1.409e-05, lr=1.70e-01, worse_count=1]
                                                                                                                                       
(23/208) Processing tensor: layers.1.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.802e+00, best=1.802e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.792e+00, best=1.792e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.780e+00, best=1.780e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.766e+00, best=1.766e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.749e+00, best=1.749e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.729e+00, best=1.729e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.705e+00, best=1.705e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.676e+00, best=1.676e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.641e+00, best=1.641e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.599e+00, best=1.599e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.549e+00, best=1.549e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.489e+00, best=1.489e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.417e+00, best=1.417e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.330e+00, best=1.330e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.226e+00, best=1.226e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.102e+00, best=1.102e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.518e-01, best=9.518e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.721e-01, best=7.721e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.565e-01, best=5.565e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.977e-01, best=2.977e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=2.977e-01, best=2.977e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=1.274e-02, best=1.274e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=3.598e-01, best=1.274e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=5.891e-03, best=5.891e-03, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=4.189e-01, best=5.891e-03, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=1.535e-02, best=5.891e-03, lr=3.83e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=3.680e-01, best=5.891e-03, lr=3.64e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=3.820e-03, best=3.820e-03, lr=4.37e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=4.332e-01, best=3.820e-03, lr=4.15e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=1.803e-02, best=3.820e-03, lr=3.94e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=3.764e-01, best=3.820e-03, lr=3.75e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=1.690e-03, best=1.690e-03, lr=4.50e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=4.479e-01, best=1.690e-03, lr=4.27e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=2.079e-02, best=1.690e-03, lr=4.06e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=3.850e-01, best=1.690e-03, lr=3.85e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=5.022e-04, best=5.022e-04, lr=4.63e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=4.621e-01, best=5.022e-04, lr=4.39e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=2.263e-02, best=5.022e-04, lr=4.17e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=3.948e-01, best=5.022e-04, lr=3.97e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=1.753e-03, best=5.022e-04, lr=3.77e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.03it/s, loss=3.750e-01, best=5.022e-04, lr=3.58e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.96it/s, loss=3.750e-01, best=5.022e-04, lr=3.58e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.96it/s, loss=1.709e-02, best=5.022e-04, lr=3.40e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.96it/s, loss=3.229e-01, best=5.022e-04, lr=3.23e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.96it/s, loss=8.484e-05, best=8.484e-05, lr=3.88e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.96it/s, loss=3.876e-01, best=8.484e-05, lr=3.68e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.96it/s, loss=1.930e-02, best=8.484e-05, lr=3.50e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.96it/s, loss=3.306e-01, best=8.484e-05, lr=3.32e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.96it/s, loss=1.805e-03, best=8.484e-05, lr=3.16e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.96it/s, loss=3.139e-01, best=8.484e-05, lr=3.00e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.96it/s, loss=1.398e-02, best=8.484e-05, lr=2.85e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.96it/s, loss=2.710e-01, best=8.484e-05, lr=2.71e-01, worse_count=7]
                                                                                                                                       
(24/208) Processing tensor: layers.1.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.856e+00, best=1.856e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.847e+00, best=1.847e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.835e+00, best=1.835e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.821e+00, best=1.821e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.804e+00, best=1.804e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.784e+00, best=1.784e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.760e+00, best=1.760e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.731e+00, best=1.731e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.696e+00, best=1.696e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.654e+00, best=1.654e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.604e+00, best=1.604e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.544e+00, best=1.544e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.472e+00, best=1.472e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.385e+00, best=1.385e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.281e+00, best=1.281e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.156e+00, best=1.156e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.007e+00, best=1.007e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.268e-01, best=8.268e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.112e-01, best=6.112e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=6.112e-01, best=6.112e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=3.525e-01, best=3.525e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=4.203e-02, best=4.203e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=3.305e-01, best=4.203e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=2.340e-02, best=2.340e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=4.013e-01, best=2.340e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=2.167e-03, best=2.167e-03, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=4.820e-01, best=2.167e-03, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=2.204e-02, best=2.167e-03, lr=4.37e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=4.149e-01, best=2.167e-03, lr=4.15e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=1.944e-04, best=1.944e-04, lr=4.98e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=4.980e-01, best=1.944e-04, lr=4.73e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=2.471e-02, best=1.944e-04, lr=4.50e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=4.249e-01, best=1.944e-04, lr=4.27e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=2.234e-03, best=1.944e-04, lr=4.06e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=4.035e-01, best=1.944e-04, lr=3.85e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=1.805e-02, best=1.944e-04, lr=3.66e-01, worse_count=6]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=3.481e-01, best=1.944e-04, lr=3.48e-01, worse_count=7]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=2.566e-04, best=1.944e-04, lr=3.30e-01, worse_count=8]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=3.302e-01, best=1.944e-04, lr=3.14e-01, worse_count=9]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.26it/s, loss=1.627e-02, best=1.944e-04, lr=2.98e-01, worse_count=10]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.97it/s, loss=1.627e-02, best=1.944e-04, lr=2.98e-01, worse_count=10]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.97it/s, loss=2.820e-01, best=1.944e-04, lr=2.83e-01, worse_count=11]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.97it/s, loss=1.355e-03, best=1.944e-04, lr=2.69e-01, worse_count=12]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.97it/s, loss=2.678e-01, best=1.944e-04, lr=2.56e-01, worse_count=13]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.97it/s, loss=1.210e-02, best=1.944e-04, lr=2.43e-01, worse_count=14]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.97it/s, loss=2.308e-01, best=1.944e-04, lr=2.31e-01, worse_count=15]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.97it/s, loss=4.344e-05, best=4.344e-05, lr=2.77e-01, worse_count=0] 
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.97it/s, loss=2.769e-01, best=4.344e-05, lr=2.63e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.97it/s, loss=1.380e-02, best=4.344e-05, lr=2.50e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.97it/s, loss=2.361e-01, best=4.344e-05, lr=2.37e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.97it/s, loss=1.307e-03, best=4.344e-05, lr=2.26e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.97it/s, loss=2.243e-01, best=4.344e-05, lr=2.14e-01, worse_count=5]
                                                                                                                                       
(25/208) Processing tensor: layers.1.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.833e+00, best=2.833e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.823e+00, best=2.823e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.811e+00, best=2.811e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.797e+00, best=2.797e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.780e+00, best=2.780e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.760e+00, best=2.760e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.736e+00, best=2.736e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.707e+00, best=2.707e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.672e+00, best=2.672e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.631e+00, best=2.631e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.580e+00, best=2.580e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.520e+00, best=2.520e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.448e+00, best=2.448e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.361e+00, best=2.361e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.257e+00, best=2.257e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.133e+00, best=2.133e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.983e+00, best=1.983e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.803e+00, best=1.803e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.588e+00, best=1.588e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.329e+00, best=1.329e+00, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=1.329e+00, best=1.329e+00, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=1.018e+00, best=1.018e+00, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=6.458e-01, best=6.458e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=1.987e-01, best=1.987e-01, lr=5.36e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=3.378e-01, best=1.987e-01, lr=5.10e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=1.719e-01, best=1.719e-01, lr=6.12e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=4.398e-01, best=1.719e-01, lr=5.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=1.413e-01, best=1.413e-01, lr=6.97e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=5.560e-01, best=1.413e-01, lr=6.62e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=1.064e-01, best=1.064e-01, lr=7.95e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=6.884e-01, best=1.064e-01, lr=7.55e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=6.667e-02, best=6.667e-02, lr=9.06e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=8.395e-01, best=6.667e-02, lr=8.61e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=2.136e-02, best=2.136e-02, lr=1.03e+00, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=1.012e+00, best=2.136e-02, lr=9.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=3.029e-02, best=2.136e-02, lr=9.32e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=9.020e-01, best=2.136e-02, lr=8.86e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=1.633e-02, best=1.633e-02, lr=1.06e+00, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=1.046e+00, best=1.633e-02, lr=1.01e+00, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=3.681e-02, best=1.633e-02, lr=9.59e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=9.224e-01, best=1.633e-02, lr=9.11e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.75it/s, loss=9.224e-01, best=1.633e-02, lr=9.11e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.75it/s, loss=1.115e-02, best=1.115e-02, lr=1.09e+00, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.75it/s, loss=1.082e+00, best=1.115e-02, lr=1.04e+00, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.75it/s, loss=4.353e-02, best=1.115e-02, lr=9.87e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.75it/s, loss=9.433e-01, best=1.115e-02, lr=9.37e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.75it/s, loss=5.817e-03, best=5.817e-03, lr=1.12e+00, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.75it/s, loss=1.119e+00, best=5.817e-03, lr=1.07e+00, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.75it/s, loss=5.043e-02, best=5.817e-03, lr=1.02e+00, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.75it/s, loss=9.649e-01, best=5.817e-03, lr=9.64e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.75it/s, loss=3.347e-04, best=3.347e-04, lr=1.16e+00, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.75it/s, loss=1.157e+00, best=3.347e-04, lr=1.10e+00, worse_count=1]
                                                                                                                                       
(26/208) Skipping tensor: layers.10.adaLN_modulation.0.weight (Reason: In high-precision list)
(27/208) Processing tensor: layers.10.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.124e+00, best=2.124e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.115e+00, best=2.115e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.104e+00, best=2.104e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.092e+00, best=2.092e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.078e+00, best=2.078e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.063e+00, best=2.063e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.045e+00, best=2.045e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.025e+00, best=2.025e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.002e+00, best=2.002e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.975e+00, best=1.975e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.945e+00, best=1.945e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.911e+00, best=1.911e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.872e+00, best=1.872e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.828e+00, best=1.828e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.777e+00, best=1.777e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.719e+00, best=1.719e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.653e+00, best=1.653e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.578e+00, best=1.578e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.492e+00, best=1.492e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.395e+00, best=1.395e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.283e+00, best=1.283e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.157e+00, best=1.157e+00, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.012e+00, best=1.012e+00, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.470e-01, best=8.470e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.590e-01, best=6.590e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.447e-01, best=4.447e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.004e-01, best=2.004e-01, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.811e-02, best=7.811e-02, lr=3.17e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.394e-01, best=7.811e-02, lr=2.87e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.715e-02, best=4.715e-02, lr=3.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.795e-01, best=4.715e-02, lr=2.95e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.531e-02, best=1.531e-02, lr=3.36e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.208e-01, best=1.531e-02, lr=3.03e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.746e-02, best=1.531e-02, lr=2.74e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.563e-01, best=1.531e-02, lr=2.47e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.227e-03, best=9.227e-03, lr=2.82e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.724e-01, best=9.227e-03, lr=2.54e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.823e-02, best=9.227e-03, lr=2.29e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.112e-01, best=9.227e-03, lr=2.07e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.134e-03, best=4.134e-03, lr=2.36e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.319e-01, best=4.134e-03, lr=2.13e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.888e-02, best=4.134e-03, lr=1.92e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.734e-01, best=4.134e-03, lr=1.73e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.351e-04, best=1.351e-04, lr=1.98e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.976e-01, best=1.351e-04, lr=1.78e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.915e-02, best=1.351e-04, lr=1.61e-01, worse_count=2]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 458.87it/s, loss=1.915e-02, best=1.351e-04, lr=1.61e-01, worse_count=2]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 458.87it/s, loss=1.419e-01, best=1.351e-04, lr=1.45e-01, worse_count=3]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 458.87it/s, loss=3.442e-03, best=1.351e-04, lr=1.31e-01, worse_count=4]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 458.87it/s, loss=1.278e-01, best=1.351e-04, lr=1.18e-01, worse_count=5]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 458.87it/s, loss=9.351e-03, best=1.351e-04, lr=1.07e-01, worse_count=6]
                                                                                                                                       
(28/208) Processing tensor: layers.10.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.838e+00, best=1.838e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.828e+00, best=1.828e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.816e+00, best=1.816e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.802e+00, best=1.802e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.785e+00, best=1.785e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.765e+00, best=1.765e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.741e+00, best=1.741e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.712e+00, best=1.712e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.677e+00, best=1.677e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.635e+00, best=1.635e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.585e+00, best=1.585e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.525e+00, best=1.525e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.453e+00, best=1.453e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.366e+00, best=1.366e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.262e+00, best=1.262e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.138e+00, best=1.138e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.878e-01, best=9.878e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.081e-01, best=8.081e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=8.081e-01, best=8.081e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=5.925e-01, best=5.925e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=3.338e-01, best=3.338e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=2.332e-02, best=2.332e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=3.493e-01, best=2.332e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=4.695e-03, best=4.695e-03, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=4.200e-01, best=4.695e-03, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=1.654e-02, best=4.695e-03, lr=3.83e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=3.668e-01, best=4.695e-03, lr=3.64e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=2.625e-03, best=2.625e-03, lr=4.37e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=4.344e-01, best=2.625e-03, lr=4.15e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=1.922e-02, best=2.625e-03, lr=3.94e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=3.752e-01, best=2.625e-03, lr=3.75e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=4.945e-04, best=4.945e-04, lr=4.50e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=4.491e-01, best=4.945e-04, lr=4.27e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=2.199e-02, best=4.945e-04, lr=4.06e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=3.838e-01, best=4.945e-04, lr=3.85e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=1.697e-03, best=4.945e-04, lr=3.66e-01, worse_count=4]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.72it/s, loss=3.645e-01, best=4.945e-04, lr=3.48e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.64it/s, loss=3.645e-01, best=4.945e-04, lr=3.48e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.64it/s, loss=1.661e-02, best=4.945e-04, lr=3.30e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.64it/s, loss=3.139e-01, best=4.945e-04, lr=3.14e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.64it/s, loss=8.890e-05, best=8.890e-05, lr=3.77e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.64it/s, loss=3.767e-01, best=8.890e-05, lr=3.58e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.64it/s, loss=1.875e-02, best=8.890e-05, lr=3.40e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.64it/s, loss=3.213e-01, best=8.890e-05, lr=3.23e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.64it/s, loss=1.748e-03, best=8.890e-05, lr=3.07e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.64it/s, loss=3.051e-01, best=8.890e-05, lr=2.92e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.64it/s, loss=1.360e-02, best=8.890e-05, lr=2.77e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.64it/s, loss=2.634e-01, best=8.890e-05, lr=2.63e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.64it/s, loss=2.521e-04, best=8.890e-05, lr=2.50e-01, worse_count=8]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.64it/s, loss=2.497e-01, best=8.890e-05, lr=2.37e-01, worse_count=9]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.64it/s, loss=1.225e-02, best=8.890e-05, lr=2.26e-01, worse_count=10]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.64it/s, loss=2.133e-01, best=8.890e-05, lr=2.14e-01, worse_count=11]
                                                                                                                                        
(29/208) Processing tensor: layers.10.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.925e+00, best=1.925e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.915e+00, best=1.915e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.904e+00, best=1.904e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.890e+00, best=1.890e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.873e+00, best=1.873e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.853e+00, best=1.853e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.828e+00, best=1.828e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.799e+00, best=1.799e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.765e+00, best=1.765e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.723e+00, best=1.723e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.673e+00, best=1.673e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.613e+00, best=1.613e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.540e+00, best=1.540e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.454e+00, best=1.454e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.350e+00, best=1.350e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.225e+00, best=1.225e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.075e+00, best=1.075e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.955e-01, best=8.955e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.799e-01, best=6.799e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=6.799e-01, best=6.799e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=4.211e-01, best=4.211e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=1.107e-01, best=1.107e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=2.619e-01, best=1.107e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=9.204e-02, best=9.204e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=3.327e-01, best=9.204e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=7.080e-02, best=7.080e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=4.134e-01, best=7.080e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=4.659e-02, best=4.659e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=5.054e-01, best=4.659e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=1.899e-02, best=1.899e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=6.103e-01, best=1.899e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=1.247e-02, best=1.247e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=7.049e-01, best=1.247e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=2.340e-02, best=1.247e-02, lr=6.47e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=6.240e-01, best=1.247e-02, lr=6.15e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=8.976e-03, best=8.976e-03, lr=7.38e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=7.291e-01, best=8.976e-03, lr=7.01e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=2.793e-02, best=8.976e-03, lr=6.66e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=6.382e-01, best=8.976e-03, lr=6.33e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.85it/s, loss=5.378e-03, best=5.378e-03, lr=7.59e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.07it/s, loss=5.378e-03, best=5.378e-03, lr=7.59e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.07it/s, loss=7.540e-01, best=5.378e-03, lr=7.21e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.07it/s, loss=3.259e-02, best=5.378e-03, lr=6.85e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.07it/s, loss=6.527e-01, best=5.378e-03, lr=6.51e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.07it/s, loss=1.676e-03, best=1.676e-03, lr=7.81e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.07it/s, loss=7.796e-01, best=1.676e-03, lr=7.42e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.07it/s, loss=3.739e-02, best=1.676e-03, lr=7.05e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.07it/s, loss=6.677e-01, best=1.676e-03, lr=6.70e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.07it/s, loss=2.133e-03, best=1.676e-03, lr=6.36e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.07it/s, loss=6.342e-01, best=1.676e-03, lr=6.04e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.07it/s, loss=2.968e-02, best=1.676e-03, lr=5.74e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.07it/s, loss=5.446e-01, best=1.676e-03, lr=5.46e-01, worse_count=7]
                                                                                                                                       
(30/208) Processing tensor: layers.10.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.082e+00, best=2.082e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.072e+00, best=2.072e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.061e+00, best=2.061e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.047e+00, best=2.047e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.030e+00, best=2.030e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.010e+00, best=2.010e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.986e+00, best=1.986e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.957e+00, best=1.957e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.922e+00, best=1.922e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.880e+00, best=1.880e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.830e+00, best=1.830e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.770e+00, best=1.770e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.698e+00, best=1.698e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.611e+00, best=1.611e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.507e+00, best=1.507e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.382e+00, best=1.382e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.232e+00, best=1.232e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.053e+00, best=1.053e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.371e-01, best=8.371e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=8.371e-01, best=8.371e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=5.783e-01, best=5.783e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=2.679e-01, best=2.679e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=1.047e-01, best=1.047e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=3.424e-01, best=1.047e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=8.236e-02, best=8.236e-02, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=4.273e-01, best=8.236e-02, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=5.688e-02, best=5.688e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=5.242e-01, best=5.688e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=2.783e-02, best=2.783e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=6.346e-01, best=2.783e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=5.294e-03, best=5.294e-03, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=7.498e-01, best=5.294e-03, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=3.246e-02, best=5.294e-03, lr=6.81e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=6.490e-01, best=5.294e-03, lr=6.47e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=1.613e-03, best=1.613e-03, lr=7.77e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=7.753e-01, best=1.613e-03, lr=7.38e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=3.723e-02, best=1.613e-03, lr=7.01e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=6.639e-01, best=1.613e-03, lr=6.66e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.38it/s, loss=2.175e-03, best=1.613e-03, lr=6.33e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.84it/s, loss=2.175e-03, best=1.613e-03, lr=6.33e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.84it/s, loss=6.306e-01, best=1.613e-03, lr=6.01e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.84it/s, loss=2.947e-02, best=1.613e-03, lr=5.71e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.84it/s, loss=5.416e-01, best=1.613e-03, lr=5.43e-01, worse_count=7]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.84it/s, loss=9.108e-04, best=9.108e-04, lr=6.51e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.84it/s, loss=6.501e-01, best=9.108e-04, lr=6.18e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.84it/s, loss=3.164e-02, best=9.108e-04, lr=5.88e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.84it/s, loss=5.559e-01, best=9.108e-04, lr=5.58e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.84it/s, loss=2.263e-03, best=9.108e-04, lr=5.30e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.84it/s, loss=5.280e-01, best=9.108e-04, lr=5.04e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.84it/s, loss=2.425e-02, best=9.108e-04, lr=4.79e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.84it/s, loss=4.543e-01, best=9.108e-04, lr=4.55e-01, worse_count=7]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.84it/s, loss=3.226e-04, best=3.226e-04, lr=5.46e-01, worse_count=0]
                                                                                                                                       
(31/208) Processing tensor: layers.10.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.955e+00, best=1.955e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.945e+00, best=1.945e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.933e+00, best=1.933e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.919e+00, best=1.919e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.903e+00, best=1.903e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.882e+00, best=1.882e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.858e+00, best=1.858e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.829e+00, best=1.829e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.794e+00, best=1.794e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.753e+00, best=1.753e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.703e+00, best=1.703e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.642e+00, best=1.642e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.570e+00, best=1.570e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.484e+00, best=1.484e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.380e+00, best=1.380e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.255e+00, best=1.255e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.105e+00, best=1.105e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.253e-01, best=9.253e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.097e-01, best=7.097e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.510e-01, best=4.510e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=4.510e-01, best=4.510e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=1.405e-01, best=1.405e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=2.321e-01, best=1.405e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=1.219e-01, best=1.219e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=3.029e-01, best=1.219e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=1.006e-01, best=1.006e-01, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=3.836e-01, best=1.006e-01, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=7.643e-02, best=7.643e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=4.756e-01, best=7.643e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=4.883e-02, best=4.883e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=5.804e-01, best=4.883e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=1.737e-02, best=1.737e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=7.000e-01, best=1.737e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=1.850e-02, best=1.737e-02, lr=6.47e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=6.289e-01, best=1.737e-02, lr=6.15e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=1.387e-02, best=1.387e-02, lr=7.38e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=7.242e-01, best=1.387e-02, lr=7.01e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=2.303e-02, best=1.387e-02, lr=6.66e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=6.431e-01, best=1.387e-02, lr=6.33e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=1.027e-02, best=1.027e-02, lr=7.59e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.27it/s, loss=7.491e-01, best=1.027e-02, lr=7.21e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.34it/s, loss=7.491e-01, best=1.027e-02, lr=7.21e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.34it/s, loss=2.769e-02, best=1.027e-02, lr=6.85e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.34it/s, loss=6.576e-01, best=1.027e-02, lr=6.51e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.34it/s, loss=6.572e-03, best=6.572e-03, lr=7.81e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.34it/s, loss=7.747e-01, best=6.572e-03, lr=7.42e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.34it/s, loss=3.249e-02, best=6.572e-03, lr=7.05e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.34it/s, loss=6.726e-01, best=6.572e-03, lr=6.70e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.34it/s, loss=2.764e-03, best=2.764e-03, lr=8.04e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.34it/s, loss=8.010e-01, best=2.764e-03, lr=7.64e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.34it/s, loss=3.743e-02, best=2.764e-03, lr=7.25e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.34it/s, loss=6.880e-01, best=2.764e-03, lr=6.89e-01, worse_count=3]
                                                                                                                                       
(32/208) Skipping tensor: layers.11.adaLN_modulation.0.weight (Reason: In high-precision list)
(33/208) Processing tensor: layers.11.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.981e+00, best=1.981e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.972e+00, best=1.972e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.961e+00, best=1.961e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.949e+00, best=1.949e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.935e+00, best=1.935e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.920e+00, best=1.920e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.902e+00, best=1.902e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.882e+00, best=1.882e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.859e+00, best=1.859e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.832e+00, best=1.832e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.802e+00, best=1.802e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.768e+00, best=1.768e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.729e+00, best=1.729e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.685e+00, best=1.685e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.634e+00, best=1.634e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.576e+00, best=1.576e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.510e+00, best=1.510e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.435e+00, best=1.435e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.349e+00, best=1.349e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.252e+00, best=1.252e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.140e+00, best=1.140e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.014e+00, best=1.014e+00, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.689e-01, best=8.689e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.040e-01, best=7.040e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.160e-01, best=5.160e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.017e-01, best=3.017e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.742e-02, best=5.742e-02, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.211e-01, best=5.742e-02, lr=2.51e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.026e-02, best=3.026e-02, lr=2.87e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.563e-01, best=3.026e-02, lr=2.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.325e-03, best=2.325e-03, lr=2.95e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.925e-01, best=2.325e-03, lr=2.66e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.642e-02, best=2.325e-03, lr=2.40e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.137e-01, best=2.325e-03, lr=2.17e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.006e-03, best=2.325e-03, lr=1.96e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.926e-01, best=2.325e-03, lr=1.77e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.606e-02, best=2.325e-03, lr=1.59e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.432e-01, best=2.325e-03, lr=1.44e-01, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.308e-04, best=5.308e-04, lr=1.64e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.634e-01, best=5.308e-04, lr=1.48e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.545e-02, best=5.308e-04, lr=1.33e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.180e-01, best=5.308e-04, lr=1.20e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.433e-03, best=5.308e-04, lr=1.09e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.063e-01, best=5.308e-04, lr=9.81e-02, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.168e-03, best=5.308e-04, lr=8.86e-02, worse_count=6]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 441.54it/s, loss=8.168e-03, best=5.308e-04, lr=8.86e-02, worse_count=6]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 441.54it/s, loss=8.040e-02, best=5.308e-04, lr=7.99e-02, worse_count=7]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 441.54it/s, loss=4.669e-04, best=4.669e-04, lr=9.11e-02, worse_count=0]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 441.54it/s, loss=9.065e-02, best=4.669e-04, lr=8.22e-02, worse_count=1]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 441.54it/s, loss=8.417e-03, best=4.669e-04, lr=7.42e-02, worse_count=2]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 441.54it/s, loss=6.580e-02, best=4.669e-04, lr=6.70e-02, worse_count=3]
                                                                                                                                       
(34/208) Processing tensor: layers.11.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.854e+00, best=1.854e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.844e+00, best=1.844e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.832e+00, best=1.832e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.818e+00, best=1.818e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.801e+00, best=1.801e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.781e+00, best=1.781e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.757e+00, best=1.757e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.728e+00, best=1.728e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.693e+00, best=1.693e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.651e+00, best=1.651e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.601e+00, best=1.601e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.541e+00, best=1.541e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.469e+00, best=1.469e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.382e+00, best=1.382e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.278e+00, best=1.278e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.153e+00, best=1.153e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.004e+00, best=1.004e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.240e-01, best=8.240e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=8.240e-01, best=8.240e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=6.084e-01, best=6.084e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=3.497e-01, best=3.497e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=3.921e-02, best=3.921e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=3.334e-01, best=3.921e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=2.058e-02, best=2.058e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=4.042e-01, best=2.058e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=6.567e-04, best=6.567e-04, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=4.835e-01, best=6.567e-04, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=2.355e-02, best=6.567e-04, lr=4.37e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=4.134e-01, best=6.567e-04, lr=4.15e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=1.704e-03, best=6.567e-04, lr=3.94e-01, worse_count=4]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=3.927e-01, best=6.567e-04, lr=3.75e-01, worse_count=5]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=1.802e-02, best=6.567e-04, lr=3.56e-01, worse_count=6]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=3.379e-01, best=6.567e-04, lr=3.38e-01, worse_count=7]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=2.192e-04, best=2.192e-04, lr=4.06e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=4.055e-01, best=2.192e-04, lr=3.85e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=2.007e-02, best=2.192e-04, lr=3.66e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.46it/s, loss=3.461e-01, best=2.192e-04, lr=3.48e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.47it/s, loss=3.461e-01, best=2.192e-04, lr=3.48e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.47it/s, loss=1.759e-03, best=2.192e-04, lr=3.30e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.47it/s, loss=3.287e-01, best=2.192e-04, lr=3.14e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.47it/s, loss=1.477e-02, best=2.192e-04, lr=2.98e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.47it/s, loss=2.835e-01, best=2.192e-04, lr=2.83e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.47it/s, loss=1.482e-04, best=1.482e-04, lr=3.40e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.47it/s, loss=3.399e-01, best=1.482e-04, lr=3.23e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.47it/s, loss=1.685e-02, best=1.482e-04, lr=3.07e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.47it/s, loss=2.900e-01, best=1.482e-04, lr=2.92e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.47it/s, loss=1.510e-03, best=1.482e-04, lr=2.77e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.47it/s, loss=2.754e-01, best=1.482e-04, lr=2.63e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.47it/s, loss=1.234e-02, best=1.482e-04, lr=2.50e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.47it/s, loss=2.376e-01, best=1.482e-04, lr=2.37e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.47it/s, loss=1.596e-04, best=1.482e-04, lr=2.26e-01, worse_count=8]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.47it/s, loss=2.254e-01, best=1.482e-04, lr=2.14e-01, worse_count=9]
                                                                                                                                       
(35/208) Processing tensor: layers.11.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.949e+00, best=1.949e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.940e+00, best=1.940e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.928e+00, best=1.928e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.914e+00, best=1.914e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.897e+00, best=1.897e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.877e+00, best=1.877e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.853e+00, best=1.853e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.824e+00, best=1.824e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.789e+00, best=1.789e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.747e+00, best=1.747e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.697e+00, best=1.697e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.637e+00, best=1.637e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.565e+00, best=1.565e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.478e+00, best=1.478e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.374e+00, best=1.374e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.249e+00, best=1.249e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.100e+00, best=1.100e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.199e-01, best=9.199e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.043e-01, best=7.043e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=7.043e-01, best=7.043e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=4.456e-01, best=4.456e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=1.351e-01, best=1.351e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=2.375e-01, best=1.351e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=1.165e-01, best=1.165e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=3.083e-01, best=1.165e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=9.525e-02, best=9.525e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=3.890e-01, best=9.525e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=7.104e-02, best=7.104e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=4.810e-01, best=7.104e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=4.344e-02, best=4.344e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=5.858e-01, best=4.344e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=1.197e-02, best=1.197e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=7.054e-01, best=1.197e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=2.389e-02, best=1.197e-02, lr=6.47e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=6.235e-01, best=1.197e-02, lr=6.15e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=8.476e-03, best=8.476e-03, lr=7.38e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=7.296e-01, best=8.476e-03, lr=7.01e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=2.843e-02, best=8.476e-03, lr=6.66e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=6.377e-01, best=8.476e-03, lr=6.33e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.13it/s, loss=4.878e-03, best=4.878e-03, lr=7.59e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.24it/s, loss=4.878e-03, best=4.878e-03, lr=7.59e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.24it/s, loss=7.545e-01, best=4.878e-03, lr=7.21e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.24it/s, loss=3.309e-02, best=4.878e-03, lr=6.85e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.24it/s, loss=6.522e-01, best=4.878e-03, lr=6.51e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.24it/s, loss=1.177e-03, best=1.177e-03, lr=7.81e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.24it/s, loss=7.801e-01, best=1.177e-03, lr=7.42e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.24it/s, loss=3.789e-02, best=1.177e-03, lr=7.05e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.24it/s, loss=6.672e-01, best=1.177e-03, lr=6.70e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.24it/s, loss=2.632e-03, best=1.177e-03, lr=6.36e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.24it/s, loss=6.337e-01, best=1.177e-03, lr=6.04e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.24it/s, loss=2.919e-02, best=1.177e-03, lr=5.74e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.24it/s, loss=5.451e-01, best=1.177e-03, lr=5.46e-01, worse_count=7]
                                                                                                                                       
(36/208) Processing tensor: layers.11.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.115e+00, best=2.115e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.105e+00, best=2.105e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.093e+00, best=2.093e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.079e+00, best=2.079e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.063e+00, best=2.063e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.042e+00, best=2.042e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.018e+00, best=2.018e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.989e+00, best=1.989e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.954e+00, best=1.954e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.913e+00, best=1.913e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.862e+00, best=1.862e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.802e+00, best=1.802e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.730e+00, best=1.730e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.643e+00, best=1.643e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.539e+00, best=1.539e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.415e+00, best=1.415e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.265e+00, best=1.265e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.085e+00, best=1.085e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.696e-01, best=8.696e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=8.696e-01, best=8.696e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=6.108e-01, best=6.108e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=3.004e-01, best=3.004e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=7.221e-02, best=7.221e-02, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=3.749e-01, best=7.221e-02, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=4.986e-02, best=4.986e-02, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=4.598e-01, best=4.986e-02, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=2.437e-02, best=2.437e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=5.567e-01, best=2.437e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=4.678e-03, best=4.678e-03, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=6.577e-01, best=4.678e-03, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=2.844e-02, best=4.678e-03, lr=5.98e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=5.694e-01, best=4.678e-03, lr=5.68e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=1.449e-03, best=1.449e-03, lr=6.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=6.801e-01, best=1.449e-03, lr=6.47e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=3.263e-02, best=1.449e-03, lr=6.15e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=5.824e-01, best=1.449e-03, lr=5.84e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=1.873e-03, best=1.449e-03, lr=5.55e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=5.532e-01, best=1.449e-03, lr=5.27e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.48it/s, loss=2.588e-02, best=1.449e-03, lr=5.01e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.85it/s, loss=2.588e-02, best=1.449e-03, lr=5.01e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.85it/s, loss=4.751e-01, best=1.449e-03, lr=4.76e-01, worse_count=7]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.85it/s, loss=8.329e-04, best=8.329e-04, lr=5.71e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.85it/s, loss=5.703e-01, best=8.329e-04, lr=5.43e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.85it/s, loss=2.772e-02, best=8.329e-04, lr=5.15e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.85it/s, loss=4.877e-01, best=8.329e-04, lr=4.90e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.85it/s, loss=1.951e-03, best=8.329e-04, lr=4.65e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.85it/s, loss=4.632e-01, best=8.329e-04, lr=4.42e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.85it/s, loss=2.131e-02, best=8.329e-04, lr=4.20e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.85it/s, loss=3.985e-01, best=8.329e-04, lr=3.99e-01, worse_count=7]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.85it/s, loss=3.170e-04, best=3.170e-04, lr=4.79e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.85it/s, loss=4.783e-01, best=3.170e-04, lr=4.55e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.85it/s, loss=2.361e-02, best=3.170e-04, lr=4.32e-01, worse_count=2]
                                                                                                                                       
(37/208) Processing tensor: layers.11.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.874e+00, best=1.874e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.865e+00, best=1.865e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.853e+00, best=1.853e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.839e+00, best=1.839e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.822e+00, best=1.822e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.802e+00, best=1.802e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.778e+00, best=1.778e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.749e+00, best=1.749e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.714e+00, best=1.714e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.672e+00, best=1.672e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.622e+00, best=1.622e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.562e+00, best=1.562e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.490e+00, best=1.490e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.403e+00, best=1.403e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.299e+00, best=1.299e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.174e+00, best=1.174e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.025e+00, best=1.025e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.450e-01, best=8.450e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.294e-01, best=6.294e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=6.294e-01, best=6.294e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=3.707e-01, best=3.707e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=6.017e-02, best=6.017e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=3.124e-01, best=6.017e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=4.154e-02, best=4.154e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=3.832e-01, best=4.154e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=2.030e-02, best=2.030e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=4.639e-01, best=2.030e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=3.907e-03, best=3.907e-03, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=5.481e-01, best=3.907e-03, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=2.369e-02, best=3.907e-03, lr=4.98e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=4.745e-01, best=3.907e-03, lr=4.73e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=1.217e-03, best=1.217e-03, lr=5.68e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=5.667e-01, best=1.217e-03, lr=5.39e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=2.718e-02, best=1.217e-03, lr=5.13e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=4.854e-01, best=1.217e-03, lr=4.87e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=1.552e-03, best=1.217e-03, lr=4.63e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=4.610e-01, best=1.217e-03, lr=4.39e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=2.158e-02, best=1.217e-03, lr=4.17e-01, worse_count=6]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=3.959e-01, best=1.217e-03, lr=3.97e-01, worse_count=7]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.97it/s, loss=7.031e-04, best=7.031e-04, lr=4.76e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.65it/s, loss=7.031e-04, best=7.031e-04, lr=4.76e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.65it/s, loss=4.752e-01, best=7.031e-04, lr=4.52e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.65it/s, loss=2.309e-02, best=7.031e-04, lr=4.29e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.65it/s, loss=4.064e-01, best=7.031e-04, lr=4.08e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.65it/s, loss=1.617e-03, best=7.031e-04, lr=3.88e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.65it/s, loss=3.860e-01, best=7.031e-04, lr=3.68e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.65it/s, loss=1.776e-02, best=7.031e-04, lr=3.50e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.65it/s, loss=3.321e-01, best=7.031e-04, lr=3.32e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.65it/s, loss=2.730e-04, best=2.730e-04, lr=3.99e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.65it/s, loss=3.986e-01, best=2.730e-04, lr=3.79e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.65it/s, loss=1.967e-02, best=2.730e-04, lr=3.60e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.65it/s, loss=3.403e-01, best=2.730e-04, lr=3.42e-01, worse_count=3]
                                                                                                                                       
(38/208) Skipping tensor: layers.12.adaLN_modulation.0.weight (Reason: In high-precision list)
(39/208) Processing tensor: layers.12.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.796e+00, best=1.796e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.787e+00, best=1.787e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.776e+00, best=1.776e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.764e+00, best=1.764e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.750e+00, best=1.750e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.735e+00, best=1.735e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.717e+00, best=1.717e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.697e+00, best=1.697e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.674e+00, best=1.674e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.647e+00, best=1.647e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.617e+00, best=1.617e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.583e+00, best=1.583e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.544e+00, best=1.544e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.500e+00, best=1.500e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.449e+00, best=1.449e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.391e+00, best=1.391e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.325e+00, best=1.325e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.250e+00, best=1.250e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.164e+00, best=1.164e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.067e+00, best=1.067e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.554e-01, best=9.554e-01, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.285e-01, best=8.285e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.839e-01, best=6.839e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.190e-01, best=5.190e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.310e-01, best=3.310e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.167e-01, best=1.167e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.276e-01, best=1.167e-01, lr=2.20e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.287e-02, best=9.287e-02, lr=2.51e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.585e-01, best=9.287e-02, lr=2.27e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.836e-02, best=6.836e-02, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.902e-01, best=6.836e-02, lr=2.33e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.315e-02, best=4.315e-02, lr=2.66e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.229e-01, best=4.315e-02, lr=2.40e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.721e-02, best=1.721e-02, lr=2.74e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.565e-01, best=1.721e-02, lr=2.47e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.484e-03, best=9.484e-03, lr=2.82e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.722e-01, best=9.484e-03, lr=2.54e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.798e-02, best=9.484e-03, lr=2.29e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.114e-01, best=9.484e-03, lr=2.07e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.391e-03, best=4.391e-03, lr=2.36e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.316e-01, best=4.391e-03, lr=2.13e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.862e-02, best=4.391e-03, lr=1.92e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.736e-01, best=4.391e-03, lr=1.73e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.223e-04, best=1.223e-04, lr=1.98e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.977e-01, best=1.223e-04, lr=1.78e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.916e-02, best=1.223e-04, lr=1.61e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.419e-01, best=1.223e-04, lr=1.45e-01, worse_count=3]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 461.19it/s, loss=1.419e-01, best=1.223e-04, lr=1.45e-01, worse_count=3]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 461.19it/s, loss=3.455e-03, best=1.223e-04, lr=1.31e-01, worse_count=4]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 461.19it/s, loss=1.278e-01, best=1.223e-04, lr=1.18e-01, worse_count=5]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 461.19it/s, loss=9.338e-03, best=1.223e-04, lr=1.07e-01, worse_count=6]
                                                                                                                                       
(40/208) Processing tensor: layers.12.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.812e+00, best=1.812e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.802e+00, best=1.802e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.791e+00, best=1.791e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.777e+00, best=1.777e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.760e+00, best=1.760e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.740e+00, best=1.740e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.716e+00, best=1.716e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.687e+00, best=1.687e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.652e+00, best=1.652e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.610e+00, best=1.610e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.560e+00, best=1.560e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.500e+00, best=1.500e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.428e+00, best=1.428e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.341e+00, best=1.341e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.237e+00, best=1.237e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.112e+00, best=1.112e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.624e-01, best=9.624e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.827e-01, best=7.827e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=7.827e-01, best=7.827e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=5.671e-01, best=5.671e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=3.083e-01, best=3.083e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=2.132e-03, best=2.132e-03, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=3.704e-01, best=2.132e-03, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=1.650e-02, best=2.132e-03, lr=3.36e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=3.198e-01, best=2.132e-03, lr=3.19e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=3.164e-04, best=3.164e-04, lr=3.83e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=3.830e-01, best=3.164e-04, lr=3.64e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=1.885e-02, best=3.164e-04, lr=3.46e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=3.271e-01, best=3.164e-04, lr=3.29e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=1.552e-03, best=3.164e-04, lr=3.12e-01, worse_count=4]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=3.107e-01, best=3.164e-04, lr=2.97e-01, worse_count=5]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=1.406e-02, best=3.164e-04, lr=2.82e-01, worse_count=6]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=2.677e-01, best=3.164e-04, lr=2.68e-01, worse_count=7]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=3.221e-05, best=3.221e-05, lr=3.21e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=3.212e-01, best=3.221e-05, lr=3.05e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=1.603e-02, best=3.221e-05, lr=2.90e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.22it/s, loss=2.739e-01, best=3.221e-05, lr=2.75e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.01it/s, loss=2.739e-01, best=3.221e-05, lr=2.75e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.01it/s, loss=1.534e-03, best=3.221e-05, lr=2.62e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.01it/s, loss=2.601e-01, best=3.221e-05, lr=2.49e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.01it/s, loss=1.155e-02, best=3.221e-05, lr=2.36e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.01it/s, loss=2.246e-01, best=3.221e-05, lr=2.24e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.01it/s, loss=2.586e-04, best=3.221e-05, lr=2.13e-01, worse_count=8]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.01it/s, loss=2.128e-01, best=3.221e-05, lr=2.02e-01, worse_count=9]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.01it/s, loss=1.040e-02, best=3.221e-05, lr=1.92e-01, worse_count=10]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.01it/s, loss=1.819e-01, best=3.221e-05, lr=1.83e-01, worse_count=11]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.01it/s, loss=7.803e-04, best=3.221e-05, lr=1.74e-01, worse_count=12]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.01it/s, loss=1.728e-01, best=3.221e-05, lr=1.65e-01, worse_count=13]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.01it/s, loss=7.898e-03, best=3.221e-05, lr=1.57e-01, worse_count=14]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.01it/s, loss=1.488e-01, best=3.221e-05, lr=1.49e-01, worse_count=15]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.01it/s, loss=6.629e-05, best=3.221e-05, lr=1.41e-01, worse_count=16]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.01it/s, loss=1.413e-01, best=3.221e-05, lr=1.34e-01, worse_count=17]
                                                                                                                                        
(41/208) Processing tensor: layers.12.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.009e+00, best=2.009e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.999e+00, best=1.999e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.988e+00, best=1.988e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.974e+00, best=1.974e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.957e+00, best=1.957e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.937e+00, best=1.937e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.913e+00, best=1.913e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.884e+00, best=1.884e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.849e+00, best=1.849e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.807e+00, best=1.807e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.757e+00, best=1.757e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.697e+00, best=1.697e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.624e+00, best=1.624e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.538e+00, best=1.538e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.434e+00, best=1.434e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.309e+00, best=1.309e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.159e+00, best=1.159e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.796e-01, best=9.796e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.640e-01, best=7.640e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=7.640e-01, best=7.640e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=5.052e-01, best=5.052e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=1.948e-01, best=1.948e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=1.778e-01, best=1.778e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=2.693e-01, best=1.778e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=1.555e-01, best=1.555e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=3.542e-01, best=1.555e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=1.300e-01, best=1.300e-01, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=4.511e-01, best=1.300e-01, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=1.009e-01, best=1.009e-01, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=5.615e-01, best=1.009e-01, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=6.780e-02, best=6.780e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=6.873e-01, best=6.780e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=3.004e-02, best=3.004e-02, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=8.308e-01, best=3.004e-02, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=1.300e-02, best=1.300e-02, lr=9.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=9.684e-01, best=1.300e-02, lr=9.32e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=3.607e-02, best=1.300e-02, lr=8.86e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=8.496e-01, best=1.300e-02, lr=8.41e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=8.217e-03, best=8.217e-03, lr=1.01e+00, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.70it/s, loss=1.001e+00, best=8.217e-03, lr=9.59e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.51it/s, loss=1.001e+00, best=8.217e-03, lr=9.59e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.51it/s, loss=4.227e-02, best=8.217e-03, lr=9.11e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.51it/s, loss=8.690e-01, best=8.217e-03, lr=8.66e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.51it/s, loss=3.295e-03, best=3.295e-03, lr=1.04e+00, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.51it/s, loss=1.035e+00, best=3.295e-03, lr=9.87e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.51it/s, loss=4.864e-02, best=3.295e-03, lr=9.37e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.51it/s, loss=8.889e-01, best=3.295e-03, lr=8.91e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.51it/s, loss=1.770e-03, best=1.770e-03, lr=1.07e+00, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.51it/s, loss=1.067e+00, best=1.770e-03, lr=1.02e+00, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.51it/s, loss=5.167e-02, best=1.770e-03, lr=9.64e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.51it/s, loss=9.129e-01, best=1.770e-03, lr=9.16e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.51it/s, loss=3.441e-03, best=1.770e-03, lr=8.70e-01, worse_count=4]
                                                                                                                                       
(42/208) Processing tensor: layers.12.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.044e+00, best=2.044e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.034e+00, best=2.034e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.022e+00, best=2.022e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.008e+00, best=2.008e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.992e+00, best=1.992e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.971e+00, best=1.971e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.947e+00, best=1.947e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.918e+00, best=1.918e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.883e+00, best=1.883e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.842e+00, best=1.842e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.791e+00, best=1.791e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.731e+00, best=1.731e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.659e+00, best=1.659e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.572e+00, best=1.572e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.468e+00, best=1.468e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.344e+00, best=1.344e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.194e+00, best=1.194e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.014e+00, best=1.014e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.987e-01, best=7.987e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=7.987e-01, best=7.987e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=5.399e-01, best=5.399e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=2.294e-01, best=2.294e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=1.431e-01, best=1.431e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=3.040e-01, best=1.431e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=1.208e-01, best=1.208e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=3.889e-01, best=1.208e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=9.529e-02, best=9.529e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=4.858e-01, best=9.529e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=6.624e-02, best=6.624e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=5.962e-01, best=6.624e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=3.312e-02, best=3.312e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=7.220e-01, best=3.312e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=4.636e-03, best=4.636e-03, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=8.562e-01, best=4.636e-03, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=3.841e-02, best=4.636e-03, lr=7.77e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=7.385e-01, best=4.636e-03, lr=7.38e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=4.406e-04, best=4.406e-04, lr=8.86e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=8.852e-01, best=4.406e-04, lr=8.41e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.16it/s, loss=4.384e-02, best=4.406e-04, lr=7.99e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.94it/s, loss=4.384e-02, best=4.406e-04, lr=7.99e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.94it/s, loss=7.555e-01, best=4.406e-04, lr=7.59e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.94it/s, loss=3.877e-03, best=4.406e-04, lr=7.21e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.94it/s, loss=7.175e-01, best=4.406e-04, lr=6.85e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.94it/s, loss=3.219e-02, best=4.406e-04, lr=6.51e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.94it/s, loss=6.189e-01, best=4.406e-04, lr=6.18e-01, worse_count=7]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.94it/s, loss=3.618e-04, best=3.618e-04, lr=7.42e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.94it/s, loss=7.418e-01, best=3.618e-04, lr=7.05e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.94it/s, loss=3.675e-02, best=3.618e-04, lr=6.70e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.94it/s, loss=6.331e-01, best=3.618e-04, lr=6.36e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.94it/s, loss=3.257e-03, best=3.618e-04, lr=6.04e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.94it/s, loss=6.013e-01, best=3.618e-04, lr=5.74e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.94it/s, loss=2.697e-02, best=3.618e-04, lr=5.46e-01, worse_count=6]
                                                                                                                                       
(43/208) Processing tensor: layers.12.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.818e+00, best=1.818e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.809e+00, best=1.809e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.797e+00, best=1.797e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.783e+00, best=1.783e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.766e+00, best=1.766e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.746e+00, best=1.746e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.722e+00, best=1.722e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.693e+00, best=1.693e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.658e+00, best=1.658e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.616e+00, best=1.616e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.566e+00, best=1.566e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.506e+00, best=1.506e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.434e+00, best=1.434e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.347e+00, best=1.347e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.243e+00, best=1.243e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.118e+00, best=1.118e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.685e-01, best=9.685e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.888e-01, best=7.888e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.732e-01, best=5.732e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.145e-01, best=3.145e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=3.145e-01, best=3.145e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=3.985e-03, best=3.985e-03, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=3.686e-01, best=3.985e-03, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=1.464e-02, best=3.985e-03, lr=3.36e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=3.216e-01, best=3.985e-03, lr=3.19e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=2.169e-03, best=2.169e-03, lr=3.83e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=3.812e-01, best=2.169e-03, lr=3.64e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=1.700e-02, best=2.169e-03, lr=3.46e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=3.290e-01, best=2.169e-03, lr=3.29e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=3.002e-04, best=3.002e-04, lr=3.94e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=3.941e-01, best=3.002e-04, lr=3.75e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=1.942e-02, best=3.002e-04, lr=3.56e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=3.365e-01, best=3.002e-04, lr=3.38e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=1.622e-03, best=3.002e-04, lr=3.21e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=3.196e-01, best=3.002e-04, lr=3.05e-01, worse_count=5]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=1.444e-02, best=3.002e-04, lr=2.90e-01, worse_count=6]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=2.755e-01, best=3.002e-04, lr=2.75e-01, worse_count=7]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=5.745e-05, best=5.745e-05, lr=3.30e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=3.304e-01, best=5.745e-05, lr=3.14e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=1.647e-02, best=5.745e-05, lr=2.98e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=2.818e-01, best=5.745e-05, lr=2.83e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.74it/s, loss=1.554e-03, best=5.745e-05, lr=2.69e-01, worse_count=4]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 195.79it/s, loss=1.554e-03, best=5.745e-05, lr=2.69e-01, worse_count=4]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 195.79it/s, loss=2.676e-01, best=5.745e-05, lr=2.56e-01, worse_count=5]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 195.79it/s, loss=1.191e-02, best=5.745e-05, lr=2.43e-01, worse_count=6]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 195.79it/s, loss=2.310e-01, best=5.745e-05, lr=2.31e-01, worse_count=7]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 195.79it/s, loss=2.418e-04, best=5.745e-05, lr=2.19e-01, worse_count=8]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 195.79it/s, loss=2.190e-01, best=5.745e-05, lr=2.08e-01, worse_count=9]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 195.79it/s, loss=1.072e-02, best=5.745e-05, lr=1.98e-01, worse_count=10]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 195.79it/s, loss=1.872e-01, best=5.745e-05, lr=1.88e-01, worse_count=11]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 195.79it/s, loss=8.272e-04, best=5.745e-05, lr=1.79e-01, worse_count=12]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 195.79it/s, loss=1.778e-01, best=5.745e-05, lr=1.70e-01, worse_count=13]
                                                                                                                                        
(44/208) Skipping tensor: layers.13.adaLN_modulation.0.weight (Reason: In high-precision list)
(45/208) Processing tensor: layers.13.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.771e+00, best=1.771e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.762e+00, best=1.762e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.752e+00, best=1.752e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.740e+00, best=1.740e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.726e+00, best=1.726e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.710e+00, best=1.710e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.693e+00, best=1.693e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.672e+00, best=1.672e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.649e+00, best=1.649e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.623e+00, best=1.623e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.593e+00, best=1.593e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.559e+00, best=1.559e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.520e+00, best=1.520e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.475e+00, best=1.475e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.424e+00, best=1.424e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.367e+00, best=1.367e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.301e+00, best=1.301e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.226e+00, best=1.226e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.140e+00, best=1.140e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.042e+00, best=1.042e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.310e-01, best=9.310e-01, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.041e-01, best=8.041e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.594e-01, best=6.594e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.945e-01, best=4.945e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.066e-01, best=3.066e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.225e-02, best=9.225e-02, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.521e-01, best=9.225e-02, lr=2.20e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.843e-02, best=6.843e-02, lr=2.51e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.829e-01, best=6.843e-02, lr=2.27e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.393e-02, best=4.393e-02, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.147e-01, best=4.393e-02, lr=2.33e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.871e-02, best=1.871e-02, lr=2.66e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.474e-01, best=1.871e-02, lr=2.40e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.230e-03, best=7.230e-03, lr=2.74e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.665e-01, best=7.230e-03, lr=2.47e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.946e-02, best=7.230e-03, lr=2.23e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.035e-01, best=7.230e-03, lr=2.01e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.280e-03, best=2.280e-03, lr=2.29e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.271e-01, best=2.280e-03, lr=2.07e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.009e-02, best=2.280e-03, lr=1.87e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.668e-01, best=2.280e-03, lr=1.69e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.869e-03, best=1.869e-03, lr=1.92e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.904e-01, best=1.869e-03, lr=1.73e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.687e-02, best=1.869e-03, lr=1.57e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.397e-01, best=1.869e-03, lr=1.41e-01, worse_count=3]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 439.58it/s, loss=1.397e-01, best=1.869e-03, lr=1.41e-01, worse_count=3]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 439.58it/s, loss=1.607e-03, best=1.607e-03, lr=1.61e-01, worse_count=0]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 439.58it/s, loss=1.595e-01, best=1.607e-03, lr=1.45e-01, worse_count=1]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 439.58it/s, loss=1.410e-02, best=1.607e-03, lr=1.31e-01, worse_count=2]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 439.58it/s, loss=1.171e-01, best=1.607e-03, lr=1.18e-01, worse_count=3]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 439.58it/s, loss=1.306e-03, best=1.306e-03, lr=1.35e-01, worse_count=0]
                                                                                                                                       
(46/208) Processing tensor: layers.13.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.112e+00, best=2.112e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.102e+00, best=2.102e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.091e+00, best=2.091e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.077e+00, best=2.077e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.060e+00, best=2.060e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.040e+00, best=2.040e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.016e+00, best=2.016e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.987e+00, best=1.987e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.952e+00, best=1.952e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.910e+00, best=1.910e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.860e+00, best=1.860e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.800e+00, best=1.800e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.727e+00, best=1.727e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.641e+00, best=1.641e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.537e+00, best=1.537e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.412e+00, best=1.412e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.262e+00, best=1.262e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.083e+00, best=1.083e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=1.083e+00, best=1.083e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=8.671e-01, best=8.671e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=6.083e-01, best=6.083e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=2.979e-01, best=2.979e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=7.471e-02, best=7.471e-02, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=3.724e-01, best=7.471e-02, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=5.235e-02, best=5.235e-02, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=4.573e-01, best=5.235e-02, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=2.687e-02, best=2.687e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=5.542e-01, best=2.687e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=2.183e-03, best=2.183e-03, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=6.602e-01, best=2.183e-03, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=3.094e-02, best=2.183e-03, lr=5.98e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=5.669e-01, best=2.183e-03, lr=5.68e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=1.047e-03, best=1.047e-03, lr=6.81e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=6.804e-01, best=1.047e-03, lr=6.47e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=3.303e-02, best=1.047e-03, lr=6.15e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=5.820e-01, best=1.047e-03, lr=5.84e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.84it/s, loss=2.276e-03, best=1.047e-03, lr=5.55e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.82it/s, loss=2.276e-03, best=1.047e-03, lr=5.55e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.82it/s, loss=5.528e-01, best=1.047e-03, lr=5.27e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.82it/s, loss=2.548e-02, best=1.047e-03, lr=5.01e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.82it/s, loss=4.755e-01, best=1.047e-03, lr=4.76e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.82it/s, loss=4.310e-04, best=4.310e-04, lr=5.71e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.82it/s, loss=5.707e-01, best=4.310e-04, lr=5.43e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.82it/s, loss=2.812e-02, best=4.310e-04, lr=5.15e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.82it/s, loss=4.873e-01, best=4.310e-04, lr=4.90e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.82it/s, loss=2.353e-03, best=4.310e-04, lr=4.65e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.82it/s, loss=4.628e-01, best=4.310e-04, lr=4.42e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.82it/s, loss=2.090e-02, best=4.310e-04, lr=4.20e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.82it/s, loss=3.989e-01, best=4.310e-04, lr=3.99e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.82it/s, loss=8.723e-05, best=8.723e-05, lr=4.79e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.82it/s, loss=4.785e-01, best=8.723e-05, lr=4.55e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.82it/s, loss=2.384e-02, best=8.723e-05, lr=4.32e-01, worse_count=2]
                                                                                                                                       
(47/208) Processing tensor: layers.13.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.896e+00, best=1.896e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.887e+00, best=1.887e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.875e+00, best=1.875e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.861e+00, best=1.861e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.844e+00, best=1.844e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.824e+00, best=1.824e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.800e+00, best=1.800e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.771e+00, best=1.771e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.736e+00, best=1.736e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.694e+00, best=1.694e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.644e+00, best=1.644e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.584e+00, best=1.584e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.512e+00, best=1.512e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.425e+00, best=1.425e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.321e+00, best=1.321e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.196e+00, best=1.196e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.047e+00, best=1.047e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.670e-01, best=8.670e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.514e-01, best=6.514e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.927e-01, best=3.927e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=3.927e-01, best=3.927e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=8.218e-02, best=8.218e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=2.904e-01, best=8.218e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=6.355e-02, best=6.355e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=3.612e-01, best=6.355e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=4.232e-02, best=4.232e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=4.419e-01, best=4.232e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=1.811e-02, best=1.811e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=5.339e-01, best=1.811e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=9.493e-03, best=9.493e-03, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=6.198e-01, best=9.493e-03, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=2.197e-02, best=9.493e-03, lr=5.68e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=5.459e-01, best=9.493e-03, lr=5.39e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=6.425e-03, best=6.425e-03, lr=6.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=6.410e-01, best=6.425e-03, lr=6.15e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=2.595e-02, best=6.425e-03, lr=5.84e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=5.584e-01, best=6.425e-03, lr=5.55e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=3.269e-03, best=3.269e-03, lr=6.66e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=6.628e-01, best=3.269e-03, lr=6.33e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=3.004e-02, best=3.269e-03, lr=6.01e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.98it/s, loss=5.711e-01, best=3.269e-03, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.79it/s, loss=5.711e-01, best=3.269e-03, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.79it/s, loss=3.240e-05, best=3.240e-05, lr=6.85e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.79it/s, loss=6.852e-01, best=3.240e-05, lr=6.51e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.79it/s, loss=3.423e-02, best=3.240e-05, lr=6.18e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.79it/s, loss=5.842e-01, best=3.240e-05, lr=5.88e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.79it/s, loss=3.309e-03, best=3.240e-05, lr=5.58e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.79it/s, loss=5.549e-01, best=3.240e-05, lr=5.30e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.79it/s, loss=2.460e-02, best=3.240e-05, lr=5.04e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.79it/s, loss=4.791e-01, best=3.240e-05, lr=4.79e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.79it/s, loss=5.880e-04, best=3.240e-05, lr=4.55e-01, worse_count=8]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.79it/s, loss=4.540e-01, best=3.240e-05, lr=4.32e-01, worse_count=9]
                                                                                                                                       
(48/208) Processing tensor: layers.13.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.989e+00, best=1.989e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.980e+00, best=1.980e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.968e+00, best=1.968e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.954e+00, best=1.954e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.937e+00, best=1.937e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.917e+00, best=1.917e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.893e+00, best=1.893e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.864e+00, best=1.864e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.829e+00, best=1.829e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.787e+00, best=1.787e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.737e+00, best=1.737e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.677e+00, best=1.677e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.605e+00, best=1.605e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.518e+00, best=1.518e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.414e+00, best=1.414e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.289e+00, best=1.289e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.139e+00, best=1.139e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.598e-01, best=9.598e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=9.598e-01, best=9.598e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=7.442e-01, best=7.442e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=4.854e-01, best=4.854e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=1.749e-01, best=1.749e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=1.976e-01, best=1.749e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=1.563e-01, best=1.563e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=2.684e-01, best=1.563e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=1.351e-01, best=1.351e-01, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=3.491e-01, best=1.351e-01, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=1.109e-01, best=1.109e-01, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=4.411e-01, best=1.109e-01, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=8.327e-02, best=8.327e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=5.460e-01, best=8.327e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=5.180e-02, best=5.180e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=6.656e-01, best=5.180e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=1.593e-02, best=1.593e-02, lr=8.18e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=8.019e-01, best=1.593e-02, lr=7.77e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=2.496e-02, best=1.593e-02, lr=7.38e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=7.131e-01, best=1.593e-02, lr=7.01e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 178.26it/s, loss=1.195e-02, best=1.195e-02, lr=8.41e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 181.67it/s, loss=1.195e-02, best=1.195e-02, lr=8.41e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 181.67it/s, loss=8.294e-01, best=1.195e-02, lr=7.99e-01, worse_count=1]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 181.67it/s, loss=3.012e-02, best=1.195e-02, lr=7.59e-01, worse_count=2]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 181.67it/s, loss=7.292e-01, best=1.195e-02, lr=7.21e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 181.67it/s, loss=7.846e-03, best=7.846e-03, lr=8.66e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 181.67it/s, loss=8.578e-01, best=7.846e-03, lr=8.22e-01, worse_count=1]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 181.67it/s, loss=3.544e-02, best=7.846e-03, lr=7.81e-01, worse_count=2]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 181.67it/s, loss=7.458e-01, best=7.846e-03, lr=7.42e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 181.67it/s, loss=3.626e-03, best=3.626e-03, lr=8.91e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 181.67it/s, loss=8.870e-01, best=3.626e-03, lr=8.46e-01, worse_count=1]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 181.67it/s, loss=4.091e-02, best=3.626e-03, lr=8.04e-01, worse_count=2]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 181.67it/s, loss=7.629e-01, best=3.626e-03, lr=7.64e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 181.67it/s, loss=7.169e-04, best=7.169e-04, lr=9.16e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 181.67it/s, loss=9.156e-01, best=7.169e-04, lr=8.70e-01, worse_count=1]
                                                                                                                                       
(49/208) Processing tensor: layers.13.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.814e+00, best=1.814e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.804e+00, best=1.804e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.792e+00, best=1.792e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.778e+00, best=1.778e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.762e+00, best=1.762e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.741e+00, best=1.741e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.717e+00, best=1.717e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.688e+00, best=1.688e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.653e+00, best=1.653e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.612e+00, best=1.612e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.562e+00, best=1.562e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.501e+00, best=1.501e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.429e+00, best=1.429e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.342e+00, best=1.342e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.239e+00, best=1.239e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.114e+00, best=1.114e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.640e-01, best=9.640e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.843e-01, best=7.843e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.687e-01, best=5.687e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=5.687e-01, best=5.687e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=3.100e-01, best=3.100e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=5.112e-04, best=5.112e-04, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=3.721e-01, best=5.112e-04, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=1.812e-02, best=5.112e-04, lr=3.36e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=3.181e-01, best=5.112e-04, lr=3.19e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=1.305e-03, best=5.112e-04, lr=3.03e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=3.022e-01, best=5.112e-04, lr=2.88e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=1.387e-02, best=5.112e-04, lr=2.74e-01, worse_count=6]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=2.600e-01, best=5.112e-04, lr=2.60e-01, worse_count=7]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=1.745e-04, best=1.745e-04, lr=3.12e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=3.121e-01, best=1.745e-04, lr=2.97e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=1.544e-02, best=1.745e-04, lr=2.82e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=2.663e-01, best=1.745e-04, lr=2.68e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=1.348e-03, best=1.745e-04, lr=2.54e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=2.530e-01, best=1.745e-04, lr=2.42e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=1.137e-02, best=1.745e-04, lr=2.29e-01, worse_count=6]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=2.181e-01, best=1.745e-04, lr=2.18e-01, worse_count=7]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=1.082e-04, best=1.082e-04, lr=2.62e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=2.615e-01, best=1.082e-04, lr=2.49e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=1.297e-02, best=1.082e-04, lr=2.36e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 188.17it/s, loss=2.232e-01, best=1.082e-04, lr=2.24e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.90it/s, loss=2.232e-01, best=1.082e-04, lr=2.24e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.90it/s, loss=1.167e-03, best=1.082e-04, lr=2.13e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.90it/s, loss=2.119e-01, best=1.082e-04, lr=2.02e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.90it/s, loss=9.488e-03, best=1.082e-04, lr=1.92e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.90it/s, loss=1.828e-01, best=1.082e-04, lr=1.83e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.90it/s, loss=1.287e-04, best=1.082e-04, lr=1.74e-01, worse_count=8]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.90it/s, loss=1.735e-01, best=1.082e-04, lr=1.65e-01, worse_count=9]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.90it/s, loss=8.550e-03, best=1.082e-04, lr=1.57e-01, worse_count=10]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.90it/s, loss=1.481e-01, best=1.082e-04, lr=1.49e-01, worse_count=11]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.90it/s, loss=7.175e-04, best=1.082e-04, lr=1.41e-01, worse_count=12]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.90it/s, loss=1.407e-01, best=1.082e-04, lr=1.34e-01, worse_count=13]
                                                                                                                                        
(50/208) Skipping tensor: layers.14.adaLN_modulation.0.weight (Reason: In high-precision list)
(51/208) Processing tensor: layers.14.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.860e+00, best=1.860e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.850e+00, best=1.850e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.840e+00, best=1.840e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.828e+00, best=1.828e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.814e+00, best=1.814e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.799e+00, best=1.799e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.781e+00, best=1.781e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.761e+00, best=1.761e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.737e+00, best=1.737e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.711e+00, best=1.711e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.681e+00, best=1.681e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.647e+00, best=1.647e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.608e+00, best=1.608e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.563e+00, best=1.563e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.513e+00, best=1.513e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.455e+00, best=1.455e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.389e+00, best=1.389e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.314e+00, best=1.314e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.228e+00, best=1.228e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.131e+00, best=1.131e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.019e+00, best=1.019e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.924e-01, best=8.924e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.477e-01, best=7.477e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.828e-01, best=5.828e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.948e-01, best=3.948e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.805e-01, best=1.805e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.379e-02, best=6.379e-02, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.147e-01, best=6.379e-02, lr=2.51e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.664e-02, best=3.664e-02, lr=2.87e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.499e-01, best=3.664e-02, lr=2.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.700e-03, best=8.700e-03, lr=2.95e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.861e-01, best=8.700e-03, lr=2.66e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.004e-02, best=8.700e-03, lr=2.40e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.201e-01, best=8.700e-03, lr=2.17e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.368e-03, best=3.368e-03, lr=2.47e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.437e-01, best=3.368e-03, lr=2.23e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.072e-02, best=3.368e-03, lr=2.01e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.805e-01, best=3.368e-03, lr=1.82e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.100e-03, best=1.100e-03, lr=2.07e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.059e-01, best=1.100e-03, lr=1.87e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.909e-02, best=1.100e-03, lr=1.69e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.495e-01, best=1.100e-03, lr=1.52e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.644e-03, best=1.100e-03, lr=1.37e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.347e-01, best=1.100e-03, lr=1.24e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.075e-02, best=1.100e-03, lr=1.12e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.011e-01, best=1.100e-03, lr=1.01e-01, worse_count=7]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 451.16it/s, loss=1.011e-01, best=1.100e-03, lr=1.01e-01, worse_count=7]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 451.16it/s, loss=1.599e-04, best=1.599e-04, lr=1.15e-01, worse_count=0]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 451.16it/s, loss=1.149e-01, best=1.599e-04, lr=1.04e-01, worse_count=1]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 451.16it/s, loss=1.106e-02, best=1.599e-04, lr=9.37e-02, worse_count=2]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 451.16it/s, loss=8.269e-02, best=1.599e-04, lr=8.46e-02, worse_count=3]
                                                                                                                                       
(52/208) Processing tensor: layers.14.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.920e+00, best=1.920e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.911e+00, best=1.911e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.899e+00, best=1.899e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.885e+00, best=1.885e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.868e+00, best=1.868e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.848e+00, best=1.848e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.824e+00, best=1.824e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.795e+00, best=1.795e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.760e+00, best=1.760e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.718e+00, best=1.718e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.668e+00, best=1.668e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.608e+00, best=1.608e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.536e+00, best=1.536e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.449e+00, best=1.449e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.345e+00, best=1.345e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.220e+00, best=1.220e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.071e+00, best=1.071e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.909e-01, best=8.909e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=8.909e-01, best=8.909e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=6.753e-01, best=6.753e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=4.166e-01, best=4.166e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=1.061e-01, best=1.061e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=2.665e-01, best=1.061e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=8.748e-02, best=8.748e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=3.373e-01, best=8.748e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=6.624e-02, best=6.624e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=4.180e-01, best=6.624e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=4.203e-02, best=4.203e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=5.100e-01, best=4.203e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=1.443e-02, best=1.443e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=6.148e-01, best=1.443e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=1.703e-02, best=1.443e-02, lr=5.68e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=5.509e-01, best=1.443e-02, lr=5.39e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=1.136e-02, best=1.136e-02, lr=6.47e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=6.361e-01, best=1.136e-02, lr=6.15e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=2.101e-02, best=1.136e-02, lr=5.84e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 175.99it/s, loss=5.633e-01, best=1.136e-02, lr=5.55e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.02it/s, loss=5.633e-01, best=1.136e-02, lr=5.55e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.02it/s, loss=8.208e-03, best=8.208e-03, lr=6.66e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.02it/s, loss=6.579e-01, best=8.208e-03, lr=6.33e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.02it/s, loss=2.510e-02, best=8.208e-03, lr=6.01e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.02it/s, loss=5.761e-01, best=8.208e-03, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.02it/s, loss=4.961e-03, best=4.961e-03, lr=6.85e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.02it/s, loss=6.804e-01, best=4.961e-03, lr=6.51e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.02it/s, loss=2.931e-02, best=4.961e-03, lr=6.18e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.02it/s, loss=5.892e-01, best=4.961e-03, lr=5.88e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.02it/s, loss=1.620e-03, best=1.620e-03, lr=7.05e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.02it/s, loss=7.035e-01, best=1.620e-03, lr=6.70e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.02it/s, loss=3.363e-02, best=1.620e-03, lr=6.36e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.02it/s, loss=6.027e-01, best=1.620e-03, lr=6.04e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.02it/s, loss=1.818e-03, best=1.620e-03, lr=5.74e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.02it/s, loss=5.725e-01, best=1.620e-03, lr=5.46e-01, worse_count=5]
                                                                                                                                       
(53/208) Processing tensor: layers.14.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.871e+00, best=1.871e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.861e+00, best=1.861e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.850e+00, best=1.850e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.836e+00, best=1.836e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.819e+00, best=1.819e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.799e+00, best=1.799e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.774e+00, best=1.774e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.745e+00, best=1.745e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.711e+00, best=1.711e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.669e+00, best=1.669e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.619e+00, best=1.619e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.559e+00, best=1.559e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.486e+00, best=1.486e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.400e+00, best=1.400e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.296e+00, best=1.296e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.171e+00, best=1.171e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.021e+00, best=1.021e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.415e-01, best=8.415e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.259e-01, best=6.259e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.671e-01, best=3.671e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=3.671e-01, best=3.671e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=5.666e-02, best=5.666e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=3.159e-01, best=5.666e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=3.803e-02, best=3.803e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=3.867e-01, best=3.803e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=1.680e-02, best=1.680e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=4.674e-01, best=1.680e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=7.415e-03, best=7.415e-03, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=5.446e-01, best=7.415e-03, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=2.018e-02, best=7.415e-03, lr=4.98e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=4.780e-01, best=7.415e-03, lr=4.73e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=4.724e-03, best=4.724e-03, lr=5.68e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=5.632e-01, best=4.724e-03, lr=5.39e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=2.367e-02, best=4.724e-03, lr=5.13e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=4.889e-01, best=4.724e-03, lr=4.87e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=1.955e-03, best=1.955e-03, lr=5.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=5.823e-01, best=1.955e-03, lr=5.55e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=2.726e-02, best=1.955e-03, lr=5.27e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=5.001e-01, best=1.955e-03, lr=5.01e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=8.935e-04, best=8.935e-04, lr=6.01e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.25it/s, loss=6.003e-01, best=8.935e-04, lr=5.71e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.91it/s, loss=6.003e-01, best=8.935e-04, lr=5.71e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.91it/s, loss=2.916e-02, best=8.935e-04, lr=5.43e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.91it/s, loss=5.134e-01, best=8.935e-04, lr=5.15e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.91it/s, loss=2.037e-03, best=8.935e-04, lr=4.90e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.91it/s, loss=4.876e-01, best=8.935e-04, lr=4.65e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.91it/s, loss=2.245e-02, best=8.935e-04, lr=4.42e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.91it/s, loss=4.195e-01, best=8.935e-04, lr=4.20e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.91it/s, loss=3.503e-04, best=3.503e-04, lr=5.04e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.91it/s, loss=5.034e-01, best=3.503e-04, lr=4.79e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.91it/s, loss=2.484e-02, best=3.503e-04, lr=4.55e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.91it/s, loss=4.298e-01, best=3.503e-04, lr=4.32e-01, worse_count=3]
                                                                                                                                       
(54/208) Processing tensor: layers.14.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.003e+00, best=2.003e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.993e+00, best=1.993e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.981e+00, best=1.981e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.967e+00, best=1.967e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.950e+00, best=1.950e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.930e+00, best=1.930e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.906e+00, best=1.906e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.877e+00, best=1.877e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.842e+00, best=1.842e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.800e+00, best=1.800e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.750e+00, best=1.750e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.690e+00, best=1.690e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.618e+00, best=1.618e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.531e+00, best=1.531e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.427e+00, best=1.427e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.302e+00, best=1.302e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.153e+00, best=1.153e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.731e-01, best=9.731e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.575e-01, best=7.575e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=7.575e-01, best=7.575e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=4.987e-01, best=4.987e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=1.882e-01, best=1.882e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=1.843e-01, best=1.843e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=2.628e-01, best=1.843e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=1.620e-01, best=1.620e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=3.477e-01, best=1.620e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=1.365e-01, best=1.365e-01, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=4.445e-01, best=1.365e-01, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=1.074e-01, best=1.074e-01, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=5.549e-01, best=1.074e-01, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=7.433e-02, best=7.433e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=6.808e-01, best=7.433e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=3.657e-02, best=3.657e-02, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=8.243e-01, best=3.657e-02, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=6.470e-03, best=6.470e-03, lr=9.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=9.749e-01, best=6.470e-03, lr=9.32e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=4.260e-02, best=6.470e-03, lr=8.86e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=8.431e-01, best=6.470e-03, lr=8.41e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.97it/s, loss=1.686e-03, best=1.686e-03, lr=1.01e+00, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.56it/s, loss=1.686e-03, best=1.686e-03, lr=1.01e+00, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.56it/s, loss=1.008e+00, best=1.686e-03, lr=9.59e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.56it/s, loss=4.880e-02, best=1.686e-03, lr=9.11e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.56it/s, loss=8.624e-01, best=1.686e-03, lr=8.66e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.56it/s, loss=3.236e-03, best=1.686e-03, lr=8.22e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.56it/s, loss=8.191e-01, best=1.686e-03, lr=7.81e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.56it/s, loss=3.788e-02, best=1.686e-03, lr=7.42e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.56it/s, loss=7.043e-01, best=1.686e-03, lr=7.05e-01, worse_count=7]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.56it/s, loss=7.735e-04, best=7.735e-04, lr=8.46e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.56it/s, loss=8.453e-01, best=7.735e-04, lr=8.04e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.56it/s, loss=4.153e-02, best=7.735e-04, lr=7.64e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.56it/s, loss=7.221e-01, best=7.735e-04, lr=7.25e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.56it/s, loss=3.351e-03, best=7.735e-04, lr=6.89e-01, worse_count=4]
                                                                                                                                       
(55/208) Processing tensor: layers.14.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.061e+00, best=2.061e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.051e+00, best=2.051e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.039e+00, best=2.039e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.025e+00, best=2.025e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.008e+00, best=2.008e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.988e+00, best=1.988e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.964e+00, best=1.964e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.935e+00, best=1.935e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.900e+00, best=1.900e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.858e+00, best=1.858e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.808e+00, best=1.808e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.748e+00, best=1.748e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.676e+00, best=1.676e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.589e+00, best=1.589e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.485e+00, best=1.485e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.361e+00, best=1.361e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.211e+00, best=1.211e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.031e+00, best=1.031e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.155e-01, best=8.155e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=8.155e-01, best=8.155e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=5.567e-01, best=5.567e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=2.463e-01, best=2.463e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=1.263e-01, best=1.263e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=3.208e-01, best=1.263e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=1.040e-01, best=1.040e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=4.057e-01, best=1.040e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=7.847e-02, best=7.847e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=5.026e-01, best=7.847e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=4.942e-02, best=4.942e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=6.130e-01, best=4.942e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=1.630e-02, best=1.630e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=7.388e-01, best=1.630e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=2.145e-02, best=1.630e-02, lr=6.81e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=6.600e-01, best=1.630e-02, lr=6.47e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=1.262e-02, best=1.262e-02, lr=7.77e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=7.643e-01, best=1.262e-02, lr=7.38e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=2.622e-02, best=1.262e-02, lr=7.01e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=6.749e-01, best=1.262e-02, lr=6.66e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=8.834e-03, best=8.834e-03, lr=7.99e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.88it/s, loss=7.905e-01, best=8.834e-03, lr=7.59e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.26it/s, loss=7.905e-01, best=8.834e-03, lr=7.59e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.26it/s, loss=3.113e-02, best=8.834e-03, lr=7.21e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.26it/s, loss=6.903e-01, best=8.834e-03, lr=6.85e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.26it/s, loss=4.938e-03, best=4.938e-03, lr=8.22e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.26it/s, loss=8.174e-01, best=4.938e-03, lr=7.81e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.26it/s, loss=3.618e-02, best=4.938e-03, lr=7.42e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.26it/s, loss=7.060e-01, best=4.938e-03, lr=7.05e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.26it/s, loss=9.291e-04, best=9.291e-04, lr=8.46e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.26it/s, loss=8.452e-01, best=9.291e-04, lr=8.04e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.26it/s, loss=4.138e-02, best=9.291e-04, lr=7.64e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.26it/s, loss=7.222e-01, best=9.291e-04, lr=7.25e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.26it/s, loss=3.196e-03, best=9.291e-04, lr=6.89e-01, worse_count=4]
                                                                                                                                       
(56/208) Skipping tensor: layers.15.adaLN_modulation.0.weight (Reason: In high-precision list)
(57/208) Processing tensor: layers.15.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.852e+00, best=1.852e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.842e+00, best=1.842e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.832e+00, best=1.832e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.820e+00, best=1.820e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.806e+00, best=1.806e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.791e+00, best=1.791e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.773e+00, best=1.773e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.753e+00, best=1.753e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.729e+00, best=1.729e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.703e+00, best=1.703e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.673e+00, best=1.673e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.639e+00, best=1.639e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.600e+00, best=1.600e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.555e+00, best=1.555e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.505e+00, best=1.505e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.447e+00, best=1.447e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.381e+00, best=1.381e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.306e+00, best=1.306e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.220e+00, best=1.220e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.123e+00, best=1.123e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.011e+00, best=1.011e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.844e-01, best=8.844e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.397e-01, best=7.397e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.748e-01, best=5.748e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.869e-01, best=3.869e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.725e-01, best=1.725e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.176e-02, best=7.176e-02, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.067e-01, best=7.176e-02, lr=2.51e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.461e-02, best=4.461e-02, lr=2.87e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.419e-01, best=4.461e-02, lr=2.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.667e-02, best=1.667e-02, lr=2.95e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.781e-01, best=1.667e-02, lr=2.66e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.208e-02, best=1.208e-02, lr=3.03e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.912e-01, best=1.208e-02, lr=2.74e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.750e-02, best=1.208e-02, lr=2.47e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.296e-01, best=1.208e-02, lr=2.23e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.591e-03, best=6.591e-03, lr=2.54e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.476e-01, best=6.591e-03, lr=2.29e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.819e-02, best=6.591e-03, lr=2.07e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.888e-01, best=6.591e-03, lr=1.87e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.994e-03, best=1.994e-03, lr=2.13e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.110e-01, best=1.994e-03, lr=1.92e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.877e-02, best=1.994e-03, lr=1.73e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.547e-01, best=1.994e-03, lr=1.57e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.858e-03, best=1.858e-03, lr=1.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.766e-01, best=1.858e-03, lr=1.61e-01, worse_count=1]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 455.79it/s, loss=1.766e-01, best=1.858e-03, lr=1.61e-01, worse_count=1]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 455.79it/s, loss=1.555e-02, best=1.858e-03, lr=1.45e-01, worse_count=2]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 455.79it/s, loss=1.298e-01, best=1.858e-03, lr=1.31e-01, worse_count=3]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 455.79it/s, loss=1.370e-03, best=1.370e-03, lr=1.50e-01, worse_count=0]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 455.79it/s, loss=1.482e-01, best=1.370e-03, lr=1.35e-01, worse_count=1]
                                                                                                                                       
(58/208) Processing tensor: layers.15.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.832e+00, best=1.832e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.823e+00, best=1.823e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.811e+00, best=1.811e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.797e+00, best=1.797e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.780e+00, best=1.780e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.760e+00, best=1.760e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.736e+00, best=1.736e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.707e+00, best=1.707e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.672e+00, best=1.672e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.630e+00, best=1.630e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.580e+00, best=1.580e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.520e+00, best=1.520e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.448e+00, best=1.448e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.361e+00, best=1.361e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.257e+00, best=1.257e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.132e+00, best=1.132e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.827e-01, best=9.827e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.030e-01, best=8.030e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=8.030e-01, best=8.030e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=5.874e-01, best=5.874e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=3.287e-01, best=3.287e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=1.818e-02, best=1.818e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=3.544e-01, best=1.818e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=4.455e-04, best=4.455e-04, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=4.243e-01, best=4.455e-04, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=2.079e-02, best=4.455e-04, lr=3.83e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=3.625e-01, best=4.455e-04, lr=3.64e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=1.625e-03, best=4.455e-04, lr=3.46e-01, worse_count=4]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=3.443e-01, best=4.455e-04, lr=3.29e-01, worse_count=5]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=1.567e-02, best=4.455e-04, lr=3.12e-01, worse_count=6]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=2.965e-01, best=4.455e-04, lr=2.97e-01, worse_count=7]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=6.260e-05, best=6.260e-05, lr=3.56e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=3.559e-01, best=6.260e-05, lr=3.38e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=1.773e-02, best=6.260e-05, lr=3.21e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=3.035e-01, best=6.260e-05, lr=3.05e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=1.673e-03, best=6.260e-05, lr=2.90e-01, worse_count=4]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=2.882e-01, best=6.260e-05, lr=2.75e-01, worse_count=5]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.87it/s, loss=1.282e-02, best=6.260e-05, lr=2.62e-01, worse_count=6]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.48it/s, loss=1.282e-02, best=6.260e-05, lr=2.62e-01, worse_count=6]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.48it/s, loss=2.488e-01, best=6.260e-05, lr=2.49e-01, worse_count=7]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.48it/s, loss=2.596e-04, best=6.260e-05, lr=2.36e-01, worse_count=8]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.48it/s, loss=2.359e-01, best=6.260e-05, lr=2.24e-01, worse_count=9]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.48it/s, loss=1.155e-02, best=6.260e-05, lr=2.13e-01, worse_count=10]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.48it/s, loss=2.016e-01, best=6.260e-05, lr=2.02e-01, worse_count=11]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.48it/s, loss=8.916e-04, best=6.260e-05, lr=1.92e-01, worse_count=12]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.48it/s, loss=1.914e-01, best=6.260e-05, lr=1.83e-01, worse_count=13]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.48it/s, loss=8.725e-03, best=6.260e-05, lr=1.74e-01, worse_count=14]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.48it/s, loss=1.649e-01, best=6.260e-05, lr=1.65e-01, worse_count=15]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.48it/s, loss=4.646e-05, best=4.646e-05, lr=1.98e-01, worse_count=0] 
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.48it/s, loss=1.978e-01, best=4.646e-05, lr=1.88e-01, worse_count=1]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.48it/s, loss=9.848e-03, best=4.646e-05, lr=1.79e-01, worse_count=2]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.48it/s, loss=1.687e-01, best=4.646e-05, lr=1.70e-01, worse_count=3]
                                                                                                                                       
(59/208) Processing tensor: layers.15.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.904e+00, best=1.904e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.894e+00, best=1.894e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.882e+00, best=1.882e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.868e+00, best=1.868e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.851e+00, best=1.851e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.831e+00, best=1.831e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.807e+00, best=1.807e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.778e+00, best=1.778e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.743e+00, best=1.743e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.701e+00, best=1.701e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.651e+00, best=1.651e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.591e+00, best=1.591e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.519e+00, best=1.519e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.432e+00, best=1.432e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.328e+00, best=1.328e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.204e+00, best=1.204e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.054e+00, best=1.054e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.742e-01, best=8.742e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.585e-01, best=6.585e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.998e-01, best=3.998e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=3.998e-01, best=3.998e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=8.932e-02, best=8.932e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=2.833e-01, best=8.932e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=7.070e-02, best=7.070e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=3.540e-01, best=7.070e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=4.946e-02, best=4.946e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=4.347e-01, best=4.946e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=2.525e-02, best=2.525e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=5.267e-01, best=2.525e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=2.351e-03, best=2.351e-03, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=6.269e-01, best=2.351e-03, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=2.911e-02, best=2.351e-03, lr=5.68e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=5.388e-01, best=2.351e-03, lr=5.39e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=7.170e-04, best=7.170e-04, lr=6.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=6.467e-01, best=7.170e-04, lr=6.15e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=3.165e-02, best=7.170e-04, lr=5.84e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=5.526e-01, best=7.170e-04, lr=5.55e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=2.439e-03, best=7.170e-04, lr=5.27e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=5.249e-01, best=7.170e-04, lr=5.01e-01, worse_count=5]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=2.393e-02, best=7.170e-04, lr=4.76e-01, worse_count=6]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.92it/s, loss=4.520e-01, best=7.170e-04, lr=4.52e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.11it/s, loss=4.520e-01, best=7.170e-04, lr=4.52e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.11it/s, loss=1.326e-04, best=1.326e-04, lr=5.43e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.11it/s, loss=5.424e-01, best=1.326e-04, lr=5.15e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.11it/s, loss=2.699e-02, best=1.326e-04, lr=4.90e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.11it/s, loss=4.627e-01, best=1.326e-04, lr=4.65e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.11it/s, loss=2.512e-03, best=1.326e-04, lr=4.42e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.11it/s, loss=4.394e-01, best=1.326e-04, lr=4.20e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.11it/s, loss=1.958e-02, best=1.326e-04, lr=3.99e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.11it/s, loss=3.792e-01, best=1.326e-04, lr=3.79e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.11it/s, loss=3.584e-04, best=1.326e-04, lr=3.60e-01, worse_count=8]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.11it/s, loss=3.596e-01, best=1.326e-04, lr=3.42e-01, worse_count=9]
                                                                                                                                       
(60/208) Processing tensor: layers.15.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.982e+00, best=1.982e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.972e+00, best=1.972e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.961e+00, best=1.961e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.947e+00, best=1.947e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.930e+00, best=1.930e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.910e+00, best=1.910e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.886e+00, best=1.886e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.857e+00, best=1.857e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.822e+00, best=1.822e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.780e+00, best=1.780e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.730e+00, best=1.730e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.670e+00, best=1.670e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.597e+00, best=1.597e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.511e+00, best=1.511e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.407e+00, best=1.407e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.282e+00, best=1.282e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.132e+00, best=1.132e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.526e-01, best=9.526e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.369e-01, best=7.369e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=7.369e-01, best=7.369e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=4.782e-01, best=4.782e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=1.677e-01, best=1.677e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=2.049e-01, best=1.677e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=1.491e-01, best=1.491e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=2.756e-01, best=1.491e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=1.279e-01, best=1.279e-01, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=3.563e-01, best=1.279e-01, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=1.037e-01, best=1.037e-01, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=4.483e-01, best=1.037e-01, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=7.605e-02, best=7.605e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=5.532e-01, best=7.605e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=4.459e-02, best=4.459e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=6.728e-01, best=4.459e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=8.719e-03, best=8.719e-03, lr=8.18e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=8.091e-01, best=8.719e-03, lr=7.77e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=3.217e-02, best=8.719e-03, lr=7.38e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=7.059e-01, best=8.719e-03, lr=7.01e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=4.732e-03, best=4.732e-03, lr=8.41e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.22it/s, loss=8.367e-01, best=4.732e-03, lr=7.99e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.76it/s, loss=8.367e-01, best=4.732e-03, lr=7.99e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.76it/s, loss=3.734e-02, best=4.732e-03, lr=7.59e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.76it/s, loss=7.220e-01, best=4.732e-03, lr=7.21e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.76it/s, loss=6.313e-04, best=6.313e-04, lr=8.66e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.76it/s, loss=8.650e-01, best=6.313e-04, lr=8.22e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.76it/s, loss=4.265e-02, best=6.313e-04, lr=7.81e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.76it/s, loss=7.386e-01, best=6.313e-04, lr=7.42e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.76it/s, loss=3.589e-03, best=6.313e-04, lr=7.05e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.76it/s, loss=7.015e-01, best=6.313e-04, lr=6.70e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.76it/s, loss=3.167e-02, best=6.313e-04, lr=6.36e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.76it/s, loss=6.047e-01, best=6.313e-04, lr=6.04e-01, worse_count=7]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.76it/s, loss=1.543e-04, best=1.543e-04, lr=7.25e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.76it/s, loss=7.253e-01, best=1.543e-04, lr=6.89e-01, worse_count=1]
                                                                                                                                       
(61/208) Processing tensor: layers.15.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.963e+00, best=1.963e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.953e+00, best=1.953e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.941e+00, best=1.941e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.927e+00, best=1.927e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.910e+00, best=1.910e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.890e+00, best=1.890e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.866e+00, best=1.866e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.837e+00, best=1.837e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.802e+00, best=1.802e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.761e+00, best=1.761e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.710e+00, best=1.710e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.650e+00, best=1.650e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.578e+00, best=1.578e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.491e+00, best=1.491e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.387e+00, best=1.387e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.263e+00, best=1.263e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.113e+00, best=1.113e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.332e-01, best=9.332e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.176e-01, best=7.176e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.588e-01, best=4.588e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=4.588e-01, best=4.588e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=1.483e-01, best=1.483e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=2.242e-01, best=1.483e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=1.297e-01, best=1.297e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=2.950e-01, best=1.297e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=1.085e-01, best=1.085e-01, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=3.757e-01, best=1.085e-01, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=8.426e-02, best=8.426e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=4.677e-01, best=8.426e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=5.666e-02, best=5.666e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=5.726e-01, best=5.666e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=2.520e-02, best=2.520e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=6.922e-01, best=2.520e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=1.067e-02, best=1.067e-02, lr=8.18e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=8.071e-01, best=1.067e-02, lr=7.77e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=3.022e-02, best=1.067e-02, lr=7.38e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=7.078e-01, best=1.067e-02, lr=7.01e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=6.685e-03, best=6.685e-03, lr=8.41e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=8.347e-01, best=6.685e-03, lr=7.99e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=3.538e-02, best=6.685e-03, lr=7.59e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.77it/s, loss=7.240e-01, best=6.685e-03, lr=7.21e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 191.97it/s, loss=7.240e-01, best=6.685e-03, lr=7.21e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 191.97it/s, loss=2.583e-03, best=2.583e-03, lr=8.66e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 191.97it/s, loss=8.631e-01, best=2.583e-03, lr=8.22e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 191.97it/s, loss=4.070e-02, best=2.583e-03, lr=7.81e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 191.97it/s, loss=7.406e-01, best=2.583e-03, lr=7.42e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 191.97it/s, loss=1.637e-03, best=1.637e-03, lr=8.91e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 191.97it/s, loss=8.890e-01, best=1.637e-03, lr=8.46e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 191.97it/s, loss=4.290e-02, best=1.637e-03, lr=8.04e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 191.97it/s, loss=7.609e-01, best=1.637e-03, lr=7.64e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 191.97it/s, loss=2.705e-03, best=1.637e-03, lr=7.25e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 191.97it/s, loss=7.227e-01, best=1.637e-03, lr=6.89e-01, worse_count=5]
                                                                                                                                       
(62/208) Skipping tensor: layers.16.adaLN_modulation.0.weight (Reason: In high-precision list)
(63/208) Processing tensor: layers.16.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.980e+00, best=1.980e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.971e+00, best=1.971e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.960e+00, best=1.960e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.948e+00, best=1.948e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.934e+00, best=1.934e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.919e+00, best=1.919e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.901e+00, best=1.901e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.881e+00, best=1.881e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.858e+00, best=1.858e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.831e+00, best=1.831e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.801e+00, best=1.801e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.767e+00, best=1.767e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.728e+00, best=1.728e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.683e+00, best=1.683e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.633e+00, best=1.633e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.575e+00, best=1.575e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.509e+00, best=1.509e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.434e+00, best=1.434e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.348e+00, best=1.348e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.251e+00, best=1.251e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.139e+00, best=1.139e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.012e+00, best=1.012e+00, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.678e-01, best=8.678e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.029e-01, best=7.029e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.149e-01, best=5.149e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.006e-01, best=3.006e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.633e-02, best=5.633e-02, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.222e-01, best=5.633e-02, lr=2.51e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.917e-02, best=2.917e-02, lr=2.87e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.574e-01, best=2.917e-02, lr=2.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.235e-03, best=1.235e-03, lr=2.95e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.936e-01, best=1.235e-03, lr=2.66e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.751e-02, best=1.235e-03, lr=2.40e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.126e-01, best=1.235e-03, lr=2.17e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.097e-03, best=1.235e-03, lr=1.96e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.915e-01, best=1.235e-03, lr=1.77e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.497e-02, best=1.235e-03, lr=1.59e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.443e-01, best=1.235e-03, lr=1.44e-01, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.596e-04, best=5.596e-04, lr=1.64e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.633e-01, best=5.596e-04, lr=1.48e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.542e-02, best=5.596e-04, lr=1.33e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.181e-01, best=5.596e-04, lr=1.20e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.405e-03, best=5.596e-04, lr=1.09e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.063e-01, best=5.596e-04, lr=9.81e-02, worse_count=5]
    Optimizing (Original):  88%|████████▊ | 44/50 [00:00<00:00, 436.16it/s, loss=1.063e-01, best=5.596e-04, lr=9.81e-02, worse_count=5]
    Optimizing (Original):  88%|████████▊ | 44/50 [00:00<00:00, 436.16it/s, loss=8.197e-03, best=5.596e-04, lr=8.86e-02, worse_count=6]
    Optimizing (Original):  88%|████████▊ | 44/50 [00:00<00:00, 436.16it/s, loss=8.037e-02, best=5.596e-04, lr=7.99e-02, worse_count=7]
    Optimizing (Original):  88%|████████▊ | 44/50 [00:00<00:00, 436.16it/s, loss=4.381e-04, best=4.381e-04, lr=9.11e-02, worse_count=0]
    Optimizing (Original):  88%|████████▊ | 44/50 [00:00<00:00, 436.16it/s, loss=9.068e-02, best=4.381e-04, lr=8.22e-02, worse_count=1]
    Optimizing (Original):  88%|████████▊ | 44/50 [00:00<00:00, 436.16it/s, loss=8.446e-03, best=4.381e-04, lr=7.42e-02, worse_count=2]
    Optimizing (Original):  88%|████████▊ | 44/50 [00:00<00:00, 436.16it/s, loss=6.577e-02, best=4.381e-04, lr=6.70e-02, worse_count=3]
                                                                                                                                       
(64/208) Processing tensor: layers.16.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.003e+00, best=2.003e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.994e+00, best=1.994e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.982e+00, best=1.982e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.968e+00, best=1.968e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.951e+00, best=1.951e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.931e+00, best=1.931e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.907e+00, best=1.907e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.878e+00, best=1.878e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.843e+00, best=1.843e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.801e+00, best=1.801e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.751e+00, best=1.751e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.691e+00, best=1.691e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.619e+00, best=1.619e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.532e+00, best=1.532e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.428e+00, best=1.428e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.303e+00, best=1.303e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.153e+00, best=1.153e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.738e-01, best=9.738e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=9.738e-01, best=9.738e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=7.581e-01, best=7.581e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=4.994e-01, best=4.994e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=1.889e-01, best=1.889e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=1.836e-01, best=1.836e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=2.634e-01, best=1.836e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=1.613e-01, best=1.613e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=3.484e-01, best=1.613e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=1.358e-01, best=1.358e-01, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=4.452e-01, best=1.358e-01, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=1.068e-01, best=1.068e-01, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=5.556e-01, best=1.068e-01, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=7.364e-02, best=7.364e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=6.815e-01, best=7.364e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=3.588e-02, best=3.588e-02, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=8.250e-01, best=3.588e-02, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=7.160e-03, best=7.160e-03, lr=9.81e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=9.742e-01, best=7.160e-03, lr=9.32e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.46it/s, loss=4.191e-02, best=7.160e-03, lr=8.86e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.17it/s, loss=4.191e-02, best=7.160e-03, lr=8.86e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.17it/s, loss=8.438e-01, best=7.160e-03, lr=8.41e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.17it/s, loss=2.377e-03, best=2.377e-03, lr=1.01e+00, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.17it/s, loss=1.007e+00, best=2.377e-03, lr=9.59e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.17it/s, loss=4.811e-02, best=2.377e-03, lr=9.11e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.17it/s, loss=8.631e-01, best=2.377e-03, lr=8.66e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.17it/s, loss=2.546e-03, best=2.377e-03, lr=8.22e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.17it/s, loss=8.198e-01, best=2.377e-03, lr=7.81e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.17it/s, loss=3.857e-02, best=2.377e-03, lr=7.42e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.17it/s, loss=7.036e-01, best=2.377e-03, lr=7.05e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.17it/s, loss=1.464e-03, best=1.464e-03, lr=8.46e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.17it/s, loss=8.446e-01, best=1.464e-03, lr=8.04e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.17it/s, loss=4.084e-02, best=1.464e-03, lr=7.64e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.17it/s, loss=7.228e-01, best=1.464e-03, lr=7.25e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.17it/s, loss=2.661e-03, best=1.464e-03, lr=6.89e-01, worse_count=4]
                                                                                                                                       
(65/208) Processing tensor: layers.16.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.048e+00, best=2.048e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.038e+00, best=2.038e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.027e+00, best=2.027e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.013e+00, best=2.013e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.996e+00, best=1.996e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.976e+00, best=1.976e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.951e+00, best=1.951e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.922e+00, best=1.922e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.888e+00, best=1.888e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.846e+00, best=1.846e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.796e+00, best=1.796e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.736e+00, best=1.736e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.663e+00, best=1.663e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.577e+00, best=1.577e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.473e+00, best=1.473e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.348e+00, best=1.348e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.198e+00, best=1.198e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.018e+00, best=1.018e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.029e-01, best=8.029e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.441e-01, best=5.441e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=5.441e-01, best=5.441e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=2.337e-01, best=2.337e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=1.389e-01, best=1.389e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=3.082e-01, best=1.389e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=1.166e-01, best=1.166e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=3.931e-01, best=1.166e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=9.107e-02, best=9.107e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=4.900e-01, best=9.107e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=6.202e-02, best=6.202e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=6.004e-01, best=6.202e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=2.890e-02, best=2.890e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=7.262e-01, best=2.890e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=8.856e-03, best=8.856e-03, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=8.520e-01, best=8.856e-03, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=3.419e-02, best=8.856e-03, lr=7.77e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=7.427e-01, best=8.856e-03, lr=7.38e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=4.660e-03, best=4.660e-03, lr=8.86e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=8.810e-01, best=4.660e-03, lr=8.41e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=3.962e-02, best=4.660e-03, lr=7.99e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=7.597e-01, best=4.660e-03, lr=7.59e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.66it/s, loss=3.439e-04, best=3.439e-04, lr=9.11e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.92it/s, loss=3.439e-04, best=3.439e-04, lr=9.11e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.92it/s, loss=9.109e-01, best=3.439e-04, lr=8.66e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.92it/s, loss=4.522e-02, best=3.439e-04, lr=8.22e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.92it/s, loss=7.772e-01, best=3.439e-04, lr=7.81e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.92it/s, loss=4.098e-03, best=3.439e-04, lr=7.42e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.92it/s, loss=7.381e-01, best=3.439e-04, lr=7.05e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.92it/s, loss=3.301e-02, best=3.439e-04, lr=6.70e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.92it/s, loss=6.368e-01, best=3.439e-04, lr=6.36e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.92it/s, loss=4.812e-04, best=3.439e-04, lr=6.04e-01, worse_count=8]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.92it/s, loss=6.040e-01, best=3.439e-04, lr=5.74e-01, worse_count=9]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.92it/s, loss=2.974e-02, best=3.439e-04, lr=5.46e-01, worse_count=10]
                                                                                                                                        
(66/208) Processing tensor: layers.16.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.003e+00, best=2.003e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.994e+00, best=1.994e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.982e+00, best=1.982e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.968e+00, best=1.968e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.951e+00, best=1.951e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.931e+00, best=1.931e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.907e+00, best=1.907e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.878e+00, best=1.878e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.843e+00, best=1.843e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.801e+00, best=1.801e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.751e+00, best=1.751e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.691e+00, best=1.691e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.619e+00, best=1.619e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.532e+00, best=1.532e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.428e+00, best=1.428e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.303e+00, best=1.303e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.154e+00, best=1.154e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.740e-01, best=9.740e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=9.740e-01, best=9.740e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=7.584e-01, best=7.584e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=4.996e-01, best=4.996e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=1.892e-01, best=1.892e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=1.834e-01, best=1.834e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=2.637e-01, best=1.834e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=1.611e-01, best=1.611e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=3.486e-01, best=1.611e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=1.356e-01, best=1.356e-01, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=4.455e-01, best=1.356e-01, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=1.065e-01, best=1.065e-01, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=5.559e-01, best=1.065e-01, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=7.341e-02, best=7.341e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=6.817e-01, best=7.341e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=3.565e-02, best=3.565e-02, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=8.252e-01, best=3.565e-02, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=7.390e-03, best=7.390e-03, lr=9.81e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=9.740e-01, best=7.390e-03, lr=9.32e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.60it/s, loss=4.168e-02, best=7.390e-03, lr=8.86e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 178.51it/s, loss=4.168e-02, best=7.390e-03, lr=8.86e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 178.51it/s, loss=8.440e-01, best=7.390e-03, lr=8.41e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 178.51it/s, loss=2.606e-03, best=2.606e-03, lr=1.01e+00, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 178.51it/s, loss=1.007e+00, best=2.606e-03, lr=9.59e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 178.51it/s, loss=4.788e-02, best=2.606e-03, lr=9.11e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 178.51it/s, loss=8.633e-01, best=2.606e-03, lr=8.66e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 178.51it/s, loss=2.316e-03, best=2.316e-03, lr=1.04e+00, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 178.51it/s, loss=1.036e+00, best=2.316e-03, lr=9.87e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 178.51it/s, loss=4.962e-02, best=2.316e-03, lr=9.37e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 178.51it/s, loss=8.879e-01, best=2.316e-03, lr=8.91e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 178.51it/s, loss=2.748e-03, best=2.316e-03, lr=8.46e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 178.51it/s, loss=8.434e-01, best=2.316e-03, lr=8.04e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 178.51it/s, loss=3.956e-02, best=2.316e-03, lr=7.64e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 178.51it/s, loss=7.241e-01, best=2.316e-03, lr=7.25e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 178.51it/s, loss=1.377e-03, best=1.377e-03, lr=8.70e-01, worse_count=0]
                                                                                                                                       
(67/208) Processing tensor: layers.16.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.003e+00, best=2.003e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.994e+00, best=1.994e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.982e+00, best=1.982e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.968e+00, best=1.968e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.951e+00, best=1.951e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.931e+00, best=1.931e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.907e+00, best=1.907e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.878e+00, best=1.878e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.843e+00, best=1.843e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.801e+00, best=1.801e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.751e+00, best=1.751e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.691e+00, best=1.691e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.619e+00, best=1.619e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.532e+00, best=1.532e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.428e+00, best=1.428e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.303e+00, best=1.303e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.154e+00, best=1.154e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.738e-01, best=9.738e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.582e-01, best=7.582e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.995e-01, best=4.995e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=4.995e-01, best=4.995e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=1.890e-01, best=1.890e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=1.836e-01, best=1.836e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=2.635e-01, best=1.836e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=1.612e-01, best=1.612e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=3.485e-01, best=1.612e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=1.357e-01, best=1.357e-01, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=4.453e-01, best=1.357e-01, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=1.067e-01, best=1.067e-01, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=5.557e-01, best=1.067e-01, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=7.357e-02, best=7.357e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=6.816e-01, best=7.357e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=3.582e-02, best=3.582e-02, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=8.250e-01, best=3.582e-02, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=7.227e-03, best=7.227e-03, lr=9.81e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=9.741e-01, best=7.227e-03, lr=9.32e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=4.184e-02, best=7.227e-03, lr=8.86e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=8.438e-01, best=7.227e-03, lr=8.41e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=2.443e-03, best=2.443e-03, lr=1.01e+00, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=1.007e+00, best=2.443e-03, lr=9.59e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.19it/s, loss=4.804e-02, best=2.443e-03, lr=9.11e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=4.804e-02, best=2.443e-03, lr=9.11e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=8.632e-01, best=2.443e-03, lr=8.66e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=2.480e-03, best=2.443e-03, lr=8.22e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=8.199e-01, best=2.443e-03, lr=7.81e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=3.864e-02, best=2.443e-03, lr=7.42e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=7.036e-01, best=2.443e-03, lr=7.05e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=1.530e-03, best=1.530e-03, lr=8.46e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=8.446e-01, best=1.530e-03, lr=8.04e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=4.078e-02, best=1.530e-03, lr=7.64e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=7.228e-01, best=1.530e-03, lr=7.25e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=2.595e-03, best=1.530e-03, lr=6.89e-01, worse_count=4]
                                                                                                                                       
(68/208) Skipping tensor: layers.17.adaLN_modulation.0.weight (Reason: In high-precision list)
(69/208) Processing tensor: layers.17.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.033e+00, best=2.033e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.024e+00, best=2.024e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.013e+00, best=2.013e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.001e+00, best=2.001e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.988e+00, best=1.988e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.972e+00, best=1.972e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.954e+00, best=1.954e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.934e+00, best=1.934e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.911e+00, best=1.911e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.885e+00, best=1.885e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.855e+00, best=1.855e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.820e+00, best=1.820e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.781e+00, best=1.781e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.737e+00, best=1.737e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.686e+00, best=1.686e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.628e+00, best=1.628e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.562e+00, best=1.562e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.487e+00, best=1.487e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.402e+00, best=1.402e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.304e+00, best=1.304e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.193e+00, best=1.193e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.066e+00, best=1.066e+00, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.212e-01, best=9.212e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.563e-01, best=7.563e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.683e-01, best=5.683e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.540e-01, best=3.540e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.097e-01, best=1.097e-01, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.688e-01, best=1.097e-01, lr=2.51e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.254e-02, best=8.254e-02, lr=2.87e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.040e-01, best=8.254e-02, lr=2.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.461e-02, best=5.461e-02, lr=2.95e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.402e-01, best=5.461e-02, lr=2.66e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.586e-02, best=2.586e-02, lr=3.03e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.775e-01, best=2.586e-02, lr=2.74e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.711e-03, best=3.711e-03, lr=3.12e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.084e-01, best=3.711e-03, lr=2.82e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.672e-02, best=3.711e-03, lr=2.54e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.275e-01, best=3.711e-03, lr=2.29e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.933e-03, best=1.933e-03, lr=2.61e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.596e-01, best=1.933e-03, lr=2.36e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.356e-02, best=1.933e-03, lr=2.13e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.894e-01, best=1.933e-03, lr=1.92e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.796e-03, best=1.933e-03, lr=1.73e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.707e-01, best=1.933e-03, lr=1.57e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.412e-02, best=1.933e-03, lr=1.41e-01, worse_count=6]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 448.37it/s, loss=1.412e-02, best=1.933e-03, lr=1.41e-01, worse_count=6]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 448.37it/s, loss=1.272e-01, best=1.933e-03, lr=1.28e-01, worse_count=7]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 448.37it/s, loss=3.413e-04, best=3.413e-04, lr=1.45e-01, worse_count=0]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 448.37it/s, loss=1.450e-01, best=3.413e-04, lr=1.31e-01, worse_count=1]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 448.37it/s, loss=1.383e-02, best=3.413e-04, lr=1.18e-01, worse_count=2]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 448.37it/s, loss=1.046e-01, best=3.413e-04, lr=1.07e-01, worse_count=3]
                                                                                                                                       
(70/208) Processing tensor: layers.17.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.827e+00, best=1.827e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.817e+00, best=1.817e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.805e+00, best=1.805e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.791e+00, best=1.791e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.774e+00, best=1.774e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.754e+00, best=1.754e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.730e+00, best=1.730e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.701e+00, best=1.701e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.666e+00, best=1.666e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.624e+00, best=1.624e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.574e+00, best=1.574e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.514e+00, best=1.514e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.442e+00, best=1.442e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.355e+00, best=1.355e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.251e+00, best=1.251e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.126e+00, best=1.126e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.768e-01, best=9.768e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.971e-01, best=7.971e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=7.971e-01, best=7.971e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=5.815e-01, best=5.815e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=3.227e-01, best=3.227e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=1.226e-02, best=1.226e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=3.603e-01, best=1.226e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=6.371e-03, best=6.371e-03, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=4.184e-01, best=6.371e-03, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=1.487e-02, best=6.371e-03, lr=3.83e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=3.685e-01, best=6.371e-03, lr=3.64e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=4.301e-03, best=4.301e-03, lr=4.37e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=4.327e-01, best=4.301e-03, lr=4.15e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=1.755e-02, best=4.301e-03, lr=3.94e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=3.768e-01, best=4.301e-03, lr=3.75e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=2.171e-03, best=2.171e-03, lr=4.50e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=4.474e-01, best=2.171e-03, lr=4.27e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=2.031e-02, best=2.171e-03, lr=4.06e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=3.855e-01, best=2.171e-03, lr=3.85e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=2.725e-05, best=2.725e-05, lr=4.63e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.47it/s, loss=4.626e-01, best=2.725e-05, lr=4.39e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=4.626e-01, best=2.725e-05, lr=4.39e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=2.310e-02, best=2.725e-05, lr=4.17e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=3.944e-01, best=2.725e-05, lr=3.97e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=2.228e-03, best=2.725e-05, lr=3.77e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=3.745e-01, best=2.725e-05, lr=3.58e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=1.661e-02, best=2.725e-05, lr=3.40e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=3.234e-01, best=2.725e-05, lr=3.23e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=3.916e-04, best=2.725e-05, lr=3.07e-01, worse_count=8]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=3.065e-01, best=2.725e-05, lr=2.92e-01, worse_count=9]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=1.495e-02, best=2.725e-05, lr=2.77e-01, worse_count=10]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=2.620e-01, best=2.725e-05, lr=2.63e-01, worse_count=11]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=1.105e-03, best=2.725e-05, lr=2.50e-01, worse_count=12]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=2.489e-01, best=2.725e-05, lr=2.37e-01, worse_count=13]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=1.139e-02, best=2.725e-05, lr=2.26e-01, worse_count=14]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=2.142e-01, best=2.725e-05, lr=2.14e-01, worse_count=15]
                                                                                                                                        
(71/208) Processing tensor: layers.17.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.072e+00, best=2.072e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.062e+00, best=2.062e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.050e+00, best=2.050e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.036e+00, best=2.036e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.019e+00, best=2.019e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.999e+00, best=1.999e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.975e+00, best=1.975e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.946e+00, best=1.946e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.911e+00, best=1.911e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.870e+00, best=1.870e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.819e+00, best=1.819e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.759e+00, best=1.759e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.687e+00, best=1.687e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.600e+00, best=1.600e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.496e+00, best=1.496e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.372e+00, best=1.372e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.222e+00, best=1.222e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.042e+00, best=1.042e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.266e-01, best=8.266e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.678e-01, best=5.678e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=5.678e-01, best=5.678e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=2.573e-01, best=2.573e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=1.152e-01, best=1.152e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=3.319e-01, best=1.152e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=9.288e-02, best=9.288e-02, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=4.168e-01, best=9.288e-02, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=6.740e-02, best=6.740e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=5.136e-01, best=6.740e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=3.834e-02, best=3.834e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=6.240e-01, best=3.834e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=5.225e-03, best=5.225e-03, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=7.499e-01, best=5.225e-03, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=3.253e-02, best=5.225e-03, lr=6.81e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=6.490e-01, best=5.225e-03, lr=6.47e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=1.544e-03, best=1.544e-03, lr=7.77e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=7.754e-01, best=1.544e-03, lr=7.38e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=3.730e-02, best=1.544e-03, lr=7.01e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=6.639e-01, best=1.544e-03, lr=6.66e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=2.243e-03, best=1.544e-03, lr=6.33e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=6.306e-01, best=1.544e-03, lr=6.01e-01, worse_count=5]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.02it/s, loss=2.940e-02, best=1.544e-03, lr=5.71e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.02it/s, loss=2.940e-02, best=1.544e-03, lr=5.71e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.02it/s, loss=5.417e-01, best=1.544e-03, lr=5.43e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.02it/s, loss=8.419e-04, best=8.419e-04, lr=6.51e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.02it/s, loss=6.502e-01, best=8.419e-04, lr=6.18e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.02it/s, loss=3.171e-02, best=8.419e-04, lr=5.88e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.02it/s, loss=5.559e-01, best=8.419e-04, lr=5.58e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.02it/s, loss=2.332e-03, best=8.419e-04, lr=5.30e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.02it/s, loss=5.280e-01, best=8.419e-04, lr=5.04e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.02it/s, loss=2.418e-02, best=8.419e-04, lr=4.79e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.02it/s, loss=4.544e-01, best=8.419e-04, lr=4.55e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.02it/s, loss=2.538e-04, best=2.538e-04, lr=5.46e-01, worse_count=0]
                                                                                                                                       
(72/208) Processing tensor: layers.17.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.116e+00, best=2.116e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.106e+00, best=2.106e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.094e+00, best=2.094e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.080e+00, best=2.080e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.063e+00, best=2.063e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.043e+00, best=2.043e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.019e+00, best=2.019e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.990e+00, best=1.990e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.955e+00, best=1.955e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.913e+00, best=1.913e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.863e+00, best=1.863e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.803e+00, best=1.803e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.731e+00, best=1.731e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.644e+00, best=1.644e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.540e+00, best=1.540e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.416e+00, best=1.416e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.266e+00, best=1.266e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.086e+00, best=1.086e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.705e-01, best=8.705e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=8.705e-01, best=8.705e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=6.118e-01, best=6.118e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=3.013e-01, best=3.013e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=7.124e-02, best=7.124e-02, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=3.758e-01, best=7.124e-02, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=4.889e-02, best=4.889e-02, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=4.608e-01, best=4.889e-02, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=2.340e-02, best=2.340e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=5.576e-01, best=2.340e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=5.649e-03, best=5.649e-03, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=6.567e-01, best=5.649e-03, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=2.747e-02, best=5.649e-03, lr=5.98e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=5.703e-01, best=5.649e-03, lr=5.68e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=2.420e-03, best=2.420e-03, lr=6.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=6.791e-01, best=2.420e-03, lr=6.47e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=3.165e-02, best=2.420e-03, lr=6.15e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=5.834e-01, best=2.420e-03, lr=5.84e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=9.029e-04, best=9.029e-04, lr=7.01e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=7.003e-01, best=9.029e-04, lr=6.66e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.19it/s, loss=3.416e-02, best=9.029e-04, lr=6.33e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.38it/s, loss=3.416e-02, best=9.029e-04, lr=6.33e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.38it/s, loss=5.986e-01, best=9.029e-04, lr=6.01e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.38it/s, loss=2.515e-03, best=9.029e-04, lr=5.71e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.38it/s, loss=5.686e-01, best=9.029e-04, lr=5.43e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.38it/s, loss=2.604e-02, best=9.029e-04, lr=5.15e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.38it/s, loss=4.894e-01, best=9.029e-04, lr=4.90e-01, worse_count=7]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.38it/s, loss=2.697e-04, best=2.697e-04, lr=5.88e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.38it/s, loss=5.873e-01, best=2.697e-04, lr=5.58e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.38it/s, loss=2.911e-02, best=2.697e-04, lr=5.30e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.38it/s, loss=5.012e-01, best=2.697e-04, lr=5.04e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.38it/s, loss=2.595e-03, best=2.697e-04, lr=4.79e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.38it/s, loss=4.760e-01, best=2.697e-04, lr=4.55e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.38it/s, loss=2.133e-02, best=2.697e-04, lr=4.32e-01, worse_count=6]
                                                                                                                                       
(73/208) Processing tensor: layers.17.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.830e+00, best=1.830e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.820e+00, best=1.820e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.808e+00, best=1.808e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.794e+00, best=1.794e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.777e+00, best=1.777e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.757e+00, best=1.757e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.733e+00, best=1.733e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.704e+00, best=1.704e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.669e+00, best=1.669e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.627e+00, best=1.627e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.577e+00, best=1.577e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.517e+00, best=1.517e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.445e+00, best=1.445e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.358e+00, best=1.358e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.254e+00, best=1.254e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.129e+00, best=1.129e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.797e-01, best=9.797e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.001e-01, best=8.001e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.844e-01, best=5.844e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=5.844e-01, best=5.844e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=3.257e-01, best=3.257e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=1.522e-02, best=1.522e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=3.574e-01, best=1.522e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=3.412e-03, best=3.412e-03, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=4.213e-01, best=3.412e-03, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=1.783e-02, best=3.412e-03, lr=3.83e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=3.655e-01, best=3.412e-03, lr=3.64e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=1.342e-03, best=1.342e-03, lr=4.37e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=4.357e-01, best=1.342e-03, lr=4.15e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=2.051e-02, best=1.342e-03, lr=3.94e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=3.739e-01, best=1.342e-03, lr=3.75e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=7.890e-04, best=7.890e-04, lr=4.50e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=4.488e-01, best=7.890e-04, lr=4.27e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=2.169e-02, best=7.890e-04, lr=4.06e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=3.841e-01, best=7.890e-04, lr=3.85e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=1.403e-03, best=7.890e-04, lr=3.66e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=3.648e-01, best=7.890e-04, lr=3.48e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=1.691e-02, best=7.890e-04, lr=3.30e-01, worse_count=6]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=3.136e-01, best=7.890e-04, lr=3.14e-01, worse_count=7]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.04it/s, loss=3.825e-04, best=3.825e-04, lr=3.77e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.06it/s, loss=3.825e-04, best=3.825e-04, lr=3.77e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.06it/s, loss=3.764e-01, best=3.825e-04, lr=3.58e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.06it/s, loss=1.846e-02, best=3.825e-04, lr=3.40e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.06it/s, loss=3.216e-01, best=3.825e-04, lr=3.23e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.06it/s, loss=1.454e-03, best=3.825e-04, lr=3.07e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.06it/s, loss=3.054e-01, best=3.825e-04, lr=2.92e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.06it/s, loss=1.389e-02, best=3.825e-04, lr=2.77e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.06it/s, loss=2.631e-01, best=3.825e-04, lr=2.63e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.06it/s, loss=4.295e-05, best=4.295e-05, lr=3.16e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.06it/s, loss=3.157e-01, best=4.295e-05, lr=3.00e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.06it/s, loss=1.574e-02, best=4.295e-05, lr=2.85e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.06it/s, loss=2.692e-01, best=4.295e-05, lr=2.71e-01, worse_count=3]
                                                                                                                                       
(74/208) Skipping tensor: layers.18.adaLN_modulation.0.weight (Reason: In high-precision list)
(75/208) Processing tensor: layers.18.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.064e+00, best=2.064e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.055e+00, best=2.055e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.044e+00, best=2.044e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.032e+00, best=2.032e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.019e+00, best=2.019e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.003e+00, best=2.003e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.985e+00, best=1.985e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.965e+00, best=1.965e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.942e+00, best=1.942e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.915e+00, best=1.915e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.885e+00, best=1.885e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.851e+00, best=1.851e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.812e+00, best=1.812e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.768e+00, best=1.768e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.717e+00, best=1.717e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.659e+00, best=1.659e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.593e+00, best=1.593e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.518e+00, best=1.518e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.433e+00, best=1.433e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.335e+00, best=1.335e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.224e+00, best=1.224e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.097e+00, best=1.097e+00, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.521e-01, best=9.521e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.872e-01, best=7.872e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.992e-01, best=5.992e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.849e-01, best=3.849e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.406e-01, best=1.406e-01, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.379e-01, best=1.379e-01, lr=3.17e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.796e-01, best=1.379e-01, lr=2.87e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.070e-01, best=1.070e-01, lr=3.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.197e-01, best=1.070e-01, lr=2.95e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.510e-02, best=7.510e-02, lr=3.36e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.610e-01, best=7.510e-02, lr=3.03e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.233e-02, best=4.233e-02, lr=3.46e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.034e-01, best=4.233e-02, lr=3.12e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.621e-03, best=8.621e-03, lr=3.56e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.471e-01, best=8.621e-03, lr=3.21e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.606e-02, best=8.621e-03, lr=2.90e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.637e-01, best=8.621e-03, lr=2.61e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.187e-03, best=2.187e-03, lr=2.98e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.959e-01, best=2.187e-03, lr=2.69e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.688e-02, best=2.187e-03, lr=2.43e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.159e-01, best=2.187e-03, lr=2.19e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.205e-03, best=2.187e-03, lr=1.98e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.946e-01, best=2.187e-03, lr=1.78e-01, worse_count=5]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 441.33it/s, loss=1.946e-01, best=2.187e-03, lr=1.78e-01, worse_count=5]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 441.33it/s, loss=1.608e-02, best=2.187e-03, lr=1.61e-01, worse_count=6]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 441.33it/s, loss=1.450e-01, best=2.187e-03, lr=1.45e-01, worse_count=7]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 441.33it/s, loss=3.723e-04, best=3.723e-04, lr=1.66e-01, worse_count=0]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 441.33it/s, loss=1.654e-01, best=3.723e-04, lr=1.50e-01, worse_count=1]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 441.33it/s, loss=1.579e-02, best=3.723e-04, lr=1.35e-01, worse_count=2]
                                                                                                                                       
(76/208) Processing tensor: layers.18.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.915e+00, best=1.915e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.905e+00, best=1.905e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.893e+00, best=1.893e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.879e+00, best=1.879e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.863e+00, best=1.863e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.842e+00, best=1.842e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.818e+00, best=1.818e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.789e+00, best=1.789e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.754e+00, best=1.754e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.713e+00, best=1.713e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.662e+00, best=1.662e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.602e+00, best=1.602e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.530e+00, best=1.530e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.443e+00, best=1.443e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.339e+00, best=1.339e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.215e+00, best=1.215e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.065e+00, best=1.065e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.853e-01, best=8.853e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=8.853e-01, best=8.853e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=6.697e-01, best=6.697e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=4.109e-01, best=4.109e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=1.005e-01, best=1.005e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=2.721e-01, best=1.005e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=8.182e-02, best=8.182e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=3.429e-01, best=8.182e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=6.058e-02, best=6.058e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=4.236e-01, best=6.058e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=3.637e-02, best=3.637e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=5.156e-01, best=3.637e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=8.775e-03, best=8.775e-03, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=6.205e-01, best=8.775e-03, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=2.269e-02, best=8.775e-03, lr=5.68e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=5.452e-01, best=8.775e-03, lr=5.39e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=5.707e-03, best=5.707e-03, lr=6.47e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=6.417e-01, best=5.707e-03, lr=6.15e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=2.666e-02, best=5.707e-03, lr=5.84e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.23it/s, loss=5.576e-01, best=5.707e-03, lr=5.55e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.29it/s, loss=5.576e-01, best=5.707e-03, lr=5.55e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.29it/s, loss=2.551e-03, best=2.551e-03, lr=6.66e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.29it/s, loss=6.635e-01, best=2.551e-03, lr=6.33e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.29it/s, loss=3.075e-02, best=2.551e-03, lr=6.01e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.29it/s, loss=5.704e-01, best=2.551e-03, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.29it/s, loss=6.966e-04, best=6.966e-04, lr=6.85e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.29it/s, loss=6.846e-01, best=6.966e-04, lr=6.51e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.29it/s, loss=3.357e-02, best=6.966e-04, lr=6.18e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.29it/s, loss=5.849e-01, best=6.966e-04, lr=5.88e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.29it/s, loss=2.644e-03, best=6.966e-04, lr=5.58e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.29it/s, loss=5.556e-01, best=6.966e-04, lr=5.30e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.29it/s, loss=2.527e-02, best=6.966e-04, lr=5.04e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.29it/s, loss=4.785e-01, best=6.966e-04, lr=4.79e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.29it/s, loss=7.935e-05, best=7.935e-05, lr=5.74e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.29it/s, loss=5.742e-01, best=7.935e-05, lr=5.46e-01, worse_count=1]
                                                                                                                                       
(77/208) Processing tensor: layers.18.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.970e+00, best=1.970e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.960e+00, best=1.960e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.949e+00, best=1.949e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.935e+00, best=1.935e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.918e+00, best=1.918e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.898e+00, best=1.898e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.873e+00, best=1.873e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.844e+00, best=1.844e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.810e+00, best=1.810e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.768e+00, best=1.768e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.718e+00, best=1.718e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.658e+00, best=1.658e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.585e+00, best=1.585e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.499e+00, best=1.499e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.395e+00, best=1.395e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.270e+00, best=1.270e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.120e+00, best=1.120e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.405e-01, best=9.405e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.249e-01, best=7.249e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.662e-01, best=4.662e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=4.662e-01, best=4.662e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=1.557e-01, best=1.557e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=2.169e-01, best=1.557e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=1.371e-01, best=1.371e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=2.877e-01, best=1.371e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=1.158e-01, best=1.158e-01, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=3.684e-01, best=1.158e-01, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=9.161e-02, best=9.161e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=4.604e-01, best=9.161e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=6.401e-02, best=6.401e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=5.653e-01, best=6.401e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=3.255e-02, best=3.255e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=6.848e-01, best=3.255e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=3.322e-03, best=3.322e-03, lr=8.18e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=8.145e-01, best=3.322e-03, lr=7.77e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=3.757e-02, best=3.322e-03, lr=7.38e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=7.005e-01, best=3.322e-03, lr=7.01e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=6.659e-04, best=6.659e-04, lr=8.41e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=8.407e-01, best=6.659e-04, lr=7.99e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=4.140e-02, best=6.659e-04, lr=7.59e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.45it/s, loss=7.180e-01, best=6.659e-04, lr=7.21e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.20it/s, loss=7.180e-01, best=6.659e-04, lr=7.21e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.20it/s, loss=3.436e-03, best=6.659e-04, lr=6.85e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.20it/s, loss=6.819e-01, best=6.659e-04, lr=6.51e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.20it/s, loss=3.083e-02, best=6.659e-04, lr=6.18e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.20it/s, loss=5.877e-01, best=6.659e-04, lr=5.88e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.20it/s, loss=9.793e-05, best=9.793e-05, lr=7.05e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.20it/s, loss=7.050e-01, best=9.793e-05, lr=6.70e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.20it/s, loss=3.516e-02, best=9.793e-05, lr=6.36e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.20it/s, loss=6.012e-01, best=9.793e-05, lr=6.04e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.20it/s, loss=3.340e-03, best=9.793e-05, lr=5.74e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.20it/s, loss=5.710e-01, best=9.793e-05, lr=5.46e-01, worse_count=5]
                                                                                                                                       
(78/208) Processing tensor: layers.18.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.285e+00, best=2.285e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.276e+00, best=2.276e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.264e+00, best=2.264e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.250e+00, best=2.250e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.233e+00, best=2.233e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.213e+00, best=2.213e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.189e+00, best=2.189e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.160e+00, best=2.160e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.125e+00, best=2.125e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.083e+00, best=2.083e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.033e+00, best=2.033e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.973e+00, best=1.973e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.901e+00, best=1.901e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.814e+00, best=1.814e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.710e+00, best=1.710e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.585e+00, best=1.585e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.436e+00, best=1.436e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.256e+00, best=1.256e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=1.256e+00, best=1.256e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=1.040e+00, best=1.040e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=7.816e-01, best=7.816e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=4.711e-01, best=4.711e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=9.857e-02, best=9.857e-02, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=3.485e-01, best=9.857e-02, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=7.622e-02, best=7.622e-02, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=4.335e-01, best=7.622e-02, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=5.073e-02, best=5.073e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=5.303e-01, best=5.073e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=2.168e-02, best=2.168e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=6.407e-01, best=2.168e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=1.144e-02, best=1.144e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=7.437e-01, best=1.144e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=2.632e-02, best=1.144e-02, lr=6.81e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=6.552e-01, best=1.144e-02, lr=6.47e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=7.758e-03, best=7.758e-03, lr=7.77e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=7.691e-01, best=7.758e-03, lr=7.38e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=3.109e-02, best=7.758e-03, lr=7.01e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.74it/s, loss=6.701e-01, best=7.758e-03, lr=6.66e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 178.29it/s, loss=6.701e-01, best=7.758e-03, lr=6.66e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 178.29it/s, loss=3.970e-03, best=3.970e-03, lr=7.99e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 178.29it/s, loss=7.953e-01, best=3.970e-03, lr=7.59e-01, worse_count=1]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 178.29it/s, loss=3.600e-02, best=3.970e-03, lr=7.21e-01, worse_count=2]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 178.29it/s, loss=6.854e-01, best=3.970e-03, lr=6.85e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 178.29it/s, loss=8.042e-05, best=8.042e-05, lr=8.22e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 178.29it/s, loss=8.223e-01, best=8.042e-05, lr=7.81e-01, worse_count=1]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 178.29it/s, loss=4.104e-02, best=8.042e-05, lr=7.42e-01, worse_count=2]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 178.29it/s, loss=7.011e-01, best=8.042e-05, lr=7.05e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 178.29it/s, loss=3.929e-03, best=8.042e-05, lr=6.70e-01, worse_count=4]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 178.29it/s, loss=6.659e-01, best=8.042e-05, lr=6.36e-01, worse_count=5]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 178.29it/s, loss=2.956e-02, best=8.042e-05, lr=6.04e-01, worse_count=6]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 178.29it/s, loss=5.749e-01, best=8.042e-05, lr=5.74e-01, worse_count=7]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 178.29it/s, loss=6.642e-04, best=8.042e-05, lr=5.46e-01, worse_count=8]
                                                                                                                                       
(79/208) Processing tensor: layers.18.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.142e+00, best=2.142e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.133e+00, best=2.133e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.121e+00, best=2.121e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.107e+00, best=2.107e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.090e+00, best=2.090e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.070e+00, best=2.070e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.046e+00, best=2.046e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.017e+00, best=2.017e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.982e+00, best=1.982e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.940e+00, best=1.940e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.890e+00, best=1.890e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.830e+00, best=1.830e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.758e+00, best=1.758e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.671e+00, best=1.671e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.567e+00, best=1.567e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.442e+00, best=1.442e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.292e+00, best=1.292e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.113e+00, best=1.113e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.971e-01, best=8.971e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=8.971e-01, best=8.971e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=6.384e-01, best=6.384e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=3.279e-01, best=3.279e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=4.465e-02, best=4.465e-02, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=4.024e-01, best=4.465e-02, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=2.230e-02, best=2.230e-02, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=4.874e-01, best=2.230e-02, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=3.185e-03, best=3.185e-03, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=5.779e-01, best=3.185e-03, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=2.587e-02, best=3.185e-03, lr=5.24e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=4.985e-01, best=3.185e-03, lr=4.98e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=3.530e-04, best=3.530e-04, lr=5.98e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=5.975e-01, best=3.530e-04, lr=5.68e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=2.954e-02, best=3.530e-04, lr=5.39e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=5.100e-01, best=3.530e-04, lr=5.13e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=2.561e-03, best=3.530e-04, lr=4.87e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=4.844e-01, best=3.530e-04, lr=4.63e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=2.178e-02, best=3.530e-04, lr=4.39e-01, worse_count=6]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=4.177e-01, best=3.530e-04, lr=4.17e-01, worse_count=7]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=1.886e-04, best=1.886e-04, lr=5.01e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.47it/s, loss=5.008e-01, best=1.886e-04, lr=4.76e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.84it/s, loss=5.008e-01, best=1.886e-04, lr=4.76e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.84it/s, loss=2.486e-02, best=1.886e-04, lr=4.52e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.84it/s, loss=4.273e-01, best=1.886e-04, lr=4.29e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.84it/s, loss=2.254e-03, best=1.886e-04, lr=4.08e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.84it/s, loss=4.058e-01, best=1.886e-04, lr=3.88e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.84it/s, loss=1.815e-02, best=1.886e-04, lr=3.68e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.84it/s, loss=3.501e-01, best=1.886e-04, lr=3.50e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.84it/s, loss=2.651e-04, best=1.886e-04, lr=3.32e-01, worse_count=8]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.84it/s, loss=3.321e-01, best=1.886e-04, lr=3.16e-01, worse_count=9]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.84it/s, loss=1.635e-02, best=1.886e-04, lr=3.00e-01, worse_count=10]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.84it/s, loss=2.836e-01, best=1.886e-04, lr=2.85e-01, worse_count=11]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.84it/s, loss=1.355e-03, best=1.886e-04, lr=2.71e-01, worse_count=12]
                                                                                                                                        
(80/208) Skipping tensor: layers.19.adaLN_modulation.0.weight (Reason: In high-precision list)
(81/208) Processing tensor: layers.19.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.128e+00, best=2.128e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.119e+00, best=2.119e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.108e+00, best=2.108e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.096e+00, best=2.096e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.083e+00, best=2.083e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.067e+00, best=2.067e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.049e+00, best=2.049e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.029e+00, best=2.029e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.006e+00, best=2.006e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.980e+00, best=1.980e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.950e+00, best=1.950e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.915e+00, best=1.915e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.876e+00, best=1.876e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.832e+00, best=1.832e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.781e+00, best=1.781e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.723e+00, best=1.723e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.658e+00, best=1.658e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.582e+00, best=1.582e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.497e+00, best=1.497e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.399e+00, best=1.399e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.288e+00, best=1.288e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.161e+00, best=1.161e+00, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.016e+00, best=1.016e+00, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.514e-01, best=8.514e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.634e-01, best=6.634e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.491e-01, best=4.491e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.048e-01, best=2.048e-01, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.371e-02, best=7.371e-02, lr=3.17e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.438e-01, best=7.371e-02, lr=2.87e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.275e-02, best=4.275e-02, lr=3.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.839e-01, best=4.275e-02, lr=2.95e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.090e-02, best=1.090e-02, lr=3.36e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.252e-01, best=1.090e-02, lr=3.03e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.187e-02, best=1.090e-02, lr=2.74e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.519e-01, best=1.090e-02, lr=2.47e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.825e-03, best=4.825e-03, lr=2.82e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.768e-01, best=4.825e-03, lr=2.54e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.264e-02, best=4.825e-03, lr=2.29e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.068e-01, best=4.825e-03, lr=2.07e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.692e-04, best=2.692e-04, lr=2.36e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.357e-01, best=2.692e-04, lr=2.13e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.274e-02, best=2.692e-04, lr=1.92e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.695e-01, best=2.692e-04, lr=1.73e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.999e-03, best=2.692e-04, lr=1.57e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.526e-01, best=2.692e-04, lr=1.41e-01, worse_count=5]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 445.91it/s, loss=1.526e-01, best=2.692e-04, lr=1.41e-01, worse_count=5]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 445.91it/s, loss=1.127e-02, best=2.692e-04, lr=1.28e-01, worse_count=6]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 445.91it/s, loss=1.163e-01, best=2.692e-04, lr=1.15e-01, worse_count=7]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 445.91it/s, loss=1.168e-03, best=2.692e-04, lr=1.04e-01, worse_count=8]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 445.91it/s, loss=1.027e-01, best=2.692e-04, lr=9.37e-02, worse_count=9]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 445.91it/s, loss=8.960e-03, best=2.692e-04, lr=8.46e-02, worse_count=10]
                                                                                                                                        
(82/208) Processing tensor: layers.19.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.971e+00, best=1.971e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.961e+00, best=1.961e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.949e+00, best=1.949e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.935e+00, best=1.935e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.918e+00, best=1.918e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.898e+00, best=1.898e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.874e+00, best=1.874e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.845e+00, best=1.845e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.810e+00, best=1.810e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.768e+00, best=1.768e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.718e+00, best=1.718e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.658e+00, best=1.658e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.586e+00, best=1.586e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.499e+00, best=1.499e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.395e+00, best=1.395e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.271e+00, best=1.271e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.121e+00, best=1.121e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.411e-01, best=9.411e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=9.411e-01, best=9.411e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=7.255e-01, best=7.255e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=4.668e-01, best=4.668e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=1.563e-01, best=1.563e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=2.163e-01, best=1.563e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=1.377e-01, best=1.377e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=2.871e-01, best=1.377e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=1.164e-01, best=1.164e-01, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=3.678e-01, best=1.164e-01, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=9.223e-02, best=9.223e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=4.598e-01, best=9.223e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=6.463e-02, best=6.463e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=5.646e-01, best=6.463e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=3.317e-02, best=3.317e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=6.842e-01, best=3.317e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=2.700e-03, best=2.700e-03, lr=8.18e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=8.151e-01, best=2.700e-03, lr=7.77e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=3.819e-02, best=2.700e-03, lr=7.38e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.24it/s, loss=6.999e-01, best=2.700e-03, lr=7.01e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.17it/s, loss=6.999e-01, best=2.700e-03, lr=7.01e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.17it/s, loss=1.287e-03, best=1.287e-03, lr=8.41e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.17it/s, loss=8.401e-01, best=1.287e-03, lr=7.99e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.17it/s, loss=4.078e-02, best=1.287e-03, lr=7.59e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.17it/s, loss=7.186e-01, best=1.287e-03, lr=7.21e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.17it/s, loss=2.815e-03, best=1.287e-03, lr=6.85e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.17it/s, loss=6.825e-01, best=1.287e-03, lr=6.51e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.17it/s, loss=3.145e-02, best=1.287e-03, lr=6.18e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.17it/s, loss=5.870e-01, best=1.287e-03, lr=5.88e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.17it/s, loss=5.267e-04, best=5.267e-04, lr=7.05e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.17it/s, loss=7.046e-01, best=5.267e-04, lr=6.70e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.17it/s, loss=3.473e-02, best=5.267e-04, lr=6.36e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.17it/s, loss=6.016e-01, best=5.267e-04, lr=6.04e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.17it/s, loss=2.911e-03, best=5.267e-04, lr=5.74e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.17it/s, loss=5.714e-01, best=5.267e-04, lr=5.46e-01, worse_count=5]
                                                                                                                                       
(83/208) Processing tensor: layers.19.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.023e+00, best=2.023e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.013e+00, best=2.013e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.002e+00, best=2.002e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.988e+00, best=1.988e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.971e+00, best=1.971e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.951e+00, best=1.951e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.927e+00, best=1.927e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.897e+00, best=1.897e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.863e+00, best=1.863e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.821e+00, best=1.821e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.771e+00, best=1.771e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.711e+00, best=1.711e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.638e+00, best=1.638e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.552e+00, best=1.552e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.448e+00, best=1.448e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.323e+00, best=1.323e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.173e+00, best=1.173e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.935e-01, best=9.935e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.779e-01, best=7.779e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.192e-01, best=5.192e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=5.192e-01, best=5.192e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=2.087e-01, best=2.087e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=1.639e-01, best=1.639e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=2.832e-01, best=1.639e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=1.415e-01, best=1.415e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=3.682e-01, best=1.415e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=1.160e-01, best=1.160e-01, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=4.650e-01, best=1.160e-01, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=8.698e-02, best=8.698e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=5.754e-01, best=8.698e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=5.386e-02, best=5.386e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=7.013e-01, best=5.386e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=1.611e-02, best=1.611e-02, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=8.447e-01, best=1.611e-02, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=2.694e-02, best=1.611e-02, lr=7.77e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=7.500e-01, best=1.611e-02, lr=7.38e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=1.191e-02, best=1.191e-02, lr=8.86e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=8.738e-01, best=1.191e-02, lr=8.41e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=3.237e-02, best=1.191e-02, lr=7.99e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=7.670e-01, best=1.191e-02, lr=7.59e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.01it/s, loss=7.592e-03, best=7.592e-03, lr=9.11e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.63it/s, loss=7.592e-03, best=7.592e-03, lr=9.11e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.63it/s, loss=9.036e-01, best=7.592e-03, lr=8.66e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.63it/s, loss=3.797e-02, best=7.592e-03, lr=8.22e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.63it/s, loss=7.844e-01, best=7.592e-03, lr=7.81e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.63it/s, loss=3.150e-03, best=3.150e-03, lr=9.37e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.63it/s, loss=9.344e-01, best=3.150e-03, lr=8.91e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.63it/s, loss=4.373e-02, best=3.150e-03, lr=8.46e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.63it/s, loss=8.024e-01, best=3.150e-03, lr=8.04e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.63it/s, loss=1.420e-03, best=1.420e-03, lr=9.64e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.63it/s, loss=9.631e-01, best=1.420e-03, lr=9.16e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.63it/s, loss=4.681e-02, best=1.420e-03, lr=8.70e-01, worse_count=2]
                                                                                                                                       
(84/208) Processing tensor: layers.19.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.373e+00, best=2.373e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.363e+00, best=2.363e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.351e+00, best=2.351e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.337e+00, best=2.337e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.320e+00, best=2.320e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.300e+00, best=2.300e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.276e+00, best=2.276e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.247e+00, best=2.247e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.212e+00, best=2.212e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.171e+00, best=2.171e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.120e+00, best=2.120e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.060e+00, best=2.060e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.988e+00, best=1.988e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.901e+00, best=1.901e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.797e+00, best=1.797e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.673e+00, best=1.673e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.523e+00, best=1.523e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.343e+00, best=1.343e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.128e+00, best=1.128e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=1.128e+00, best=1.128e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=8.689e-01, best=8.689e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=5.584e-01, best=5.584e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=1.858e-01, best=1.858e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=2.613e-01, best=1.858e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=1.635e-01, best=1.635e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=3.462e-01, best=1.635e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=1.380e-01, best=1.380e-01, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=4.430e-01, best=1.380e-01, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=1.089e-01, best=1.089e-01, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=5.534e-01, best=1.089e-01, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=7.582e-02, best=7.582e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=6.793e-01, best=7.582e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=3.806e-02, best=3.806e-02, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=8.228e-01, best=3.806e-02, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=4.981e-03, best=4.981e-03, lr=9.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=9.764e-01, best=4.981e-03, lr=9.32e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=4.409e-02, best=4.981e-03, lr=8.86e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=8.416e-01, best=4.981e-03, lr=8.41e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.80it/s, loss=2.008e-04, best=2.008e-04, lr=1.01e+00, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.21it/s, loss=2.008e-04, best=2.008e-04, lr=1.01e+00, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.21it/s, loss=1.009e+00, best=2.008e-04, lr=9.59e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.21it/s, loss=5.028e-02, best=2.008e-04, lr=9.11e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.21it/s, loss=8.609e-01, best=2.008e-04, lr=8.66e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.21it/s, loss=4.721e-03, best=2.008e-04, lr=8.22e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.21it/s, loss=8.176e-01, best=2.008e-04, lr=7.81e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.21it/s, loss=3.640e-02, best=2.008e-04, lr=7.42e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.21it/s, loss=7.058e-01, best=2.008e-04, lr=7.05e-01, worse_count=7]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.21it/s, loss=7.132e-04, best=2.008e-04, lr=6.70e-01, worse_count=8]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.21it/s, loss=6.691e-01, best=2.008e-04, lr=6.36e-01, worse_count=9]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.21it/s, loss=3.278e-02, best=2.008e-04, lr=6.04e-01, worse_count=10]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.21it/s, loss=5.717e-01, best=2.008e-04, lr=5.74e-01, worse_count=11]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.21it/s, loss=2.552e-03, best=2.008e-04, lr=5.46e-01, worse_count=12]
                                                                                                                                        
(85/208) Processing tensor: layers.19.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.805e+00, best=1.805e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.795e+00, best=1.795e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.784e+00, best=1.784e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.770e+00, best=1.770e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.753e+00, best=1.753e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.733e+00, best=1.733e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.709e+00, best=1.709e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.680e+00, best=1.680e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.645e+00, best=1.645e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.603e+00, best=1.603e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.553e+00, best=1.553e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.493e+00, best=1.493e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.420e+00, best=1.420e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.334e+00, best=1.334e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.230e+00, best=1.230e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.105e+00, best=1.105e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.553e-01, best=9.553e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.756e-01, best=7.756e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.600e-01, best=5.600e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.013e-01, best=3.013e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=3.013e-01, best=3.013e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=9.192e-03, best=9.192e-03, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=3.634e-01, best=9.192e-03, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=9.438e-03, best=9.192e-03, lr=3.36e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=3.268e-01, best=9.192e-03, lr=3.19e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=7.375e-03, best=7.375e-03, lr=3.83e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=3.760e-01, best=7.375e-03, lr=3.64e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=1.179e-02, best=7.375e-03, lr=3.46e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=3.342e-01, best=7.375e-03, lr=3.29e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=5.507e-03, best=5.507e-03, lr=3.94e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=3.889e-01, best=5.507e-03, lr=3.75e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=1.421e-02, best=5.507e-03, lr=3.56e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=3.417e-01, best=5.507e-03, lr=3.38e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=3.584e-03, best=3.584e-03, lr=4.06e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=4.022e-01, best=3.584e-03, lr=3.85e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=1.670e-02, best=3.584e-03, lr=3.66e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=3.495e-01, best=3.584e-03, lr=3.48e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=1.606e-03, best=1.606e-03, lr=4.17e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=4.159e-01, best=1.606e-03, lr=3.97e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=1.927e-02, best=1.606e-03, lr=3.77e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.26it/s, loss=3.575e-01, best=1.606e-03, lr=3.58e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.82it/s, loss=3.575e-01, best=1.606e-03, lr=3.58e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.82it/s, loss=4.296e-04, best=4.296e-04, lr=4.29e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.82it/s, loss=4.291e-01, best=4.296e-04, lr=4.08e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.82it/s, loss=2.105e-02, best=4.296e-04, lr=3.88e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.82it/s, loss=3.666e-01, best=4.296e-04, lr=3.68e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.82it/s, loss=1.664e-03, best=4.296e-04, lr=3.50e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.82it/s, loss=3.482e-01, best=4.296e-04, lr=3.32e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.82it/s, loss=1.583e-02, best=4.296e-04, lr=3.16e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.82it/s, loss=2.999e-01, best=4.296e-04, lr=3.00e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.82it/s, loss=4.259e-05, best=4.259e-05, lr=3.60e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.82it/s, loss=3.599e-01, best=4.259e-05, lr=3.42e-01, worse_count=1]
                                                                                                                                       
(86/208) Skipping tensor: layers.2.adaLN_modulation.0.weight (Reason: In high-precision list)
(87/208) Processing tensor: layers.2.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.210e+00, best=2.210e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.200e+00, best=2.200e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.190e+00, best=2.190e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.178e+00, best=2.178e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.164e+00, best=2.164e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.149e+00, best=2.149e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.131e+00, best=2.131e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.111e+00, best=2.111e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.088e+00, best=2.088e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.061e+00, best=2.061e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.031e+00, best=2.031e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.997e+00, best=1.997e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.958e+00, best=1.958e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.913e+00, best=1.913e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.863e+00, best=1.863e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.805e+00, best=1.805e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.739e+00, best=1.739e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.664e+00, best=1.664e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.578e+00, best=1.578e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.481e+00, best=1.481e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.369e+00, best=1.369e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.242e+00, best=1.242e+00, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.098e+00, best=1.098e+00, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.329e-01, best=9.329e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.449e-01, best=7.449e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.306e-01, best=5.306e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.863e-01, best=2.863e-01, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.847e-03, best=7.847e-03, lr=3.17e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.096e-01, best=7.847e-03, lr=2.87e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.311e-02, best=7.847e-03, lr=2.59e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.355e-01, best=7.847e-03, lr=2.33e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.105e-03, best=2.105e-03, lr=2.66e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.640e-01, best=2.105e-03, lr=2.40e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.383e-02, best=2.105e-03, lr=2.17e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.929e-01, best=2.105e-03, lr=1.96e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.706e-03, best=2.105e-03, lr=1.77e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.738e-01, best=2.105e-03, lr=1.59e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.450e-02, best=2.105e-03, lr=1.44e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.293e-01, best=2.105e-03, lr=1.30e-01, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.860e-04, best=4.860e-04, lr=1.48e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.474e-01, best=4.860e-04, lr=1.33e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.394e-02, best=4.860e-04, lr=1.20e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.065e-01, best=4.860e-04, lr=1.09e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.189e-03, best=4.860e-04, lr=9.81e-02, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.594e-02, best=4.860e-04, lr=8.86e-02, worse_count=5]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 446.15it/s, loss=9.594e-02, best=4.860e-04, lr=8.86e-02, worse_count=5]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 446.15it/s, loss=7.378e-03, best=4.860e-04, lr=7.99e-02, worse_count=6]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 446.15it/s, loss=7.255e-02, best=4.860e-04, lr=7.21e-02, worse_count=7]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 446.15it/s, loss=4.145e-04, best=4.145e-04, lr=8.22e-02, worse_count=0]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 446.15it/s, loss=8.182e-02, best=4.145e-04, lr=7.42e-02, worse_count=1]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 446.15it/s, loss=7.603e-03, best=4.145e-04, lr=6.70e-02, worse_count=2]
                                                                                                                                       
(88/208) Processing tensor: layers.2.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.868e+00, best=1.868e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.858e+00, best=1.858e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.847e+00, best=1.847e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.833e+00, best=1.833e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.816e+00, best=1.816e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.796e+00, best=1.796e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.772e+00, best=1.772e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.743e+00, best=1.743e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.708e+00, best=1.708e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.666e+00, best=1.666e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.616e+00, best=1.616e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.556e+00, best=1.556e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.483e+00, best=1.483e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.397e+00, best=1.397e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.293e+00, best=1.293e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.168e+00, best=1.168e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.018e+00, best=1.018e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.387e-01, best=8.387e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=8.387e-01, best=8.387e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=6.231e-01, best=6.231e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=3.643e-01, best=3.643e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=5.387e-02, best=5.387e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=3.187e-01, best=5.387e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=3.524e-02, best=3.524e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=3.895e-01, best=3.524e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=1.400e-02, best=1.400e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=4.702e-01, best=1.400e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=1.021e-02, best=1.021e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=5.418e-01, best=1.021e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=1.739e-02, best=1.021e-02, lr=4.98e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=4.808e-01, best=1.021e-02, lr=4.73e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=7.515e-03, best=7.515e-03, lr=5.68e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=5.604e-01, best=7.515e-03, lr=5.39e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=2.088e-02, best=7.515e-03, lr=5.13e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=4.917e-01, best=7.515e-03, lr=4.87e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=4.747e-03, best=4.747e-03, lr=5.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=5.795e-01, best=4.747e-03, lr=5.55e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.37it/s, loss=2.447e-02, best=4.747e-03, lr=5.27e-01, worse_count=2]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.46it/s, loss=2.447e-02, best=4.747e-03, lr=5.27e-01, worse_count=2]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.46it/s, loss=5.029e-01, best=4.747e-03, lr=5.01e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.46it/s, loss=1.899e-03, best=1.899e-03, lr=6.01e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.46it/s, loss=5.993e-01, best=1.899e-03, lr=5.71e-01, worse_count=1]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.46it/s, loss=2.816e-02, best=1.899e-03, lr=5.43e-01, worse_count=2]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.46it/s, loss=5.144e-01, best=1.899e-03, lr=5.15e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.46it/s, loss=1.032e-03, best=1.032e-03, lr=6.18e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.46it/s, loss=6.175e-01, best=1.032e-03, lr=5.88e-01, worse_count=1]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.46it/s, loss=2.989e-02, best=1.032e-03, lr=5.58e-01, worse_count=2]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.46it/s, loss=5.283e-01, best=1.032e-03, lr=5.30e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.46it/s, loss=1.983e-03, best=1.032e-03, lr=5.04e-01, worse_count=4]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.46it/s, loss=5.018e-01, best=1.032e-03, lr=4.79e-01, worse_count=5]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.46it/s, loss=2.321e-02, best=1.032e-03, lr=4.55e-01, worse_count=6]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 176.46it/s, loss=4.314e-01, best=1.032e-03, lr=4.32e-01, worse_count=7]
                                                                                                                                       
(89/208) Processing tensor: layers.2.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.865e+00, best=1.865e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.856e+00, best=1.856e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.844e+00, best=1.844e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.830e+00, best=1.830e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.813e+00, best=1.813e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.793e+00, best=1.793e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.769e+00, best=1.769e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.740e+00, best=1.740e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.705e+00, best=1.705e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.663e+00, best=1.663e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.613e+00, best=1.613e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.553e+00, best=1.553e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.481e+00, best=1.481e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.394e+00, best=1.394e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.290e+00, best=1.290e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.165e+00, best=1.165e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.016e+00, best=1.016e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.359e-01, best=8.359e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.203e-01, best=6.203e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.615e-01, best=3.615e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=3.615e-01, best=3.615e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=5.106e-02, best=5.106e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=3.215e-01, best=5.106e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=3.244e-02, best=3.244e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=3.923e-01, best=3.244e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=1.120e-02, best=1.120e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=4.730e-01, best=1.120e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=1.301e-02, best=1.120e-02, lr=4.37e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=4.240e-01, best=1.120e-02, lr=4.15e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=8.838e-03, best=8.838e-03, lr=4.98e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=4.893e-01, best=8.838e-03, lr=4.73e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=1.607e-02, best=8.838e-03, lr=4.50e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=4.335e-01, best=8.838e-03, lr=4.27e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=6.410e-03, best=6.410e-03, lr=5.13e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=5.061e-01, best=6.410e-03, lr=4.87e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=1.922e-02, best=6.410e-03, lr=4.63e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=4.434e-01, best=6.410e-03, lr=4.39e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=3.911e-03, best=3.911e-03, lr=5.27e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=5.234e-01, best=3.911e-03, lr=5.01e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=2.246e-02, best=3.911e-03, lr=4.76e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.45it/s, loss=4.535e-01, best=3.911e-03, lr=4.52e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.14it/s, loss=4.535e-01, best=3.911e-03, lr=4.52e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.14it/s, loss=1.341e-03, best=1.341e-03, lr=5.43e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.14it/s, loss=5.412e-01, best=1.341e-03, lr=5.15e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.14it/s, loss=2.579e-02, best=1.341e-03, lr=4.90e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.14it/s, loss=4.639e-01, best=1.341e-03, lr=4.65e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.14it/s, loss=1.305e-03, best=1.305e-03, lr=5.58e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.14it/s, loss=5.569e-01, best=1.305e-03, lr=5.30e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.14it/s, loss=2.661e-02, best=1.305e-03, lr=5.04e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.14it/s, loss=4.772e-01, best=1.305e-03, lr=4.79e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.14it/s, loss=1.417e-03, best=1.305e-03, lr=4.55e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.14it/s, loss=4.532e-01, best=1.305e-03, lr=4.32e-01, worse_count=5]
                                                                                                                                       
(90/208) Processing tensor: layers.2.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.876e+00, best=1.876e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.867e+00, best=1.867e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.855e+00, best=1.855e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.841e+00, best=1.841e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.824e+00, best=1.824e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.804e+00, best=1.804e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.780e+00, best=1.780e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.751e+00, best=1.751e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.716e+00, best=1.716e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.674e+00, best=1.674e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.624e+00, best=1.624e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.564e+00, best=1.564e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.492e+00, best=1.492e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.405e+00, best=1.405e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.301e+00, best=1.301e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.176e+00, best=1.176e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.027e+00, best=1.027e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.469e-01, best=8.469e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.312e-01, best=6.312e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=6.312e-01, best=6.312e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=3.725e-01, best=3.725e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=6.203e-02, best=6.203e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=3.105e-01, best=6.203e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=4.340e-02, best=4.340e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=3.813e-01, best=4.340e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=2.216e-02, best=2.216e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=4.620e-01, best=2.216e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=2.048e-03, best=2.048e-03, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=5.499e-01, best=2.048e-03, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=2.555e-02, best=2.048e-03, lr=4.98e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=4.726e-01, best=2.048e-03, lr=4.73e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=6.438e-04, best=6.438e-04, lr=5.68e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=5.673e-01, best=6.438e-04, lr=5.39e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=2.775e-02, best=6.438e-04, lr=5.13e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=4.848e-01, best=6.438e-04, lr=4.87e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=2.125e-03, best=6.438e-04, lr=4.63e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=4.604e-01, best=6.438e-04, lr=4.39e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=2.100e-02, best=6.438e-04, lr=4.17e-01, worse_count=6]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=3.965e-01, best=6.438e-04, lr=3.97e-01, worse_count=7]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 180.36it/s, loss=1.314e-04, best=1.314e-04, lr=4.76e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.33it/s, loss=1.314e-04, best=1.314e-04, lr=4.76e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.33it/s, loss=4.758e-01, best=1.314e-04, lr=4.52e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.33it/s, loss=2.366e-02, best=1.314e-04, lr=4.29e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.33it/s, loss=4.059e-01, best=1.314e-04, lr=4.08e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.33it/s, loss=2.189e-03, best=1.314e-04, lr=3.88e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.33it/s, loss=3.855e-01, best=1.314e-04, lr=3.68e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.33it/s, loss=1.719e-02, best=1.314e-04, lr=3.50e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.33it/s, loss=3.327e-01, best=1.314e-04, lr=3.32e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.33it/s, loss=2.993e-04, best=1.314e-04, lr=3.16e-01, worse_count=8]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.33it/s, loss=3.154e-01, best=1.314e-04, lr=3.00e-01, worse_count=9]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.33it/s, loss=1.549e-02, best=1.314e-04, lr=2.85e-01, worse_count=10]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.33it/s, loss=2.695e-01, best=1.314e-04, lr=2.71e-01, worse_count=11]
                                                                                                                                        
(91/208) Processing tensor: layers.2.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.659e+00, best=2.659e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.650e+00, best=2.650e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.638e+00, best=2.638e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.624e+00, best=2.624e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.607e+00, best=2.607e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.587e+00, best=2.587e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.563e+00, best=2.563e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.534e+00, best=2.534e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.499e+00, best=2.499e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.457e+00, best=2.457e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.407e+00, best=2.407e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.347e+00, best=2.347e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.275e+00, best=2.275e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.188e+00, best=2.188e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.084e+00, best=2.084e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.959e+00, best=1.959e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.810e+00, best=1.810e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.630e+00, best=1.630e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.414e+00, best=1.414e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.156e+00, best=1.156e+00, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=1.156e+00, best=1.156e+00, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=8.452e-01, best=8.452e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=4.726e-01, best=4.726e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=2.553e-02, best=2.553e-02, lr=5.36e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=5.110e-01, best=2.553e-02, lr=5.10e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=1.292e-03, best=1.292e-03, lr=6.12e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=6.103e-01, best=1.292e-03, lr=5.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=2.929e-02, best=1.292e-03, lr=5.52e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=5.227e-01, best=1.292e-03, lr=5.24e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=1.689e-03, best=1.292e-03, lr=4.98e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=4.965e-01, best=1.292e-03, lr=4.73e-01, worse_count=5]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=2.322e-02, best=1.292e-03, lr=4.50e-01, worse_count=6]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=4.264e-01, best=1.292e-03, lr=4.27e-01, worse_count=7]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=7.396e-04, best=7.396e-04, lr=5.13e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=5.118e-01, best=7.396e-04, lr=4.87e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=2.489e-02, best=7.396e-04, lr=4.63e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=4.377e-01, best=7.396e-04, lr=4.39e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=1.759e-03, best=7.396e-04, lr=4.17e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=4.157e-01, best=7.396e-04, lr=3.97e-01, worse_count=5]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=1.911e-02, best=7.396e-04, lr=3.77e-01, worse_count=6]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.04it/s, loss=3.577e-01, best=7.396e-04, lr=3.58e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.07it/s, loss=3.577e-01, best=7.396e-04, lr=3.58e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.07it/s, loss=2.766e-04, best=2.766e-04, lr=4.29e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.07it/s, loss=4.292e-01, best=2.766e-04, lr=4.08e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.07it/s, loss=2.120e-02, best=2.766e-04, lr=3.88e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.07it/s, loss=3.664e-01, best=2.766e-04, lr=3.68e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.07it/s, loss=1.817e-03, best=2.766e-04, lr=3.50e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.07it/s, loss=3.480e-01, best=2.766e-04, lr=3.32e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.07it/s, loss=1.567e-02, best=2.766e-04, lr=3.16e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.07it/s, loss=3.001e-01, best=2.766e-04, lr=3.00e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.07it/s, loss=1.127e-04, best=1.127e-04, lr=3.60e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.07it/s, loss=3.598e-01, best=1.127e-04, lr=3.42e-01, worse_count=1]
                                                                                                                                       
(92/208) Skipping tensor: layers.20.adaLN_modulation.0.weight (Reason: In high-precision list)
(93/208) Processing tensor: layers.20.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.134e+00, best=2.134e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.124e+00, best=2.124e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.114e+00, best=2.114e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.102e+00, best=2.102e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.088e+00, best=2.088e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.072e+00, best=2.072e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.055e+00, best=2.055e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.034e+00, best=2.034e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.011e+00, best=2.011e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.985e+00, best=1.985e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.955e+00, best=1.955e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.921e+00, best=1.921e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.882e+00, best=1.882e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.837e+00, best=1.837e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.787e+00, best=1.787e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.729e+00, best=1.729e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.663e+00, best=1.663e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.588e+00, best=1.588e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.502e+00, best=1.502e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.404e+00, best=1.404e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.293e+00, best=1.293e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.166e+00, best=1.166e+00, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.022e+00, best=1.022e+00, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.567e-01, best=8.567e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.687e-01, best=6.687e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.544e-01, best=4.544e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.101e-01, best=2.101e-01, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.839e-02, best=6.839e-02, lr=3.17e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.491e-01, best=6.839e-02, lr=2.87e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.743e-02, best=3.743e-02, lr=3.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.892e-01, best=3.743e-02, lr=2.95e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.582e-03, best=5.582e-03, lr=3.36e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.305e-01, best=5.582e-03, lr=3.03e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.719e-02, best=5.582e-03, lr=2.74e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.466e-01, best=5.582e-03, lr=2.47e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.962e-04, best=4.962e-04, lr=2.82e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.811e-01, best=4.962e-04, lr=2.54e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.696e-02, best=4.962e-04, lr=2.29e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.024e-01, best=4.962e-04, lr=2.07e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.597e-03, best=4.962e-04, lr=1.87e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.822e-01, best=4.962e-04, lr=1.69e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.362e-02, best=4.962e-04, lr=1.52e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.386e-01, best=4.962e-04, lr=1.37e-01, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.218e-03, best=4.962e-04, lr=1.24e-01, worse_count=8]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.227e-01, best=4.962e-04, lr=1.12e-01, worse_count=9]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.087e-02, best=4.962e-04, lr=1.01e-01, worse_count=10]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.010e-02, best=4.962e-04, lr=9.11e-02, worse_count=11]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 457.61it/s, loss=9.010e-02, best=4.962e-04, lr=9.11e-02, worse_count=11]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 457.61it/s, loss=1.024e-03, best=4.962e-04, lr=8.22e-02, worse_count=12]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 457.61it/s, loss=8.121e-02, best=4.962e-04, lr=7.42e-02, worse_count=13]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 457.61it/s, loss=6.994e-03, best=4.962e-04, lr=6.70e-02, worse_count=14]
                                                                                                                                        
(94/208) Processing tensor: layers.20.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.989e+00, best=1.989e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.979e+00, best=1.979e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.968e+00, best=1.968e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.954e+00, best=1.954e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.937e+00, best=1.937e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.917e+00, best=1.917e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.892e+00, best=1.892e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.863e+00, best=1.863e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.829e+00, best=1.829e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.787e+00, best=1.787e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.737e+00, best=1.737e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.676e+00, best=1.676e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.604e+00, best=1.604e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.518e+00, best=1.518e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.414e+00, best=1.414e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.289e+00, best=1.289e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.139e+00, best=1.139e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.594e-01, best=9.594e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=9.594e-01, best=9.594e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=7.438e-01, best=7.438e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=4.851e-01, best=4.851e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=1.746e-01, best=1.746e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=1.980e-01, best=1.746e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=1.560e-01, best=1.560e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=2.688e-01, best=1.560e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=1.347e-01, best=1.347e-01, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=3.495e-01, best=1.347e-01, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=1.105e-01, best=1.105e-01, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=4.415e-01, best=1.105e-01, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=8.293e-02, best=8.293e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=5.463e-01, best=8.293e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=5.147e-02, best=5.147e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=6.659e-01, best=5.147e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=1.560e-02, best=1.560e-02, lr=8.18e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=8.022e-01, best=1.560e-02, lr=7.77e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=2.529e-02, best=1.560e-02, lr=7.38e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.15it/s, loss=7.128e-01, best=1.560e-02, lr=7.01e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.61it/s, loss=7.128e-01, best=1.560e-02, lr=7.01e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.61it/s, loss=1.161e-02, best=1.161e-02, lr=8.41e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.61it/s, loss=8.298e-01, best=1.161e-02, lr=7.99e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.61it/s, loss=3.046e-02, best=1.161e-02, lr=7.59e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.61it/s, loss=7.289e-01, best=1.161e-02, lr=7.21e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.61it/s, loss=7.510e-03, best=7.510e-03, lr=8.66e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.61it/s, loss=8.582e-01, best=7.510e-03, lr=8.22e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.61it/s, loss=3.577e-02, best=7.510e-03, lr=7.81e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.61it/s, loss=7.455e-01, best=7.510e-03, lr=7.42e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.61it/s, loss=3.290e-03, best=3.290e-03, lr=8.91e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.61it/s, loss=8.873e-01, best=3.290e-03, lr=8.46e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.61it/s, loss=4.124e-02, best=3.290e-03, lr=8.04e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.61it/s, loss=7.626e-01, best=3.290e-03, lr=7.64e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.61it/s, loss=1.052e-03, best=1.052e-03, lr=9.16e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.61it/s, loss=9.153e-01, best=1.052e-03, lr=8.70e-01, worse_count=1]
                                                                                                                                       
(95/208) Processing tensor: layers.20.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.000e+00, best=2.000e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.991e+00, best=1.991e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.979e+00, best=1.979e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.965e+00, best=1.965e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.948e+00, best=1.948e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.928e+00, best=1.928e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.904e+00, best=1.904e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.875e+00, best=1.875e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.840e+00, best=1.840e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.798e+00, best=1.798e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.748e+00, best=1.748e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.688e+00, best=1.688e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.616e+00, best=1.616e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.529e+00, best=1.529e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.425e+00, best=1.425e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.300e+00, best=1.300e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.150e+00, best=1.150e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.708e-01, best=9.708e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.552e-01, best=7.552e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.965e-01, best=4.965e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=4.965e-01, best=4.965e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=1.860e-01, best=1.860e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=1.866e-01, best=1.860e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=1.673e-01, best=1.673e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=2.574e-01, best=1.673e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=1.461e-01, best=1.461e-01, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=3.381e-01, best=1.461e-01, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=1.219e-01, best=1.219e-01, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=4.301e-01, best=1.219e-01, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=9.429e-02, best=9.429e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=5.350e-01, best=9.429e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=6.283e-02, best=6.283e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=6.545e-01, best=6.283e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=2.696e-02, best=2.696e-02, lr=8.18e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=7.908e-01, best=2.696e-02, lr=7.77e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=1.393e-02, best=1.393e-02, lr=9.32e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=9.184e-01, best=1.393e-02, lr=8.86e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=3.268e-02, best=1.393e-02, lr=8.41e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=8.087e-01, best=1.393e-02, lr=7.99e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=9.385e-03, best=9.385e-03, lr=9.59e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.61it/s, loss=9.498e-01, best=9.385e-03, lr=9.11e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.76it/s, loss=9.498e-01, best=9.385e-03, lr=9.11e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.76it/s, loss=3.857e-02, best=9.385e-03, lr=8.66e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.76it/s, loss=8.271e-01, best=9.385e-03, lr=8.22e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.76it/s, loss=4.710e-03, best=4.710e-03, lr=9.87e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.76it/s, loss=9.822e-01, best=4.710e-03, lr=9.37e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.76it/s, loss=4.463e-02, best=4.710e-03, lr=8.91e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.76it/s, loss=8.460e-01, best=4.710e-03, lr=8.46e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.76it/s, loss=1.069e-04, best=1.069e-04, lr=1.02e+00, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.76it/s, loss=1.015e+00, best=1.069e-04, lr=9.64e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.76it/s, loss=5.066e-02, best=1.069e-04, lr=9.16e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.76it/s, loss=8.657e-01, best=1.069e-04, lr=8.70e-01, worse_count=3]
                                                                                                                                       
(96/208) Processing tensor: layers.20.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.457e+00, best=2.457e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.448e+00, best=2.448e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.436e+00, best=2.436e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.422e+00, best=2.422e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.405e+00, best=2.405e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.385e+00, best=2.385e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.361e+00, best=2.361e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.332e+00, best=2.332e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.297e+00, best=2.297e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.255e+00, best=2.255e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.205e+00, best=2.205e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.145e+00, best=2.145e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.073e+00, best=2.073e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.986e+00, best=1.986e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.882e+00, best=1.882e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.757e+00, best=1.757e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.607e+00, best=1.607e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.428e+00, best=1.428e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.212e+00, best=1.212e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=1.212e+00, best=1.212e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=9.535e-01, best=9.535e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=6.430e-01, best=6.430e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=2.704e-01, best=2.704e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=1.767e-01, best=1.767e-01, lr=5.36e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=3.598e-01, best=1.767e-01, lr=5.10e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=1.498e-01, best=1.498e-01, lr=6.12e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=4.618e-01, best=1.498e-01, lr=5.81e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=1.193e-01, best=1.193e-01, lr=6.97e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=5.780e-01, best=1.193e-01, lr=6.62e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=8.440e-02, best=8.440e-02, lr=7.95e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=7.104e-01, best=8.440e-02, lr=7.55e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=4.466e-02, best=4.466e-02, lr=9.06e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=8.615e-01, best=4.466e-02, lr=8.61e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=6.508e-04, best=6.508e-04, lr=1.03e+00, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=1.032e+00, best=6.508e-04, lr=9.81e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=5.100e-02, best=6.508e-04, lr=9.32e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=8.813e-01, best=6.508e-04, lr=8.86e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=4.385e-03, best=6.508e-04, lr=8.41e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=8.370e-01, best=6.508e-04, lr=7.99e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.12it/s, loss=3.768e-02, best=6.508e-04, lr=7.59e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.82it/s, loss=3.768e-02, best=6.508e-04, lr=7.59e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.82it/s, loss=7.217e-01, best=6.508e-04, lr=7.21e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.82it/s, loss=2.853e-04, best=2.853e-04, lr=8.66e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.82it/s, loss=8.653e-01, best=2.853e-04, lr=8.22e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.82it/s, loss=4.300e-02, best=2.853e-04, lr=7.81e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.82it/s, loss=7.382e-01, best=2.853e-04, lr=7.42e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.82it/s, loss=3.935e-03, best=2.853e-04, lr=7.05e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.82it/s, loss=7.011e-01, best=2.853e-04, lr=6.70e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.82it/s, loss=3.132e-02, best=2.853e-04, lr=6.36e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.82it/s, loss=6.050e-01, best=2.853e-04, lr=6.04e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.82it/s, loss=4.986e-04, best=2.853e-04, lr=5.74e-01, worse_count=8]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.82it/s, loss=5.738e-01, best=2.853e-04, lr=5.46e-01, worse_count=9]
                                                                                                                                       
(97/208) Processing tensor: layers.20.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.823e+00, best=1.823e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.813e+00, best=1.813e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.801e+00, best=1.801e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.787e+00, best=1.787e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.771e+00, best=1.771e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.750e+00, best=1.750e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.726e+00, best=1.726e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.697e+00, best=1.697e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.662e+00, best=1.662e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.621e+00, best=1.621e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.571e+00, best=1.571e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.510e+00, best=1.510e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.438e+00, best=1.438e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.351e+00, best=1.351e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.247e+00, best=1.247e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.123e+00, best=1.123e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.730e-01, best=9.730e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.933e-01, best=7.933e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.777e-01, best=5.777e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.189e-01, best=3.189e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=3.189e-01, best=3.189e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=8.463e-03, best=8.463e-03, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=3.641e-01, best=8.463e-03, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=1.017e-02, best=8.463e-03, lr=3.36e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=3.261e-01, best=8.463e-03, lr=3.19e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=6.646e-03, best=6.646e-03, lr=3.83e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=3.767e-01, best=6.646e-03, lr=3.64e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=1.252e-02, best=6.646e-03, lr=3.46e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=3.334e-01, best=6.646e-03, lr=3.29e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=4.778e-03, best=4.778e-03, lr=3.94e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=3.896e-01, best=4.778e-03, lr=3.75e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=1.494e-02, best=4.778e-03, lr=3.56e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=3.410e-01, best=4.778e-03, lr=3.38e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=2.855e-03, best=2.855e-03, lr=4.06e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=4.029e-01, best=2.855e-03, lr=3.85e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=1.743e-02, best=2.855e-03, lr=3.66e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=3.488e-01, best=2.855e-03, lr=3.48e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=8.771e-04, best=8.771e-04, lr=4.17e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=4.166e-01, best=8.771e-04, lr=3.97e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=2.000e-02, best=8.771e-04, lr=3.77e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.56it/s, loss=3.568e-01, best=8.771e-04, lr=3.58e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.29it/s, loss=3.568e-01, best=8.771e-04, lr=3.58e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.29it/s, loss=1.158e-03, best=8.771e-04, lr=3.40e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.29it/s, loss=3.389e-01, best=8.771e-04, lr=3.23e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.29it/s, loss=1.584e-02, best=8.771e-04, lr=3.07e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.29it/s, loss=2.910e-01, best=8.771e-04, lr=2.92e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.29it/s, loss=4.997e-04, best=4.997e-04, lr=3.50e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.29it/s, loss=3.493e-01, best=4.997e-04, lr=3.32e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.29it/s, loss=1.699e-02, best=4.997e-04, lr=3.16e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.29it/s, loss=2.987e-01, best=4.997e-04, lr=3.00e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.29it/s, loss=1.206e-03, best=4.997e-04, lr=2.85e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.29it/s, loss=2.837e-01, best=4.997e-04, lr=2.71e-01, worse_count=5]
                                                                                                                                       
(98/208) Skipping tensor: layers.21.adaLN_modulation.0.weight (Reason: In high-precision list)
(99/208) Processing tensor: layers.21.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.856e+00, best=1.856e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.847e+00, best=1.847e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.837e+00, best=1.837e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.825e+00, best=1.825e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.811e+00, best=1.811e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.795e+00, best=1.795e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.778e+00, best=1.778e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.757e+00, best=1.757e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.734e+00, best=1.734e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.708e+00, best=1.708e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.678e+00, best=1.678e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.644e+00, best=1.644e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.605e+00, best=1.605e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.560e+00, best=1.560e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.509e+00, best=1.509e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.452e+00, best=1.452e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.386e+00, best=1.386e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.311e+00, best=1.311e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.225e+00, best=1.225e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.127e+00, best=1.127e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.016e+00, best=1.016e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.891e-01, best=8.891e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.444e-01, best=7.444e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.795e-01, best=5.795e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.915e-01, best=3.915e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.772e-01, best=1.772e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.709e-02, best=6.709e-02, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.114e-01, best=6.709e-02, lr=2.51e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.994e-02, best=3.994e-02, lr=2.87e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.466e-01, best=3.994e-02, lr=2.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.200e-02, best=1.200e-02, lr=2.95e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.828e-01, best=1.200e-02, lr=2.66e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.675e-02, best=1.200e-02, lr=2.40e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.234e-01, best=1.200e-02, lr=2.17e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.666e-03, best=6.666e-03, lr=2.47e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.404e-01, best=6.666e-03, lr=2.23e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.742e-02, best=6.666e-03, lr=2.01e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.838e-01, best=6.666e-03, lr=1.82e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.198e-03, best=2.198e-03, lr=2.07e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.048e-01, best=2.198e-03, lr=1.87e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.799e-02, best=2.198e-03, lr=1.69e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.506e-01, best=2.198e-03, lr=1.52e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.546e-03, best=1.546e-03, lr=1.73e-01, worse_count=0]
    Optimizing (Original):  86%|████████▌ | 43/50 [00:00<00:00, 429.62it/s, loss=1.546e-03, best=1.546e-03, lr=1.73e-01, worse_count=0]
    Optimizing (Original):  86%|████████▌ | 43/50 [00:00<00:00, 429.62it/s, loss=1.719e-01, best=1.546e-03, lr=1.57e-01, worse_count=1]
    Optimizing (Original):  86%|████████▌ | 43/50 [00:00<00:00, 429.62it/s, loss=1.537e-02, best=1.546e-03, lr=1.41e-01, worse_count=2]
    Optimizing (Original):  86%|████████▌ | 43/50 [00:00<00:00, 429.62it/s, loss=1.259e-01, best=1.546e-03, lr=1.28e-01, worse_count=3]
    Optimizing (Original):  86%|████████▌ | 43/50 [00:00<00:00, 429.62it/s, loss=1.592e-03, best=1.546e-03, lr=1.15e-01, worse_count=4]
    Optimizing (Original):  86%|████████▌ | 43/50 [00:00<00:00, 429.62it/s, loss=1.135e-01, best=1.546e-03, lr=1.04e-01, worse_count=5]
    Optimizing (Original):  86%|████████▌ | 43/50 [00:00<00:00, 429.62it/s, loss=9.630e-03, best=1.546e-03, lr=9.37e-02, worse_count=6]
    Optimizing (Original):  86%|████████▌ | 43/50 [00:00<00:00, 429.62it/s, loss=8.412e-02, best=1.546e-03, lr=8.46e-02, worse_count=7]
                                                                                                                                       
(100/208) Processing tensor: layers.21.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.043e+00, best=2.043e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.033e+00, best=2.033e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.021e+00, best=2.021e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.007e+00, best=2.007e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.991e+00, best=1.991e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.970e+00, best=1.970e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.946e+00, best=1.946e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.917e+00, best=1.917e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.882e+00, best=1.882e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.841e+00, best=1.841e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.791e+00, best=1.791e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.730e+00, best=1.730e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.658e+00, best=1.658e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.571e+00, best=1.571e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.467e+00, best=1.467e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.343e+00, best=1.343e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.193e+00, best=1.193e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.013e+00, best=1.013e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=1.013e+00, best=1.013e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=7.977e-01, best=7.977e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=5.390e-01, best=5.390e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=2.285e-01, best=2.285e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=1.441e-01, best=1.441e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=3.030e-01, best=1.441e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=1.217e-01, best=1.217e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=3.879e-01, best=1.217e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=9.625e-02, best=9.625e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=4.848e-01, best=9.625e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=6.720e-02, best=6.720e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=5.952e-01, best=6.720e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=3.408e-02, best=3.408e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=7.210e-01, best=3.408e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=3.676e-03, best=3.676e-03, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=8.572e-01, best=3.676e-03, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=3.937e-02, best=3.676e-03, lr=7.77e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=7.375e-01, best=3.676e-03, lr=7.38e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.64it/s, loss=5.219e-04, best=5.219e-04, lr=8.86e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.24it/s, loss=5.219e-04, best=5.219e-04, lr=8.86e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.24it/s, loss=8.852e-01, best=5.219e-04, lr=8.41e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.24it/s, loss=4.376e-02, best=5.219e-04, lr=7.99e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.24it/s, loss=7.556e-01, best=5.219e-04, lr=7.59e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.24it/s, loss=3.796e-03, best=5.219e-04, lr=7.21e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.24it/s, loss=7.176e-01, best=5.219e-04, lr=6.85e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.24it/s, loss=3.227e-02, best=5.219e-04, lr=6.51e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.24it/s, loss=6.188e-01, best=5.219e-04, lr=6.18e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.24it/s, loss=2.803e-04, best=2.803e-04, lr=7.42e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.24it/s, loss=7.419e-01, best=2.803e-04, lr=7.05e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.24it/s, loss=3.683e-02, best=2.803e-04, lr=6.70e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.24it/s, loss=6.330e-01, best=2.803e-04, lr=6.36e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.24it/s, loss=3.338e-03, best=2.803e-04, lr=6.04e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.24it/s, loss=6.012e-01, best=2.803e-04, lr=5.74e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.24it/s, loss=2.689e-02, best=2.803e-04, lr=5.46e-01, worse_count=6]
                                                                                                                                       
(101/208) Processing tensor: layers.21.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.089e+00, best=2.089e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.080e+00, best=2.080e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.068e+00, best=2.068e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.054e+00, best=2.054e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.037e+00, best=2.037e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.017e+00, best=2.017e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.993e+00, best=1.993e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.964e+00, best=1.964e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.929e+00, best=1.929e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.887e+00, best=1.887e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.837e+00, best=1.837e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.777e+00, best=1.777e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.705e+00, best=1.705e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.618e+00, best=1.618e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.514e+00, best=1.514e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.389e+00, best=1.389e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.240e+00, best=1.240e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.060e+00, best=1.060e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.444e-01, best=8.444e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.857e-01, best=5.857e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=5.857e-01, best=5.857e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=2.752e-01, best=2.752e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=9.739e-02, best=9.739e-02, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=3.497e-01, best=9.739e-02, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=7.504e-02, best=7.504e-02, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=4.346e-01, best=7.504e-02, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=4.956e-02, best=4.956e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=5.315e-01, best=4.956e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=2.050e-02, best=2.050e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=6.419e-01, best=2.050e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=1.262e-02, best=1.262e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=7.425e-01, best=1.262e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=2.514e-02, best=1.262e-02, lr=6.81e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=6.564e-01, best=1.262e-02, lr=6.47e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=8.935e-03, best=8.935e-03, lr=7.77e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=7.680e-01, best=8.935e-03, lr=7.38e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=2.991e-02, best=8.935e-03, lr=7.01e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=6.713e-01, best=8.935e-03, lr=6.66e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=5.148e-03, best=5.148e-03, lr=7.99e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=7.942e-01, best=5.148e-03, lr=7.59e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.23it/s, loss=3.482e-02, best=5.148e-03, lr=7.21e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.52it/s, loss=3.482e-02, best=5.148e-03, lr=7.21e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.52it/s, loss=6.866e-01, best=5.148e-03, lr=6.85e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.52it/s, loss=1.251e-03, best=1.251e-03, lr=8.22e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.52it/s, loss=8.211e-01, best=1.251e-03, lr=7.81e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.52it/s, loss=3.987e-02, best=1.251e-03, lr=7.42e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.52it/s, loss=7.023e-01, best=1.251e-03, lr=7.05e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.52it/s, loss=2.758e-03, best=1.251e-03, lr=6.70e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.52it/s, loss=6.671e-01, best=1.251e-03, lr=6.36e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.52it/s, loss=3.073e-02, best=1.251e-03, lr=6.04e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.52it/s, loss=5.738e-01, best=1.251e-03, lr=5.74e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.52it/s, loss=5.079e-04, best=5.079e-04, lr=6.89e-01, worse_count=0]
                                                                                                                                       
(102/208) Processing tensor: layers.21.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.443e+00, best=2.443e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.434e+00, best=2.434e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.422e+00, best=2.422e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.408e+00, best=2.408e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.391e+00, best=2.391e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.371e+00, best=2.371e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.347e+00, best=2.347e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.318e+00, best=2.318e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.283e+00, best=2.283e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.241e+00, best=2.241e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.191e+00, best=2.191e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.131e+00, best=2.131e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.059e+00, best=2.059e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.972e+00, best=1.972e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.868e+00, best=1.868e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.743e+00, best=1.743e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.593e+00, best=1.593e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.414e+00, best=1.414e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.198e+00, best=1.198e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=1.198e+00, best=1.198e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=9.394e-01, best=9.394e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=6.290e-01, best=6.290e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=2.564e-01, best=2.564e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=1.907e-01, best=1.907e-01, lr=5.36e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=3.458e-01, best=1.907e-01, lr=5.10e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=1.639e-01, best=1.639e-01, lr=6.12e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=4.477e-01, best=1.639e-01, lr=5.81e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=1.333e-01, best=1.333e-01, lr=6.97e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=5.640e-01, best=1.333e-01, lr=6.62e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=9.843e-02, best=9.843e-02, lr=7.95e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=6.964e-01, best=9.843e-02, lr=7.55e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=5.868e-02, best=5.868e-02, lr=9.06e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=8.474e-01, best=5.868e-02, lr=8.61e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=1.338e-02, best=1.338e-02, lr=1.03e+00, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=1.020e+00, best=1.338e-02, lr=9.81e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=3.827e-02, best=1.338e-02, lr=9.32e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=8.940e-01, best=1.338e-02, lr=8.86e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=8.341e-03, best=8.341e-03, lr=1.06e+00, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.79it/s, loss=1.054e+00, best=8.341e-03, lr=1.01e+00, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.49it/s, loss=1.054e+00, best=8.341e-03, lr=1.01e+00, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.49it/s, loss=4.480e-02, best=8.341e-03, lr=9.59e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.49it/s, loss=9.144e-01, best=8.341e-03, lr=9.11e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.49it/s, loss=3.160e-03, best=3.160e-03, lr=1.09e+00, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.49it/s, loss=1.090e+00, best=3.160e-03, lr=1.04e+00, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.49it/s, loss=5.151e-02, best=3.160e-03, lr=9.87e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.49it/s, loss=9.353e-01, best=3.160e-03, lr=9.37e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.49it/s, loss=2.171e-03, best=2.171e-03, lr=1.12e+00, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.49it/s, loss=1.123e+00, best=2.171e-03, lr=1.07e+00, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.49it/s, loss=5.408e-02, best=2.171e-03, lr=1.02e+00, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.49it/s, loss=9.612e-01, best=2.171e-03, lr=9.64e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.49it/s, loss=3.314e-03, best=2.171e-03, lr=9.16e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 185.49it/s, loss=9.130e-01, best=2.171e-03, lr=8.70e-01, worse_count=5]
                                                                                                                                       
(103/208) Processing tensor: layers.21.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.867e+00, best=1.867e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.857e+00, best=1.857e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.846e+00, best=1.846e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.832e+00, best=1.832e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.815e+00, best=1.815e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.795e+00, best=1.795e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.771e+00, best=1.771e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.742e+00, best=1.742e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.707e+00, best=1.707e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.665e+00, best=1.665e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.615e+00, best=1.615e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.555e+00, best=1.555e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.482e+00, best=1.482e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.396e+00, best=1.396e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.292e+00, best=1.292e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.167e+00, best=1.167e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.017e+00, best=1.017e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.375e-01, best=8.375e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.219e-01, best=6.219e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=6.219e-01, best=6.219e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=3.632e-01, best=3.632e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=5.271e-02, best=5.271e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=3.199e-01, best=5.271e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=3.408e-02, best=3.408e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=3.907e-01, best=3.408e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=1.284e-02, best=1.284e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=4.714e-01, best=1.284e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=1.137e-02, best=1.137e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=5.406e-01, best=1.137e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=1.623e-02, best=1.137e-02, lr=4.98e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=4.819e-01, best=1.137e-02, lr=4.73e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=8.680e-03, best=8.680e-03, lr=5.68e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=5.592e-01, best=8.680e-03, lr=5.39e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=1.972e-02, best=8.680e-03, lr=5.13e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=4.928e-01, best=8.680e-03, lr=4.87e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=5.911e-03, best=5.911e-03, lr=5.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=5.784e-01, best=5.911e-03, lr=5.55e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=2.330e-02, best=5.911e-03, lr=5.27e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=5.040e-01, best=5.911e-03, lr=5.01e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.51it/s, loss=3.063e-03, best=3.063e-03, lr=6.01e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.89it/s, loss=3.063e-03, best=3.063e-03, lr=6.01e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.89it/s, loss=5.981e-01, best=3.063e-03, lr=5.71e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.89it/s, loss=2.700e-02, best=3.063e-03, lr=5.43e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.89it/s, loss=5.156e-01, best=3.063e-03, lr=5.15e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.89it/s, loss=1.336e-04, best=1.336e-04, lr=6.18e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.89it/s, loss=6.184e-01, best=1.336e-04, lr=5.88e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.89it/s, loss=3.079e-02, best=1.336e-04, lr=5.58e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.89it/s, loss=5.274e-01, best=1.336e-04, lr=5.30e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.89it/s, loss=2.882e-03, best=1.336e-04, lr=5.04e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.89it/s, loss=5.009e-01, best=1.336e-04, lr=4.79e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.89it/s, loss=2.231e-02, best=1.336e-04, lr=4.55e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.89it/s, loss=4.323e-01, best=1.336e-04, lr=4.32e-01, worse_count=7]
                                                                                                                                       
(104/208) Skipping tensor: layers.22.adaLN_modulation.0.weight (Reason: In high-precision list)
(105/208) Processing tensor: layers.22.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.726e+00, best=1.726e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.717e+00, best=1.717e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.706e+00, best=1.706e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.694e+00, best=1.694e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.680e+00, best=1.680e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.665e+00, best=1.665e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.647e+00, best=1.647e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.627e+00, best=1.627e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.604e+00, best=1.604e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.577e+00, best=1.577e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.547e+00, best=1.547e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.513e+00, best=1.513e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.474e+00, best=1.474e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.429e+00, best=1.429e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.379e+00, best=1.379e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.321e+00, best=1.321e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.255e+00, best=1.255e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.180e+00, best=1.180e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.094e+00, best=1.094e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.967e-01, best=9.967e-01, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.854e-01, best=8.854e-01, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.585e-01, best=7.585e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.138e-01, best=6.138e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.489e-01, best=4.489e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.609e-01, best=2.609e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.664e-02, best=4.664e-02, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.977e-01, best=4.664e-02, lr=2.20e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.282e-02, best=2.282e-02, lr=2.51e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.285e-01, best=2.282e-02, lr=2.27e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.689e-03, best=1.689e-03, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.569e-01, best=1.689e-03, lr=2.33e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.353e-02, best=1.689e-03, lr=2.11e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.871e-01, best=1.689e-03, lr=1.90e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.989e-03, best=1.689e-03, lr=1.72e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.686e-01, best=1.689e-03, lr=1.55e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.374e-02, best=1.689e-03, lr=1.40e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.260e-01, best=1.689e-03, lr=1.26e-01, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.145e-04, best=1.145e-04, lr=1.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.437e-01, best=1.145e-04, lr=1.30e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.390e-02, best=1.145e-04, lr=1.17e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.032e-01, best=1.145e-04, lr=1.06e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.486e-03, best=1.145e-04, lr=9.54e-02, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.290e-02, best=1.145e-04, lr=8.61e-02, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.814e-03, best=1.145e-04, lr=7.77e-02, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.088e-02, best=1.145e-04, lr=7.01e-02, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.608e-04, best=1.145e-04, lr=6.33e-02, worse_count=8]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 458.71it/s, loss=7.608e-04, best=1.145e-04, lr=6.33e-02, worse_count=8]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 458.71it/s, loss=6.252e-02, best=1.145e-04, lr=5.71e-02, worse_count=9]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 458.71it/s, loss=5.409e-03, best=1.145e-04, lr=5.15e-02, worse_count=10]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 458.71it/s, loss=4.613e-02, best=1.145e-04, lr=4.65e-02, worse_count=11]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 458.71it/s, loss=3.837e-04, best=1.145e-04, lr=4.20e-02, worse_count=12]
                                                                                                                                        
(106/208) Processing tensor: layers.22.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.031e+00, best=2.031e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.022e+00, best=2.022e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.010e+00, best=2.010e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.996e+00, best=1.996e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.979e+00, best=1.979e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.959e+00, best=1.959e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.935e+00, best=1.935e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.906e+00, best=1.906e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.871e+00, best=1.871e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.829e+00, best=1.829e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.779e+00, best=1.779e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.719e+00, best=1.719e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.647e+00, best=1.647e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.560e+00, best=1.560e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.456e+00, best=1.456e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.331e+00, best=1.331e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.182e+00, best=1.182e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.002e+00, best=1.002e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=1.002e+00, best=1.002e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=7.862e-01, best=7.862e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=5.275e-01, best=5.275e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=2.170e-01, best=2.170e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=1.556e-01, best=1.556e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=2.915e-01, best=1.556e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=1.332e-01, best=1.332e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=3.765e-01, best=1.332e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=1.077e-01, best=1.077e-01, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=4.733e-01, best=1.077e-01, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=7.869e-02, best=7.869e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=5.837e-01, best=7.869e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=4.557e-02, best=4.557e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=7.096e-01, best=4.557e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=7.811e-03, best=7.811e-03, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=8.530e-01, best=7.811e-03, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=3.523e-02, best=7.811e-03, lr=7.77e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=7.417e-01, best=7.811e-03, lr=7.38e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=3.614e-03, best=3.614e-03, lr=8.86e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.12it/s, loss=3.614e-03, best=3.614e-03, lr=8.86e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.12it/s, loss=8.821e-01, best=3.614e-03, lr=8.41e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.12it/s, loss=4.067e-02, best=3.614e-03, lr=7.99e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.12it/s, loss=7.587e-01, best=3.614e-03, lr=7.59e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.12it/s, loss=7.040e-04, best=7.040e-04, lr=9.11e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.12it/s, loss=9.105e-01, best=7.040e-04, lr=8.66e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.12it/s, loss=4.486e-02, best=7.040e-04, lr=8.22e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.12it/s, loss=7.775e-01, best=7.040e-04, lr=7.81e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.12it/s, loss=3.738e-03, best=7.040e-04, lr=7.42e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.12it/s, loss=7.385e-01, best=7.040e-04, lr=7.05e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.12it/s, loss=3.337e-02, best=7.040e-04, lr=6.70e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.12it/s, loss=6.365e-01, best=7.040e-04, lr=6.36e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.12it/s, loss=1.228e-04, best=1.228e-04, lr=7.64e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.12it/s, loss=7.635e-01, best=1.228e-04, lr=7.25e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.12it/s, loss=3.806e-02, best=1.228e-04, lr=6.89e-01, worse_count=2]
                                                                                                                                       
(107/208) Processing tensor: layers.22.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.278e+00, best=2.278e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.268e+00, best=2.268e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.256e+00, best=2.256e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.242e+00, best=2.242e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.225e+00, best=2.225e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.205e+00, best=2.205e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.181e+00, best=2.181e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.152e+00, best=2.152e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.117e+00, best=2.117e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.075e+00, best=2.075e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.025e+00, best=2.025e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.965e+00, best=1.965e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.893e+00, best=1.893e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.806e+00, best=1.806e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.702e+00, best=1.702e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.577e+00, best=1.577e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.428e+00, best=1.428e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.248e+00, best=1.248e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.032e+00, best=1.032e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=1.032e+00, best=1.032e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=7.737e-01, best=7.737e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=4.632e-01, best=4.632e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=9.064e-02, best=9.064e-02, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=3.564e-01, best=9.064e-02, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=6.829e-02, best=6.829e-02, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=4.414e-01, best=6.829e-02, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=4.281e-02, best=4.281e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=5.382e-01, best=4.281e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=1.375e-02, best=1.375e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=6.486e-01, best=1.375e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=1.937e-02, best=1.375e-02, lr=5.98e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=5.784e-01, best=1.375e-02, lr=5.68e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=1.052e-02, best=1.052e-02, lr=6.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=6.710e-01, best=1.052e-02, lr=6.47e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=2.355e-02, best=1.052e-02, lr=6.15e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=5.915e-01, best=1.052e-02, lr=5.84e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=7.202e-03, best=7.202e-03, lr=7.01e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=6.940e-01, best=7.202e-03, lr=6.66e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=2.786e-02, best=7.202e-03, lr=6.33e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.06it/s, loss=6.049e-01, best=7.202e-03, lr=6.01e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.87it/s, loss=6.049e-01, best=7.202e-03, lr=6.01e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.87it/s, loss=3.784e-03, best=3.784e-03, lr=7.21e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.87it/s, loss=7.176e-01, best=3.784e-03, lr=6.85e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.87it/s, loss=3.229e-02, best=3.784e-03, lr=6.51e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.87it/s, loss=6.188e-01, best=3.784e-03, lr=6.18e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.87it/s, loss=2.683e-04, best=2.683e-04, lr=7.42e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.87it/s, loss=7.419e-01, best=2.683e-04, lr=7.05e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.87it/s, loss=3.684e-02, best=2.683e-04, lr=6.70e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.87it/s, loss=6.330e-01, best=2.683e-04, lr=6.36e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.87it/s, loss=3.350e-03, best=2.683e-04, lr=6.04e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.87it/s, loss=6.012e-01, best=2.683e-04, lr=5.74e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.87it/s, loss=2.688e-02, best=2.683e-04, lr=5.46e-01, worse_count=6]
                                                                                                                                       
(108/208) Processing tensor: layers.22.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.041e+00, best=2.041e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.031e+00, best=2.031e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.020e+00, best=2.020e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.006e+00, best=2.006e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.989e+00, best=1.989e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.969e+00, best=1.969e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.945e+00, best=1.945e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.915e+00, best=1.915e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.881e+00, best=1.881e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.839e+00, best=1.839e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.789e+00, best=1.789e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.729e+00, best=1.729e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.656e+00, best=1.656e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.570e+00, best=1.570e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.466e+00, best=1.466e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.341e+00, best=1.341e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.191e+00, best=1.191e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.012e+00, best=1.012e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=1.012e+00, best=1.012e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=7.959e-01, best=7.959e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=5.372e-01, best=5.372e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=2.267e-01, best=2.267e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=1.458e-01, best=1.458e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=3.012e-01, best=1.458e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=1.235e-01, best=1.235e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=3.862e-01, best=1.235e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=9.800e-02, best=9.800e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=4.830e-01, best=9.800e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=6.895e-02, best=6.895e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=5.934e-01, best=6.895e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=3.583e-02, best=3.583e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=7.193e-01, best=3.583e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=1.925e-03, best=1.925e-03, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=8.589e-01, best=1.925e-03, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=4.112e-02, best=1.925e-03, lr=7.77e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=7.358e-01, best=1.925e-03, lr=7.38e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=2.272e-03, best=1.925e-03, lr=7.01e-01, worse_count=4]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.57it/s, loss=6.989e-01, best=1.925e-03, lr=6.66e-01, worse_count=5]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 182.24it/s, loss=6.989e-01, best=1.925e-03, lr=6.66e-01, worse_count=5]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 182.24it/s, loss=3.279e-02, best=1.925e-03, lr=6.33e-01, worse_count=6]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 182.24it/s, loss=6.000e-01, best=1.925e-03, lr=6.01e-01, worse_count=7]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 182.24it/s, loss=1.146e-03, best=1.146e-03, lr=7.21e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 182.24it/s, loss=7.202e-01, best=1.146e-03, lr=6.85e-01, worse_count=1]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 182.24it/s, loss=3.492e-02, best=1.146e-03, lr=6.51e-01, worse_count=2]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 182.24it/s, loss=6.161e-01, best=1.146e-03, lr=6.18e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 182.24it/s, loss=2.371e-03, best=1.146e-03, lr=5.88e-01, worse_count=4]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 182.24it/s, loss=5.852e-01, best=1.146e-03, lr=5.58e-01, worse_count=5]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 182.24it/s, loss=2.701e-02, best=1.146e-03, lr=5.30e-01, worse_count=6]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 182.24it/s, loss=5.033e-01, best=1.146e-03, lr=5.04e-01, worse_count=7]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 182.24it/s, loss=4.943e-04, best=4.943e-04, lr=6.04e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 182.24it/s, loss=6.040e-01, best=4.943e-04, lr=5.74e-01, worse_count=1]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 182.24it/s, loss=2.973e-02, best=4.943e-04, lr=5.46e-01, worse_count=2]
                                                                                                                                       
(109/208) Processing tensor: layers.22.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.160e+00, best=2.160e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.150e+00, best=2.150e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.138e+00, best=2.138e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.124e+00, best=2.124e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.107e+00, best=2.107e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.087e+00, best=2.087e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.063e+00, best=2.063e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.034e+00, best=2.034e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.999e+00, best=1.999e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.957e+00, best=1.957e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.907e+00, best=1.907e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.847e+00, best=1.847e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.775e+00, best=1.775e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.688e+00, best=1.688e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.584e+00, best=1.584e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.459e+00, best=1.459e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.310e+00, best=1.310e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.130e+00, best=1.130e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.144e-01, best=9.144e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.557e-01, best=6.557e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=6.557e-01, best=6.557e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=3.452e-01, best=3.452e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=2.738e-02, best=2.738e-02, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=4.197e-01, best=2.738e-02, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=5.026e-03, best=5.026e-03, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=5.047e-01, best=5.026e-03, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=2.046e-02, best=5.026e-03, lr=4.60e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=4.395e-01, best=5.026e-03, lr=4.37e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=2.542e-03, best=2.542e-03, lr=5.24e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=5.219e-01, best=2.542e-03, lr=4.98e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=2.368e-02, best=2.542e-03, lr=4.73e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=4.496e-01, best=2.542e-03, lr=4.50e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=2.529e-05, best=2.529e-05, lr=5.39e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=5.395e-01, best=2.529e-05, lr=5.13e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=2.695e-02, best=2.529e-05, lr=4.87e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=4.600e-01, best=2.529e-05, lr=4.63e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=2.605e-03, best=2.529e-05, lr=4.39e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=4.368e-01, best=2.529e-05, lr=4.17e-01, worse_count=5]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=1.937e-02, best=2.529e-05, lr=3.97e-01, worse_count=6]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=3.772e-01, best=2.529e-05, lr=3.77e-01, worse_count=7]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.89it/s, loss=4.640e-04, best=2.529e-05, lr=3.58e-01, worse_count=8]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.30it/s, loss=4.640e-04, best=2.529e-05, lr=3.58e-01, worse_count=8]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.30it/s, loss=3.575e-01, best=2.529e-05, lr=3.40e-01, worse_count=9]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.30it/s, loss=1.743e-02, best=2.529e-05, lr=3.23e-01, worse_count=10]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.30it/s, loss=3.056e-01, best=2.529e-05, lr=3.07e-01, worse_count=11]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.30it/s, loss=1.281e-03, best=2.529e-05, lr=2.92e-01, worse_count=12]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.30it/s, loss=2.903e-01, best=2.529e-05, lr=2.77e-01, worse_count=13]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.30it/s, loss=1.330e-02, best=2.529e-05, lr=2.63e-01, worse_count=14]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.30it/s, loss=2.498e-01, best=2.529e-05, lr=2.50e-01, worse_count=15]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.30it/s, loss=1.416e-04, best=2.529e-05, lr=2.37e-01, worse_count=16]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.30it/s, loss=2.373e-01, best=2.529e-05, lr=2.26e-01, worse_count=17]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.30it/s, loss=1.173e-02, best=2.529e-05, lr=2.14e-01, worse_count=18]
                                                                                                                                        
(110/208) Skipping tensor: layers.23.adaLN_modulation.0.weight (Reason: In high-precision list)
(111/208) Processing tensor: layers.23.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.803e+00, best=1.803e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.794e+00, best=1.794e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.783e+00, best=1.783e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.771e+00, best=1.771e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.758e+00, best=1.758e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.742e+00, best=1.742e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.724e+00, best=1.724e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.704e+00, best=1.704e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.681e+00, best=1.681e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.655e+00, best=1.655e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.625e+00, best=1.625e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.590e+00, best=1.590e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.551e+00, best=1.551e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.507e+00, best=1.507e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.456e+00, best=1.456e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.398e+00, best=1.398e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.333e+00, best=1.333e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.257e+00, best=1.257e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.172e+00, best=1.172e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.074e+00, best=1.074e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.629e-01, best=9.629e-01, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.360e-01, best=8.360e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.913e-01, best=6.913e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.264e-01, best=5.264e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.384e-01, best=3.384e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.241e-01, best=1.241e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.202e-01, best=1.202e-01, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.583e-01, best=1.202e-01, lr=2.51e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.302e-02, best=9.302e-02, lr=2.87e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.935e-01, best=9.302e-02, lr=2.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.509e-02, best=6.509e-02, lr=2.95e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.297e-01, best=6.509e-02, lr=2.66e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.634e-02, best=3.634e-02, lr=3.03e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.670e-01, best=3.634e-02, lr=2.74e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.768e-03, best=6.768e-03, lr=3.12e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.053e-01, best=6.768e-03, lr=2.82e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.366e-02, best=6.768e-03, lr=2.54e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.305e-01, best=6.768e-03, lr=2.29e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.124e-03, best=1.124e-03, lr=2.61e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.604e-01, best=1.124e-03, lr=2.36e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.437e-02, best=1.124e-03, lr=2.13e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.886e-01, best=1.124e-03, lr=1.92e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.605e-03, best=1.124e-03, lr=1.73e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.699e-01, best=1.124e-03, lr=1.57e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.331e-02, best=1.124e-03, lr=1.41e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.280e-01, best=1.124e-03, lr=1.28e-01, worse_count=7]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 449.71it/s, loss=1.280e-01, best=1.124e-03, lr=1.28e-01, worse_count=7]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 449.71it/s, loss=4.676e-04, best=4.676e-04, lr=1.45e-01, worse_count=0]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 449.71it/s, loss=1.449e-01, best=4.676e-04, lr=1.31e-01, worse_count=1]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 449.71it/s, loss=1.371e-02, best=4.676e-04, lr=1.18e-01, worse_count=2]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 449.71it/s, loss=1.047e-01, best=4.676e-04, lr=1.07e-01, worse_count=3]
                                                                                                                                       
(112/208) Processing tensor: layers.23.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.883e+00, best=1.883e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.873e+00, best=1.873e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.862e+00, best=1.862e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.848e+00, best=1.848e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.831e+00, best=1.831e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.811e+00, best=1.811e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.787e+00, best=1.787e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.757e+00, best=1.757e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.723e+00, best=1.723e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.681e+00, best=1.681e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.631e+00, best=1.631e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.571e+00, best=1.571e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.498e+00, best=1.498e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.412e+00, best=1.412e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.308e+00, best=1.308e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.183e+00, best=1.183e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.033e+00, best=1.033e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.535e-01, best=8.535e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=8.535e-01, best=8.535e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=6.379e-01, best=6.379e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=3.792e-01, best=3.792e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=6.871e-02, best=6.871e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=3.039e-01, best=6.871e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=5.008e-02, best=5.008e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=3.747e-01, best=5.008e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=2.884e-02, best=2.884e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=4.554e-01, best=2.884e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=4.634e-03, best=4.634e-03, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=5.474e-01, best=4.634e-03, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=2.297e-02, best=4.634e-03, lr=4.98e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=4.752e-01, best=4.634e-03, lr=4.73e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=1.943e-03, best=1.943e-03, lr=5.68e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=5.660e-01, best=1.943e-03, lr=5.39e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=2.645e-02, best=1.943e-03, lr=5.13e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=4.861e-01, best=1.943e-03, lr=4.87e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=8.255e-04, best=8.255e-04, lr=5.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 174.31it/s, loss=5.835e-01, best=8.255e-04, lr=5.55e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.16it/s, loss=5.835e-01, best=8.255e-04, lr=5.55e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.16it/s, loss=2.839e-02, best=8.255e-04, lr=5.27e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.16it/s, loss=4.989e-01, best=8.255e-04, lr=5.01e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.16it/s, loss=2.023e-03, best=8.255e-04, lr=4.76e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.16it/s, loss=4.739e-01, best=8.255e-04, lr=4.52e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.16it/s, loss=2.177e-02, best=8.255e-04, lr=4.29e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.16it/s, loss=4.077e-01, best=8.255e-04, lr=4.08e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.16it/s, loss=2.976e-04, best=2.976e-04, lr=4.90e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.16it/s, loss=4.894e-01, best=2.976e-04, lr=4.65e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.16it/s, loss=2.418e-02, best=2.976e-04, lr=4.42e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.16it/s, loss=4.177e-01, best=2.976e-04, lr=4.20e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.16it/s, loss=2.090e-03, best=2.976e-04, lr=3.99e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.16it/s, loss=3.967e-01, best=2.976e-04, lr=3.79e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.16it/s, loss=1.785e-02, best=2.976e-04, lr=3.60e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.16it/s, loss=3.421e-01, best=2.976e-04, lr=3.42e-01, worse_count=7]
                                                                                                                                       
(113/208) Processing tensor: layers.23.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.328e+00, best=2.328e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.318e+00, best=2.318e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.307e+00, best=2.307e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.293e+00, best=2.293e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.276e+00, best=2.276e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.256e+00, best=2.256e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.232e+00, best=2.232e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.203e+00, best=2.203e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.168e+00, best=2.168e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.126e+00, best=2.126e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.076e+00, best=2.076e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.016e+00, best=2.016e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.943e+00, best=1.943e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.857e+00, best=1.857e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.753e+00, best=1.753e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.628e+00, best=1.628e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.478e+00, best=1.478e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.299e+00, best=1.299e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.083e+00, best=1.083e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=1.083e+00, best=1.083e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=8.243e-01, best=8.243e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=5.138e-01, best=5.138e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=1.412e-01, best=1.412e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=3.058e-01, best=1.412e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=1.189e-01, best=1.189e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=3.908e-01, best=1.189e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=9.341e-02, best=9.341e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=4.876e-01, best=9.341e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=6.436e-02, best=6.436e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=5.980e-01, best=6.436e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=3.124e-02, best=3.124e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=7.239e-01, best=3.124e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=6.518e-03, best=6.518e-03, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=8.543e-01, best=6.518e-03, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=3.652e-02, best=6.518e-03, lr=7.77e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=7.404e-01, best=6.518e-03, lr=7.38e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=2.322e-03, best=2.322e-03, lr=8.86e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=8.834e-01, best=2.322e-03, lr=8.41e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=4.196e-02, best=2.322e-03, lr=7.99e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.89it/s, loss=7.574e-01, best=2.322e-03, lr=7.59e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.01it/s, loss=7.574e-01, best=2.322e-03, lr=7.59e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.01it/s, loss=1.996e-03, best=1.996e-03, lr=9.11e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.01it/s, loss=9.092e-01, best=1.996e-03, lr=8.66e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.01it/s, loss=4.357e-02, best=1.996e-03, lr=8.22e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.01it/s, loss=7.788e-01, best=1.996e-03, lr=7.81e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.01it/s, loss=2.446e-03, best=1.996e-03, lr=7.42e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.01it/s, loss=7.398e-01, best=1.996e-03, lr=7.05e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.01it/s, loss=3.466e-02, best=1.996e-03, lr=6.70e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.01it/s, loss=6.352e-01, best=1.996e-03, lr=6.36e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.01it/s, loss=1.172e-03, best=1.172e-03, lr=7.64e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.01it/s, loss=7.624e-01, best=1.172e-03, lr=7.25e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.01it/s, loss=3.701e-02, best=1.172e-03, lr=6.89e-01, worse_count=2]
                                                                                                                                       
(114/208) Processing tensor: layers.23.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.840e+00, best=1.840e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.830e+00, best=1.830e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.818e+00, best=1.818e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.804e+00, best=1.804e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.788e+00, best=1.788e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.767e+00, best=1.767e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.743e+00, best=1.743e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.714e+00, best=1.714e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.679e+00, best=1.679e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.638e+00, best=1.638e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.587e+00, best=1.587e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.527e+00, best=1.527e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.455e+00, best=1.455e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.368e+00, best=1.368e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.264e+00, best=1.264e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.140e+00, best=1.140e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.899e-01, best=9.899e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.102e-01, best=8.102e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.946e-01, best=5.946e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=5.946e-01, best=5.946e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=3.359e-01, best=3.359e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=2.541e-02, best=2.541e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=3.472e-01, best=2.541e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=6.786e-03, best=6.786e-03, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=4.180e-01, best=6.786e-03, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=1.445e-02, best=6.786e-03, lr=3.83e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=3.689e-01, best=6.786e-03, lr=3.64e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=4.715e-03, best=4.715e-03, lr=4.37e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=4.323e-01, best=4.715e-03, lr=4.15e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=1.713e-02, best=4.715e-03, lr=3.94e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=3.772e-01, best=4.715e-03, lr=3.75e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=2.585e-03, best=2.585e-03, lr=4.50e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=4.470e-01, best=2.585e-03, lr=4.27e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=1.990e-02, best=2.585e-03, lr=4.06e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=3.859e-01, best=2.585e-03, lr=3.85e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=3.932e-04, best=3.932e-04, lr=4.63e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=4.622e-01, best=3.932e-04, lr=4.39e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=2.274e-02, best=3.932e-04, lr=4.17e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=3.947e-01, best=3.932e-04, lr=3.97e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.29it/s, loss=1.862e-03, best=3.932e-04, lr=3.77e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 186.47it/s, loss=1.862e-03, best=3.932e-04, lr=3.77e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 186.47it/s, loss=3.749e-01, best=3.932e-04, lr=3.58e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 186.47it/s, loss=1.698e-02, best=3.932e-04, lr=3.40e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 186.47it/s, loss=3.231e-01, best=3.932e-04, lr=3.23e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 186.47it/s, loss=2.943e-05, best=2.943e-05, lr=3.88e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 186.47it/s, loss=3.876e-01, best=2.943e-05, lr=3.68e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 186.47it/s, loss=1.935e-02, best=2.943e-05, lr=3.50e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 186.47it/s, loss=3.305e-01, best=2.943e-05, lr=3.32e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 186.47it/s, loss=1.860e-03, best=2.943e-05, lr=3.16e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 186.47it/s, loss=3.139e-01, best=2.943e-05, lr=3.00e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 186.47it/s, loss=1.393e-02, best=2.943e-05, lr=2.85e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 186.47it/s, loss=2.710e-01, best=2.943e-05, lr=2.71e-01, worse_count=7]
                                                                                                                                       
(115/208) Processing tensor: layers.23.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.913e+00, best=1.913e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.903e+00, best=1.903e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.892e+00, best=1.892e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.878e+00, best=1.878e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.861e+00, best=1.861e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.841e+00, best=1.841e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.816e+00, best=1.816e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.787e+00, best=1.787e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.753e+00, best=1.753e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.711e+00, best=1.711e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.661e+00, best=1.661e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.600e+00, best=1.600e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.528e+00, best=1.528e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.442e+00, best=1.442e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.338e+00, best=1.338e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.213e+00, best=1.213e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.063e+00, best=1.063e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.835e-01, best=8.835e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.678e-01, best=6.678e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.091e-01, best=4.091e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=4.091e-01, best=4.091e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=9.863e-02, best=9.863e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=2.740e-01, best=9.863e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=8.000e-02, best=8.000e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=3.447e-01, best=8.000e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=5.876e-02, best=5.876e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=4.254e-01, best=5.876e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=3.455e-02, best=3.455e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=5.174e-01, best=3.455e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=6.953e-03, best=6.953e-03, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=6.223e-01, best=6.953e-03, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=2.451e-02, best=6.953e-03, lr=5.68e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=5.434e-01, best=6.953e-03, lr=5.39e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=3.885e-03, best=3.885e-03, lr=6.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=6.435e-01, best=3.885e-03, lr=6.15e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=2.849e-02, best=3.885e-03, lr=5.84e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=5.558e-01, best=3.885e-03, lr=5.55e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=7.296e-04, best=7.296e-04, lr=6.66e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=6.654e-01, best=7.296e-04, lr=6.33e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=3.258e-02, best=7.296e-04, lr=6.01e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.96it/s, loss=5.686e-01, best=7.296e-04, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.18it/s, loss=5.686e-01, best=7.296e-04, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.18it/s, loss=2.518e-03, best=7.296e-04, lr=5.43e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.18it/s, loss=5.400e-01, best=7.296e-04, lr=5.15e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.18it/s, loss=2.461e-02, best=7.296e-04, lr=4.90e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.18it/s, loss=4.650e-01, best=7.296e-04, lr=4.65e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.18it/s, loss=1.286e-04, best=1.286e-04, lr=5.58e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.18it/s, loss=5.581e-01, best=1.286e-04, lr=5.30e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.18it/s, loss=2.778e-02, best=1.286e-04, lr=5.04e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.18it/s, loss=4.760e-01, best=1.286e-04, lr=4.79e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.18it/s, loss=2.593e-03, best=1.286e-04, lr=4.55e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.18it/s, loss=4.521e-01, best=1.286e-04, lr=4.32e-01, worse_count=5]
                                                                                                                                       
(116/208) Skipping tensor: layers.24.adaLN_modulation.0.weight (Reason: In high-precision list)
(117/208) Processing tensor: layers.24.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.711e+00, best=1.711e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.702e+00, best=1.702e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.692e+00, best=1.692e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.680e+00, best=1.680e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.666e+00, best=1.666e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.650e+00, best=1.650e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.633e+00, best=1.633e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.612e+00, best=1.612e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.589e+00, best=1.589e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.563e+00, best=1.563e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.533e+00, best=1.533e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.499e+00, best=1.499e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.460e+00, best=1.460e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.415e+00, best=1.415e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.364e+00, best=1.364e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.307e+00, best=1.307e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.241e+00, best=1.241e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.166e+00, best=1.166e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.080e+00, best=1.080e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.824e-01, best=9.824e-01, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.711e-01, best=8.711e-01, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.442e-01, best=7.442e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.995e-01, best=5.995e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.346e-01, best=4.346e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.466e-01, best=2.466e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.233e-02, best=3.233e-02, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.120e-01, best=3.233e-02, lr=2.20e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.510e-03, best=8.510e-03, lr=2.51e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.428e-01, best=8.510e-03, lr=2.27e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.600e-02, best=8.510e-03, lr=2.05e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.887e-01, best=8.510e-03, lr=1.85e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.964e-03, best=3.964e-03, lr=2.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.067e-01, best=3.964e-03, lr=1.90e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.657e-02, best=3.964e-03, lr=1.72e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.550e-01, best=3.964e-03, lr=1.55e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.545e-04, best=1.545e-04, lr=1.77e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.764e-01, best=1.545e-04, lr=1.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.706e-02, best=1.545e-04, lr=1.44e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.267e-01, best=1.545e-04, lr=1.30e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.038e-03, best=1.545e-04, lr=1.17e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.141e-01, best=1.545e-04, lr=1.06e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.380e-03, best=1.545e-04, lr=9.54e-02, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.700e-02, best=1.545e-04, lr=8.61e-02, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.201e-04, best=1.545e-04, lr=7.77e-02, worse_count=8]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.677e-02, best=1.545e-04, lr=7.01e-02, worse_count=9]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 448.44it/s, loss=7.677e-02, best=1.545e-04, lr=7.01e-02, worse_count=9]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 448.44it/s, loss=6.655e-03, best=1.545e-04, lr=6.33e-02, worse_count=10]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 448.44it/s, loss=5.662e-02, best=1.545e-04, lr=5.71e-02, worse_count=11]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 448.44it/s, loss=4.850e-04, best=1.545e-04, lr=5.15e-02, worse_count=12]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 448.44it/s, loss=5.106e-02, best=1.545e-04, lr=4.65e-02, worse_count=13]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 448.44it/s, loss=4.540e-03, best=1.545e-04, lr=4.20e-02, worse_count=14]
                                                                                                                                        
(118/208) Processing tensor: layers.24.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.945e+00, best=1.945e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.935e+00, best=1.935e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.923e+00, best=1.923e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.909e+00, best=1.909e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.892e+00, best=1.892e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.872e+00, best=1.872e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.848e+00, best=1.848e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.819e+00, best=1.819e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.784e+00, best=1.784e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.742e+00, best=1.742e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.692e+00, best=1.692e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.632e+00, best=1.632e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.560e+00, best=1.560e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.473e+00, best=1.473e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.369e+00, best=1.369e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.245e+00, best=1.245e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.095e+00, best=1.095e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.151e-01, best=9.151e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=9.151e-01, best=9.151e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=6.995e-01, best=6.995e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=4.408e-01, best=4.408e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=1.303e-01, best=1.303e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=2.423e-01, best=1.303e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=1.117e-01, best=1.117e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=3.131e-01, best=1.117e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=9.041e-02, best=9.041e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=3.938e-01, best=9.041e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=6.620e-02, best=6.620e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=4.858e-01, best=6.620e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=3.860e-02, best=3.860e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=5.907e-01, best=3.860e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=7.140e-03, best=7.140e-03, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=7.102e-01, best=7.140e-03, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=2.873e-02, best=7.140e-03, lr=6.47e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=6.187e-01, best=7.140e-03, lr=6.15e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=3.643e-03, best=3.643e-03, lr=7.38e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.78it/s, loss=7.344e-01, best=3.643e-03, lr=7.01e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.73it/s, loss=7.344e-01, best=3.643e-03, lr=7.01e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.73it/s, loss=3.326e-02, best=3.643e-03, lr=6.66e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.73it/s, loss=6.328e-01, best=3.643e-03, lr=6.33e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.73it/s, loss=5.241e-05, best=5.241e-05, lr=7.59e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.73it/s, loss=7.593e-01, best=5.241e-05, lr=7.21e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.73it/s, loss=3.791e-02, best=5.241e-05, lr=6.85e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.73it/s, loss=6.474e-01, best=5.241e-05, lr=6.51e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.73it/s, loss=3.650e-03, best=5.241e-05, lr=6.18e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.73it/s, loss=6.148e-01, best=5.241e-05, lr=5.88e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.73it/s, loss=2.727e-02, best=5.241e-05, lr=5.58e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.73it/s, loss=5.309e-01, best=5.241e-05, lr=5.30e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.73it/s, loss=6.350e-04, best=5.241e-05, lr=5.04e-01, worse_count=8]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.73it/s, loss=5.031e-01, best=5.241e-05, lr=4.79e-01, worse_count=9]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.73it/s, loss=2.455e-02, best=5.241e-05, lr=4.55e-01, worse_count=10]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.73it/s, loss=4.301e-01, best=5.241e-05, lr=4.32e-01, worse_count=11]
                                                                                                                                        
(119/208) Processing tensor: layers.24.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.472e+00, best=2.472e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.462e+00, best=2.462e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.450e+00, best=2.450e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.436e+00, best=2.436e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.420e+00, best=2.420e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.399e+00, best=2.399e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.375e+00, best=2.375e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.346e+00, best=2.346e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.311e+00, best=2.311e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.270e+00, best=2.270e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.219e+00, best=2.219e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.159e+00, best=2.159e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.087e+00, best=2.087e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.000e+00, best=2.000e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.896e+00, best=1.896e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.772e+00, best=1.772e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.622e+00, best=1.622e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.442e+00, best=1.442e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.227e+00, best=1.227e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.680e-01, best=9.680e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=9.680e-01, best=9.680e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=6.575e-01, best=6.575e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=2.849e-01, best=2.849e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=1.622e-01, best=1.622e-01, lr=5.36e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=3.743e-01, best=1.622e-01, lr=5.10e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=1.354e-01, best=1.354e-01, lr=6.12e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=4.763e-01, best=1.354e-01, lr=5.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=1.048e-01, best=1.048e-01, lr=6.97e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=5.925e-01, best=1.048e-01, lr=6.62e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=6.993e-02, best=6.993e-02, lr=7.95e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=7.249e-01, best=6.993e-02, lr=7.55e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=3.018e-02, best=3.018e-02, lr=9.06e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=8.760e-01, best=3.018e-02, lr=8.61e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=1.512e-02, best=1.512e-02, lr=1.03e+00, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=1.018e+00, best=1.512e-02, lr=9.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=3.653e-02, best=1.512e-02, lr=9.32e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=8.958e-01, best=1.512e-02, lr=8.86e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=1.009e-02, best=1.009e-02, lr=1.06e+00, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=1.053e+00, best=1.009e-02, lr=1.01e+00, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=4.305e-02, best=1.009e-02, lr=9.59e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.35it/s, loss=9.161e-01, best=1.009e-02, lr=9.11e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=9.161e-01, best=1.009e-02, lr=9.11e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=4.908e-03, best=4.908e-03, lr=1.09e+00, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=1.089e+00, best=4.908e-03, lr=1.04e+00, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=4.977e-02, best=4.908e-03, lr=9.87e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=9.371e-01, best=4.908e-03, lr=9.37e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=4.243e-04, best=4.243e-04, lr=1.12e+00, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=1.125e+00, best=4.243e-04, lr=1.07e+00, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=5.583e-02, best=4.243e-04, lr=1.02e+00, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=9.595e-01, best=4.243e-04, lr=9.64e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=5.060e-03, best=4.243e-04, lr=9.16e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.17it/s, loss=9.113e-01, best=4.243e-04, lr=8.70e-01, worse_count=5]
                                                                                                                                       
(120/208) Processing tensor: layers.24.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.687e+00, best=1.687e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.677e+00, best=1.677e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.665e+00, best=1.665e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.651e+00, best=1.651e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.635e+00, best=1.635e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.614e+00, best=1.614e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.590e+00, best=1.590e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.561e+00, best=1.561e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.526e+00, best=1.526e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.485e+00, best=1.485e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.435e+00, best=1.435e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.374e+00, best=1.374e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.302e+00, best=1.302e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.215e+00, best=1.215e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.112e+00, best=1.112e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.867e-01, best=9.867e-01, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.370e-01, best=8.370e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.573e-01, best=6.573e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.417e-01, best=4.417e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=4.417e-01, best=4.417e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=1.830e-01, best=1.830e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=1.275e-01, best=1.275e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=2.451e-01, best=1.275e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=1.089e-01, best=1.089e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=3.159e-01, best=1.089e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=8.764e-02, best=8.764e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=3.966e-01, best=8.764e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=6.343e-02, best=6.343e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=4.886e-01, best=6.343e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=3.583e-02, best=3.583e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=5.934e-01, best=3.583e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=4.365e-03, best=4.365e-03, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=7.130e-01, best=4.365e-03, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=3.150e-02, best=4.365e-03, lr=6.47e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=6.159e-01, best=4.365e-03, lr=6.15e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=8.678e-04, best=8.678e-04, lr=7.38e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=7.372e-01, best=8.678e-04, lr=7.01e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=3.604e-02, best=8.678e-04, lr=6.66e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=6.301e-01, best=8.678e-04, lr=6.33e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.29it/s, loss=2.730e-03, best=8.678e-04, lr=6.01e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.43it/s, loss=2.730e-03, best=8.678e-04, lr=6.01e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.43it/s, loss=5.984e-01, best=8.678e-04, lr=5.71e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.43it/s, loss=2.733e-02, best=8.678e-04, lr=5.43e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.43it/s, loss=5.152e-01, best=8.678e-04, lr=5.15e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.43it/s, loss=2.015e-04, best=2.015e-04, lr=6.18e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.43it/s, loss=6.183e-01, best=2.015e-04, lr=5.88e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.43it/s, loss=3.072e-02, best=2.015e-04, lr=5.58e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.43it/s, loss=5.275e-01, best=2.015e-04, lr=5.30e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.43it/s, loss=2.814e-03, best=2.015e-04, lr=5.04e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.43it/s, loss=5.010e-01, best=2.015e-04, lr=4.79e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.43it/s, loss=2.237e-02, best=2.015e-04, lr=4.55e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.43it/s, loss=4.323e-01, best=2.015e-04, lr=4.32e-01, worse_count=7]
                                                                                                                                       
(121/208) Processing tensor: layers.24.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.863e+00, best=1.863e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.854e+00, best=1.854e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.842e+00, best=1.842e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.828e+00, best=1.828e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.811e+00, best=1.811e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.791e+00, best=1.791e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.767e+00, best=1.767e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.738e+00, best=1.738e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.703e+00, best=1.703e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.661e+00, best=1.661e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.611e+00, best=1.611e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.551e+00, best=1.551e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.479e+00, best=1.479e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.392e+00, best=1.392e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.288e+00, best=1.288e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.163e+00, best=1.163e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.013e+00, best=1.013e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.338e-01, best=8.338e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.182e-01, best=6.182e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.594e-01, best=3.594e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=3.594e-01, best=3.594e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=4.896e-02, best=4.896e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=3.236e-01, best=4.896e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=3.033e-02, best=3.033e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=3.944e-01, best=3.033e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=9.095e-03, best=9.095e-03, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=4.751e-01, best=9.095e-03, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=1.511e-02, best=9.095e-03, lr=4.37e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=4.219e-01, best=9.095e-03, lr=4.15e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=6.735e-03, best=6.735e-03, lr=4.98e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=4.914e-01, best=6.735e-03, lr=4.73e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=1.817e-02, best=6.735e-03, lr=4.50e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=4.314e-01, best=6.735e-03, lr=4.27e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=4.306e-03, best=4.306e-03, lr=5.13e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=5.082e-01, best=4.306e-03, lr=4.87e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=2.132e-02, best=4.306e-03, lr=4.63e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=4.413e-01, best=4.306e-03, lr=4.39e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=1.808e-03, best=1.808e-03, lr=5.27e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=5.255e-01, best=1.808e-03, lr=5.01e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=2.456e-02, best=1.808e-03, lr=4.76e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.48it/s, loss=4.514e-01, best=1.808e-03, lr=4.52e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.24it/s, loss=4.514e-01, best=1.808e-03, lr=4.52e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.24it/s, loss=7.632e-04, best=7.632e-04, lr=5.43e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.24it/s, loss=5.418e-01, best=7.632e-04, lr=5.15e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.24it/s, loss=2.636e-02, best=7.632e-04, lr=4.90e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.24it/s, loss=4.633e-01, best=7.632e-04, lr=4.65e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.24it/s, loss=1.882e-03, best=7.632e-04, lr=4.42e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.24it/s, loss=4.400e-01, best=7.632e-04, lr=4.20e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.24it/s, loss=2.021e-02, best=7.632e-04, lr=3.99e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.24it/s, loss=3.786e-01, best=7.632e-04, lr=3.79e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.24it/s, loss=2.728e-04, best=2.728e-04, lr=4.55e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.24it/s, loss=4.544e-01, best=2.728e-04, lr=4.32e-01, worse_count=1]
                                                                                                                                       
(122/208) Skipping tensor: layers.25.adaLN_modulation.0.weight (Reason: In high-precision list)
(123/208) Processing tensor: layers.25.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.687e+00, best=1.687e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.677e+00, best=1.677e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.667e+00, best=1.667e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.655e+00, best=1.655e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.641e+00, best=1.641e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.626e+00, best=1.626e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.608e+00, best=1.608e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.588e+00, best=1.588e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.564e+00, best=1.564e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.538e+00, best=1.538e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.508e+00, best=1.508e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.474e+00, best=1.474e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.435e+00, best=1.435e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.390e+00, best=1.390e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.340e+00, best=1.340e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.282e+00, best=1.282e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.216e+00, best=1.216e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.141e+00, best=1.141e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.055e+00, best=1.055e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.575e-01, best=9.575e-01, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.462e-01, best=8.462e-01, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.193e-01, best=7.193e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.747e-01, best=5.747e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.098e-01, best=4.098e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.218e-01, best=2.218e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.464e-03, best=7.464e-03, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.368e-01, best=7.464e-03, lr=2.20e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.636e-02, best=7.464e-03, lr=1.99e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.826e-01, best=7.464e-03, lr=1.80e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.046e-03, best=3.046e-03, lr=2.05e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.017e-01, best=3.046e-03, lr=1.85e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.692e-02, best=3.046e-03, lr=1.67e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.498e-01, best=3.046e-03, lr=1.50e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.568e-04, best=6.568e-04, lr=1.72e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.709e-01, best=6.568e-04, lr=1.55e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.607e-02, best=6.568e-04, lr=1.40e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.237e-01, best=6.568e-04, lr=1.26e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.446e-03, best=6.568e-04, lr=1.14e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.114e-01, best=6.568e-04, lr=1.03e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.652e-03, best=6.568e-04, lr=9.27e-02, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.406e-02, best=6.568e-04, lr=8.37e-02, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.876e-04, best=3.876e-04, lr=9.54e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.500e-02, best=3.876e-04, lr=8.61e-02, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.912e-03, best=3.876e-04, lr=7.77e-02, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.878e-02, best=3.876e-04, lr=7.01e-02, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.337e-03, best=3.876e-04, lr=6.33e-02, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.194e-02, best=3.876e-04, lr=5.71e-02, worse_count=5]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 466.50it/s, loss=6.194e-02, best=3.876e-04, lr=5.71e-02, worse_count=5]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 466.50it/s, loss=4.832e-03, best=3.876e-04, lr=5.15e-02, worse_count=6]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 466.50it/s, loss=4.671e-02, best=3.876e-04, lr=4.65e-02, worse_count=7]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 466.50it/s, loss=1.931e-04, best=1.931e-04, lr=5.30e-02, worse_count=0]
                                                                                                                                       
(124/208) Processing tensor: layers.25.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.990e+00, best=1.990e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.981e+00, best=1.981e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.969e+00, best=1.969e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.955e+00, best=1.955e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.938e+00, best=1.938e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.918e+00, best=1.918e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.894e+00, best=1.894e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.865e+00, best=1.865e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.830e+00, best=1.830e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.788e+00, best=1.788e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.738e+00, best=1.738e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.678e+00, best=1.678e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.606e+00, best=1.606e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.519e+00, best=1.519e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.415e+00, best=1.415e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.290e+00, best=1.290e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.141e+00, best=1.141e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.608e-01, best=9.608e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=9.608e-01, best=9.608e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=7.452e-01, best=7.452e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=4.865e-01, best=4.865e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=1.760e-01, best=1.760e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=1.966e-01, best=1.760e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=1.574e-01, best=1.574e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=2.674e-01, best=1.574e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=1.361e-01, best=1.361e-01, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=3.481e-01, best=1.361e-01, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=1.119e-01, best=1.119e-01, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=4.400e-01, best=1.119e-01, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=8.434e-02, best=8.434e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=5.449e-01, best=8.434e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=5.288e-02, best=5.288e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=6.645e-01, best=5.288e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=1.701e-02, best=1.701e-02, lr=8.18e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=8.008e-01, best=1.701e-02, lr=7.77e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 169.76it/s, loss=2.388e-02, best=1.701e-02, lr=7.38e-01, worse_count=2]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=2.388e-02, best=1.701e-02, lr=7.38e-01, worse_count=2]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=7.142e-01, best=1.701e-02, lr=7.01e-01, worse_count=3]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=1.302e-02, best=1.302e-02, lr=8.41e-01, worse_count=0]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=8.284e-01, best=1.302e-02, lr=7.99e-01, worse_count=1]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=2.905e-02, best=1.302e-02, lr=7.59e-01, worse_count=2]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=7.303e-01, best=1.302e-02, lr=7.21e-01, worse_count=3]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=8.920e-03, best=8.920e-03, lr=8.66e-01, worse_count=0]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=8.567e-01, best=8.920e-03, lr=8.22e-01, worse_count=1]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=3.436e-02, best=8.920e-03, lr=7.81e-01, worse_count=2]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=7.469e-01, best=8.920e-03, lr=7.42e-01, worse_count=3]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=4.700e-03, best=4.700e-03, lr=8.91e-01, worse_count=0]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=8.859e-01, best=4.700e-03, lr=8.46e-01, worse_count=1]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=3.983e-02, best=4.700e-03, lr=8.04e-01, worse_count=2]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=7.640e-01, best=4.700e-03, lr=7.64e-01, worse_count=3]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=3.602e-04, best=3.602e-04, lr=9.16e-01, worse_count=0]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 169.14it/s, loss=9.160e-01, best=3.602e-04, lr=8.70e-01, worse_count=1]
                                                                                                                                       
(125/208) Processing tensor: layers.25.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.271e+00, best=2.271e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.262e+00, best=2.262e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.250e+00, best=2.250e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.236e+00, best=2.236e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.219e+00, best=2.219e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.199e+00, best=2.199e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.175e+00, best=2.175e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.146e+00, best=2.146e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.111e+00, best=2.111e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.069e+00, best=2.069e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.019e+00, best=2.019e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.959e+00, best=1.959e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.887e+00, best=1.887e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.800e+00, best=1.800e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.696e+00, best=1.696e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.571e+00, best=1.571e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.422e+00, best=1.422e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.242e+00, best=1.242e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.026e+00, best=1.026e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.676e-01, best=7.676e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=7.676e-01, best=7.676e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=4.571e-01, best=4.571e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=8.456e-02, best=8.456e-02, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=3.625e-01, best=8.456e-02, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=6.220e-02, best=6.220e-02, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=4.475e-01, best=6.220e-02, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=3.672e-02, best=3.672e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=5.443e-01, best=3.672e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=7.664e-03, best=7.664e-03, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=6.547e-01, best=7.664e-03, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=2.545e-02, best=7.664e-03, lr=5.98e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=5.723e-01, best=7.664e-03, lr=5.68e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=4.435e-03, best=4.435e-03, lr=6.81e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=6.771e-01, best=4.435e-03, lr=6.47e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=2.964e-02, best=4.435e-03, lr=6.15e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=5.854e-01, best=4.435e-03, lr=5.84e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=1.113e-03, best=1.113e-03, lr=7.01e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=7.000e-01, best=1.113e-03, lr=6.66e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=3.394e-02, best=1.113e-03, lr=6.33e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=5.988e-01, best=1.113e-03, lr=6.01e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 189.54it/s, loss=2.305e-03, best=1.113e-03, lr=5.71e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=2.305e-03, best=1.113e-03, lr=5.71e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=5.688e-01, best=1.113e-03, lr=5.43e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=2.625e-02, best=1.113e-03, lr=5.15e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=4.892e-01, best=1.113e-03, lr=4.90e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=4.797e-04, best=4.797e-04, lr=5.88e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=5.871e-01, best=4.797e-04, lr=5.58e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=2.890e-02, best=4.797e-04, lr=5.30e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=5.014e-01, best=4.797e-04, lr=5.04e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=2.385e-03, best=4.797e-04, lr=4.79e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=4.762e-01, best=4.797e-04, lr=4.55e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=2.154e-02, best=4.797e-04, lr=4.32e-01, worse_count=6]
                                                                                                                                       
(126/208) Processing tensor: layers.25.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.735e+00, best=1.735e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.725e+00, best=1.725e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.714e+00, best=1.714e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.700e+00, best=1.700e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.683e+00, best=1.683e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.663e+00, best=1.663e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.638e+00, best=1.638e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.609e+00, best=1.609e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.575e+00, best=1.575e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.533e+00, best=1.533e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.483e+00, best=1.483e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.422e+00, best=1.422e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.350e+00, best=1.350e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.264e+00, best=1.264e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.160e+00, best=1.160e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.035e+00, best=1.035e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.851e-01, best=8.851e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.055e-01, best=7.055e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.898e-01, best=4.898e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=4.898e-01, best=4.898e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=2.311e-01, best=2.311e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=7.937e-02, best=7.937e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=2.932e-01, best=7.937e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=6.074e-02, best=6.074e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=3.640e-01, best=6.074e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=3.951e-02, best=3.951e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=4.447e-01, best=3.951e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=1.529e-02, best=1.529e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=5.367e-01, best=1.529e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=1.231e-02, best=1.231e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=6.170e-01, best=1.231e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=1.916e-02, best=1.231e-02, lr=5.68e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=5.488e-01, best=1.231e-02, lr=5.39e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=9.237e-03, best=9.237e-03, lr=6.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=6.382e-01, best=9.237e-03, lr=6.15e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=2.313e-02, best=9.237e-03, lr=5.84e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=5.612e-01, best=9.237e-03, lr=5.55e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=6.081e-03, best=6.081e-03, lr=6.66e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.21it/s, loss=6.600e-01, best=6.081e-03, lr=6.33e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.47it/s, loss=6.600e-01, best=6.081e-03, lr=6.33e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.47it/s, loss=2.722e-02, best=6.081e-03, lr=6.01e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.47it/s, loss=5.739e-01, best=6.081e-03, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.47it/s, loss=2.834e-03, best=2.834e-03, lr=6.85e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.47it/s, loss=6.825e-01, best=2.834e-03, lr=6.51e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.47it/s, loss=3.143e-02, best=2.834e-03, lr=6.18e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.47it/s, loss=5.871e-01, best=2.834e-03, lr=5.88e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.47it/s, loss=5.077e-04, best=5.077e-04, lr=7.05e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.47it/s, loss=7.046e-01, best=5.077e-04, lr=6.70e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.47it/s, loss=3.475e-02, best=5.077e-04, lr=6.36e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.47it/s, loss=6.016e-01, best=5.077e-04, lr=6.04e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.47it/s, loss=2.930e-03, best=5.077e-04, lr=5.74e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.47it/s, loss=5.714e-01, best=5.077e-04, lr=5.46e-01, worse_count=5]
                                                                                                                                       
(127/208) Processing tensor: layers.25.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.005e+00, best=2.005e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.996e+00, best=1.996e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.984e+00, best=1.984e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.970e+00, best=1.970e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.953e+00, best=1.953e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.933e+00, best=1.933e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.909e+00, best=1.909e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.880e+00, best=1.880e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.845e+00, best=1.845e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.803e+00, best=1.803e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.753e+00, best=1.753e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.693e+00, best=1.693e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.621e+00, best=1.621e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.534e+00, best=1.534e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.430e+00, best=1.430e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.305e+00, best=1.305e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.156e+00, best=1.156e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.759e-01, best=9.759e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.603e-01, best=7.603e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=7.603e-01, best=7.603e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=5.015e-01, best=5.015e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=1.910e-01, best=1.910e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=1.815e-01, best=1.815e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=2.656e-01, best=1.815e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=1.592e-01, best=1.592e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=3.505e-01, best=1.592e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=1.337e-01, best=1.337e-01, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=4.474e-01, best=1.337e-01, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=1.046e-01, best=1.046e-01, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=5.578e-01, best=1.046e-01, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=7.152e-02, best=7.152e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=6.836e-01, best=7.152e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=3.376e-02, best=3.376e-02, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=8.271e-01, best=3.376e-02, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=9.280e-03, best=9.280e-03, lr=9.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=9.721e-01, best=9.280e-03, lr=9.32e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=3.979e-02, best=9.280e-03, lr=8.86e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=8.459e-01, best=9.280e-03, lr=8.41e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=4.496e-03, best=4.496e-03, lr=1.01e+00, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.14it/s, loss=1.005e+00, best=4.496e-03, lr=9.59e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.34it/s, loss=1.005e+00, best=4.496e-03, lr=9.59e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.34it/s, loss=4.599e-02, best=4.496e-03, lr=9.11e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.34it/s, loss=8.652e-01, best=4.496e-03, lr=8.66e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.34it/s, loss=4.280e-04, best=4.280e-04, lr=1.04e+00, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.34it/s, loss=1.038e+00, best=4.280e-04, lr=9.87e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.34it/s, loss=5.151e-02, best=4.280e-04, lr=9.37e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.34it/s, loss=8.860e-01, best=4.280e-04, lr=8.91e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.34it/s, loss=4.636e-03, best=4.280e-04, lr=8.46e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.34it/s, loss=8.415e-01, best=4.280e-04, lr=8.04e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.34it/s, loss=3.767e-02, best=4.280e-04, lr=7.64e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.34it/s, loss=7.260e-01, best=4.280e-04, lr=7.25e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.34it/s, loss=5.123e-04, best=4.280e-04, lr=6.89e-01, worse_count=8]
                                                                                                                                       
(128/208) Skipping tensor: layers.26.adaLN_modulation.0.weight (Reason: In high-precision list)
(129/208) Processing tensor: layers.26.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.771e+00, best=1.771e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.762e+00, best=1.762e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.751e+00, best=1.751e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.739e+00, best=1.739e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.725e+00, best=1.725e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.710e+00, best=1.710e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.692e+00, best=1.692e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.672e+00, best=1.672e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.649e+00, best=1.649e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.622e+00, best=1.622e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.592e+00, best=1.592e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.558e+00, best=1.558e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.519e+00, best=1.519e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.475e+00, best=1.475e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.424e+00, best=1.424e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.366e+00, best=1.366e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.300e+00, best=1.300e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.225e+00, best=1.225e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.139e+00, best=1.139e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.042e+00, best=1.042e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.305e-01, best=9.305e-01, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.036e-01, best=8.036e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.589e-01, best=6.589e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.940e-01, best=4.940e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.060e-01, best=3.060e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.174e-02, best=9.174e-02, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.526e-01, best=9.174e-02, lr=2.20e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.792e-02, best=6.792e-02, lr=2.51e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.834e-01, best=6.792e-02, lr=2.27e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.341e-02, best=4.341e-02, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.152e-01, best=4.341e-02, lr=2.33e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.820e-02, best=1.820e-02, lr=2.66e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.479e-01, best=1.820e-02, lr=2.40e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.743e-03, best=7.743e-03, lr=2.74e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.660e-01, best=7.743e-03, lr=2.47e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.895e-02, best=7.743e-03, lr=2.23e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.040e-01, best=7.743e-03, lr=2.01e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.792e-03, best=2.792e-03, lr=2.29e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.266e-01, best=2.792e-03, lr=2.07e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.957e-02, best=2.792e-03, lr=1.87e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.673e-01, best=2.792e-03, lr=1.69e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.357e-03, best=1.357e-03, lr=1.92e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.909e-01, best=1.357e-03, lr=1.73e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.739e-02, best=1.357e-03, lr=1.57e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.392e-01, best=1.357e-03, lr=1.41e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.120e-03, best=1.357e-03, lr=1.28e-01, worse_count=4]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 451.92it/s, loss=2.120e-03, best=1.357e-03, lr=1.28e-01, worse_count=4]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 451.92it/s, loss=1.254e-01, best=1.357e-03, lr=1.15e-01, worse_count=5]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 451.92it/s, loss=1.031e-02, best=1.357e-03, lr=1.04e-01, worse_count=6]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 451.92it/s, loss=9.356e-02, best=1.357e-03, lr=9.37e-02, worse_count=7]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 451.92it/s, loss=1.867e-04, best=1.867e-04, lr=1.07e-01, worse_count=0]
                                                                                                                                       
(130/208) Processing tensor: layers.26.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.061e+00, best=2.061e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.051e+00, best=2.051e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.039e+00, best=2.039e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.025e+00, best=2.025e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.009e+00, best=2.009e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.988e+00, best=1.988e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.964e+00, best=1.964e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.935e+00, best=1.935e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.900e+00, best=1.900e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.859e+00, best=1.859e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.808e+00, best=1.808e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.748e+00, best=1.748e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.676e+00, best=1.676e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.589e+00, best=1.589e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.485e+00, best=1.485e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.361e+00, best=1.361e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.211e+00, best=1.211e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.031e+00, best=1.031e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=1.031e+00, best=1.031e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=8.156e-01, best=8.156e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=5.569e-01, best=5.569e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=2.464e-01, best=2.464e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=1.262e-01, best=1.262e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=3.209e-01, best=1.262e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=1.038e-01, best=1.038e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=4.059e-01, best=1.038e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=7.834e-02, best=7.834e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=5.027e-01, best=7.834e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=4.929e-02, best=4.929e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=6.131e-01, best=4.929e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=1.617e-02, best=1.617e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=7.390e-01, best=1.617e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=2.159e-02, best=1.617e-02, lr=6.81e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=6.599e-01, best=1.617e-02, lr=6.47e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=1.249e-02, best=1.249e-02, lr=7.77e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=7.644e-01, best=1.249e-02, lr=7.38e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 171.26it/s, loss=2.636e-02, best=1.249e-02, lr=7.01e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=2.636e-02, best=1.249e-02, lr=7.01e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=6.748e-01, best=1.249e-02, lr=6.66e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=8.700e-03, best=8.700e-03, lr=7.99e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=7.906e-01, best=8.700e-03, lr=7.59e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=3.127e-02, best=8.700e-03, lr=7.21e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=6.901e-01, best=8.700e-03, lr=6.85e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=4.803e-03, best=4.803e-03, lr=8.22e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=8.176e-01, best=4.803e-03, lr=7.81e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=3.632e-02, best=4.803e-03, lr=7.42e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=7.059e-01, best=4.803e-03, lr=7.05e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=7.947e-04, best=7.947e-04, lr=8.46e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=8.453e-01, best=7.947e-04, lr=8.04e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=4.151e-02, best=7.947e-04, lr=7.64e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=7.221e-01, best=7.947e-04, lr=7.25e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 174.56it/s, loss=3.330e-03, best=7.947e-04, lr=6.89e-01, worse_count=4]
                                                                                                                                       
(131/208) Processing tensor: layers.26.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.400e+00, best=2.400e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.390e+00, best=2.390e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.379e+00, best=2.379e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.365e+00, best=2.365e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.348e+00, best=2.348e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.328e+00, best=2.328e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.304e+00, best=2.304e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.275e+00, best=2.275e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.240e+00, best=2.240e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.198e+00, best=2.198e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.148e+00, best=2.148e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.088e+00, best=2.088e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.016e+00, best=2.016e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.929e+00, best=1.929e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.825e+00, best=1.825e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.700e+00, best=1.700e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.550e+00, best=1.550e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.371e+00, best=1.371e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.155e+00, best=1.155e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.964e-01, best=8.964e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=8.964e-01, best=8.964e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=5.859e-01, best=5.859e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=2.133e-01, best=2.133e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=2.338e-01, best=2.133e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=1.910e-01, best=1.910e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=3.187e-01, best=1.910e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=1.655e-01, best=1.655e-01, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=4.156e-01, best=1.655e-01, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=1.364e-01, best=1.364e-01, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=5.260e-01, best=1.364e-01, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=1.033e-01, best=1.033e-01, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=6.518e-01, best=1.033e-01, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=6.554e-02, best=6.554e-02, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=7.953e-01, best=6.554e-02, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=2.250e-02, best=2.250e-02, lr=9.81e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=9.589e-01, best=2.250e-02, lr=9.32e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=2.657e-02, best=2.250e-02, lr=8.86e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=8.591e-01, best=2.250e-02, lr=8.41e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=1.771e-02, best=1.771e-02, lr=1.01e+00, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=9.919e-01, best=1.771e-02, lr=9.59e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.86it/s, loss=3.277e-02, best=1.771e-02, lr=9.11e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.89it/s, loss=3.277e-02, best=1.771e-02, lr=9.11e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.89it/s, loss=8.785e-01, best=1.771e-02, lr=8.66e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.89it/s, loss=1.279e-02, best=1.279e-02, lr=1.04e+00, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.89it/s, loss=1.026e+00, best=1.279e-02, lr=9.87e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.89it/s, loss=3.915e-02, best=1.279e-02, lr=9.37e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.89it/s, loss=8.984e-01, best=1.279e-02, lr=8.91e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.89it/s, loss=7.728e-03, best=7.728e-03, lr=1.07e+00, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.89it/s, loss=1.061e+00, best=7.728e-03, lr=1.02e+00, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.89it/s, loss=4.571e-02, best=7.728e-03, lr=9.64e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.89it/s, loss=9.188e-01, best=7.728e-03, lr=9.16e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.89it/s, loss=2.518e-03, best=2.518e-03, lr=1.10e+00, worse_count=0]
                                                                                                                                       
(132/208) Processing tensor: layers.26.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.674e+00, best=1.674e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.664e+00, best=1.664e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.652e+00, best=1.652e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.638e+00, best=1.638e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.621e+00, best=1.621e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.601e+00, best=1.601e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.577e+00, best=1.577e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.548e+00, best=1.548e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.513e+00, best=1.513e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.471e+00, best=1.471e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.421e+00, best=1.421e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.361e+00, best=1.361e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.289e+00, best=1.289e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.202e+00, best=1.202e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.098e+00, best=1.098e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.735e-01, best=9.735e-01, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.237e-01, best=8.237e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.441e-01, best=6.441e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.285e-01, best=4.285e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=4.285e-01, best=4.285e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=1.697e-01, best=1.697e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=1.408e-01, best=1.408e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=2.318e-01, best=1.408e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=1.221e-01, best=1.221e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=3.026e-01, best=1.221e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=1.009e-01, best=1.009e-01, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=3.833e-01, best=1.009e-01, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=7.669e-02, best=7.669e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=4.753e-01, best=7.669e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=4.909e-02, best=4.909e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=5.802e-01, best=4.909e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=1.763e-02, best=1.763e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=6.997e-01, best=1.763e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=1.824e-02, best=1.763e-02, lr=6.47e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=6.292e-01, best=1.763e-02, lr=6.15e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=1.413e-02, best=1.413e-02, lr=7.38e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=7.239e-01, best=1.413e-02, lr=7.01e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=2.277e-02, best=1.413e-02, lr=6.66e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=6.433e-01, best=1.413e-02, lr=6.33e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.37it/s, loss=1.053e-02, best=1.053e-02, lr=7.59e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.25it/s, loss=1.053e-02, best=1.053e-02, lr=7.59e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.25it/s, loss=7.488e-01, best=1.053e-02, lr=7.21e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.25it/s, loss=2.744e-02, best=1.053e-02, lr=6.85e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.25it/s, loss=6.579e-01, best=1.053e-02, lr=6.51e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.25it/s, loss=6.829e-03, best=6.829e-03, lr=7.81e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.25it/s, loss=7.744e-01, best=6.829e-03, lr=7.42e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.25it/s, loss=3.223e-02, best=6.829e-03, lr=7.05e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.25it/s, loss=6.729e-01, best=6.829e-03, lr=6.70e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.25it/s, loss=3.021e-03, best=3.021e-03, lr=8.04e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.25it/s, loss=8.008e-01, best=3.021e-03, lr=7.64e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.25it/s, loss=3.717e-02, best=3.021e-03, lr=7.25e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 188.25it/s, loss=6.883e-01, best=3.021e-03, lr=6.89e-01, worse_count=3]
                                                                                                                                       
(133/208) Processing tensor: layers.26.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.781e+00, best=1.781e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.771e+00, best=1.771e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.759e+00, best=1.759e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.745e+00, best=1.745e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.728e+00, best=1.728e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.708e+00, best=1.708e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.684e+00, best=1.684e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.655e+00, best=1.655e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.620e+00, best=1.620e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.579e+00, best=1.579e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.528e+00, best=1.528e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.468e+00, best=1.468e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.396e+00, best=1.396e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.309e+00, best=1.309e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.205e+00, best=1.205e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.081e+00, best=1.081e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.309e-01, best=9.309e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.512e-01, best=7.512e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.356e-01, best=5.356e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.768e-01, best=2.768e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=2.768e-01, best=2.768e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=3.366e-02, best=3.366e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=3.389e-01, best=3.366e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=1.503e-02, best=1.503e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=4.097e-01, best=1.503e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=6.211e-03, best=6.211e-03, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=4.780e-01, best=6.211e-03, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=1.800e-02, best=6.211e-03, lr=4.37e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=4.190e-01, best=6.211e-03, lr=4.15e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=3.850e-03, best=3.850e-03, lr=4.98e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=4.943e-01, best=3.850e-03, lr=4.73e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=2.106e-02, best=3.850e-03, lr=4.50e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=4.285e-01, best=3.850e-03, lr=4.27e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=1.422e-03, best=1.422e-03, lr=5.13e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=5.111e-01, best=1.422e-03, lr=4.87e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=2.421e-02, best=1.422e-03, lr=4.63e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=4.384e-01, best=1.422e-03, lr=4.39e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=1.077e-03, best=1.077e-03, lr=5.27e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=5.263e-01, best=1.077e-03, lr=5.01e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=2.529e-02, best=1.077e-03, lr=4.76e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.95it/s, loss=4.506e-01, best=1.077e-03, lr=4.52e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.78it/s, loss=4.506e-01, best=1.077e-03, lr=4.52e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.78it/s, loss=1.494e-03, best=1.077e-03, lr=4.29e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.78it/s, loss=4.280e-01, best=1.077e-03, lr=4.08e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.78it/s, loss=1.998e-02, best=1.077e-03, lr=3.88e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.78it/s, loss=3.677e-01, best=1.077e-03, lr=3.68e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.78it/s, loss=6.005e-04, best=6.005e-04, lr=4.42e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.78it/s, loss=4.413e-01, best=6.005e-04, lr=4.20e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.78it/s, loss=2.150e-02, best=6.005e-04, lr=3.99e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.78it/s, loss=3.773e-01, best=6.005e-04, lr=3.79e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.78it/s, loss=1.554e-03, best=6.005e-04, lr=3.60e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.78it/s, loss=3.584e-01, best=6.005e-04, lr=3.42e-01, worse_count=5]
                                                                                                                                       
(134/208) Skipping tensor: layers.27.adaLN_modulation.0.weight (Reason: In high-precision list)
(135/208) Processing tensor: layers.27.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.733e+00, best=1.733e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.724e+00, best=1.724e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.713e+00, best=1.713e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.701e+00, best=1.701e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.687e+00, best=1.687e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.672e+00, best=1.672e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.654e+00, best=1.654e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.634e+00, best=1.634e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.611e+00, best=1.611e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.584e+00, best=1.584e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.554e+00, best=1.554e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.520e+00, best=1.520e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.481e+00, best=1.481e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.437e+00, best=1.437e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.386e+00, best=1.386e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.328e+00, best=1.328e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.262e+00, best=1.262e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.187e+00, best=1.187e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.101e+00, best=1.101e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.004e+00, best=1.004e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.925e-01, best=8.925e-01, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.656e-01, best=7.656e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.210e-01, best=6.210e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.561e-01, best=4.561e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.681e-01, best=2.681e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.380e-02, best=5.380e-02, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.905e-01, best=5.380e-02, lr=2.20e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.998e-02, best=2.998e-02, lr=2.51e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.214e-01, best=2.998e-02, lr=2.27e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.475e-03, best=5.475e-03, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.531e-01, best=5.475e-03, lr=2.33e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.974e-02, best=5.475e-03, lr=2.11e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.909e-01, best=5.475e-03, lr=1.90e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.978e-04, best=7.978e-04, lr=2.17e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.159e-01, best=7.978e-04, lr=1.96e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.033e-02, best=7.978e-04, lr=1.77e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.562e-01, best=7.978e-04, lr=1.59e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.122e-03, best=7.978e-04, lr=1.44e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.407e-01, best=7.978e-04, lr=1.30e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.090e-02, best=7.978e-04, lr=1.17e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.062e-01, best=7.978e-04, lr=1.06e-01, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.214e-04, best=5.214e-04, lr=1.20e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.200e-01, best=5.214e-04, lr=1.09e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.123e-02, best=5.214e-04, lr=9.81e-02, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.691e-02, best=5.214e-04, lr=8.86e-02, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.658e-03, best=5.214e-04, lr=7.99e-02, worse_count=4]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 458.17it/s, loss=1.658e-03, best=5.214e-04, lr=7.99e-02, worse_count=4]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 458.17it/s, loss=7.827e-02, best=5.214e-04, lr=7.21e-02, worse_count=5]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 458.17it/s, loss=6.136e-03, best=5.214e-04, lr=6.51e-02, worse_count=6]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 458.17it/s, loss=5.897e-02, best=5.214e-04, lr=5.88e-02, worse_count=7]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 458.17it/s, loss=2.121e-04, best=2.121e-04, lr=6.70e-02, worse_count=0]
                                                                                                                                       
(136/208) Processing tensor: layers.27.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.174e+00, best=2.174e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.165e+00, best=2.165e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.153e+00, best=2.153e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.139e+00, best=2.139e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.122e+00, best=2.122e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.102e+00, best=2.102e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.078e+00, best=2.078e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.049e+00, best=2.049e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.014e+00, best=2.014e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.972e+00, best=1.972e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.922e+00, best=1.922e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.862e+00, best=1.862e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.790e+00, best=1.790e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.703e+00, best=1.703e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.599e+00, best=1.599e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.474e+00, best=1.474e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.325e+00, best=1.325e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.145e+00, best=1.145e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=1.145e+00, best=1.145e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=9.292e-01, best=9.292e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=6.705e-01, best=6.705e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=3.600e-01, best=3.600e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=1.257e-02, best=1.257e-02, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=4.345e-01, best=1.257e-02, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=9.788e-03, best=9.788e-03, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=4.999e-01, best=9.788e-03, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=1.570e-02, best=9.788e-03, lr=4.60e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=4.443e-01, best=9.788e-03, lr=4.37e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=7.303e-03, best=7.303e-03, lr=5.24e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=5.171e-01, best=7.303e-03, lr=4.98e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=1.892e-02, best=7.303e-03, lr=4.73e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=4.543e-01, best=7.303e-03, lr=4.50e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=4.747e-03, best=4.747e-03, lr=5.39e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=5.348e-01, best=4.747e-03, lr=5.13e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=2.223e-02, best=4.747e-03, lr=4.87e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=4.647e-01, best=4.747e-03, lr=4.63e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.78it/s, loss=2.117e-03, best=2.117e-03, lr=5.55e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.35it/s, loss=2.117e-03, best=2.117e-03, lr=5.55e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.35it/s, loss=5.530e-01, best=2.117e-03, lr=5.27e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.35it/s, loss=2.564e-02, best=2.117e-03, lr=5.01e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.35it/s, loss=4.753e-01, best=2.117e-03, lr=4.76e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.35it/s, loss=5.898e-04, best=5.898e-04, lr=5.71e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.35it/s, loss=5.705e-01, best=5.898e-04, lr=5.43e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.35it/s, loss=2.797e-02, best=5.898e-04, lr=5.15e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.35it/s, loss=4.875e-01, best=5.898e-04, lr=4.90e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.35it/s, loss=2.194e-03, best=5.898e-04, lr=4.65e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.35it/s, loss=4.630e-01, best=5.898e-04, lr=4.42e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.35it/s, loss=2.106e-02, best=5.898e-04, lr=4.20e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.35it/s, loss=3.987e-01, best=5.898e-04, lr=3.99e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.35it/s, loss=7.539e-05, best=7.539e-05, lr=4.79e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.35it/s, loss=4.785e-01, best=7.539e-05, lr=4.55e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.35it/s, loss=2.385e-02, best=7.539e-05, lr=4.32e-01, worse_count=2]
                                                                                                                                       
(137/208) Processing tensor: layers.27.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.059e+00, best=2.059e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.049e+00, best=2.049e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.037e+00, best=2.037e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.023e+00, best=2.023e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.007e+00, best=2.007e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.987e+00, best=1.987e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.962e+00, best=1.962e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.933e+00, best=1.933e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.899e+00, best=1.899e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.857e+00, best=1.857e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.807e+00, best=1.807e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.746e+00, best=1.746e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.674e+00, best=1.674e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.588e+00, best=1.588e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.484e+00, best=1.484e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.359e+00, best=1.359e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.209e+00, best=1.209e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.029e+00, best=1.029e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.138e-01, best=8.138e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=8.138e-01, best=8.138e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=5.550e-01, best=5.550e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=2.446e-01, best=2.446e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=1.280e-01, best=1.280e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=3.191e-01, best=1.280e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=1.057e-01, best=1.057e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=4.040e-01, best=1.057e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=8.018e-02, best=8.018e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=5.009e-01, best=8.018e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=5.113e-02, best=5.113e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=6.113e-01, best=5.113e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=1.801e-02, best=1.801e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=7.371e-01, best=1.801e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=1.975e-02, best=1.801e-02, lr=6.81e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=6.617e-01, best=1.801e-02, lr=6.47e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=1.433e-02, best=1.433e-02, lr=7.77e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=7.626e-01, best=1.433e-02, lr=7.38e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=2.452e-02, best=1.433e-02, lr=7.01e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=6.766e-01, best=1.433e-02, lr=6.66e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=1.054e-02, best=1.054e-02, lr=7.99e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.64it/s, loss=7.888e-01, best=1.054e-02, lr=7.59e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.37it/s, loss=7.888e-01, best=1.054e-02, lr=7.59e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.37it/s, loss=2.942e-02, best=1.054e-02, lr=7.21e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.37it/s, loss=6.920e-01, best=1.054e-02, lr=6.85e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.37it/s, loss=6.644e-03, best=6.644e-03, lr=8.22e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.37it/s, loss=8.157e-01, best=6.644e-03, lr=7.81e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.37it/s, loss=3.447e-02, best=6.644e-03, lr=7.42e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.37it/s, loss=7.077e-01, best=6.644e-03, lr=7.05e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.37it/s, loss=2.635e-03, best=2.635e-03, lr=8.46e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.37it/s, loss=8.435e-01, best=2.635e-03, lr=8.04e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.37it/s, loss=3.967e-02, best=2.635e-03, lr=7.64e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.37it/s, loss=7.239e-01, best=2.635e-03, lr=7.25e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 192.37it/s, loss=1.490e-03, best=1.490e-03, lr=8.70e-01, worse_count=0]
                                                                                                                                       
(138/208) Processing tensor: layers.27.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.784e+00, best=1.784e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.774e+00, best=1.774e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.762e+00, best=1.762e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.748e+00, best=1.748e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.732e+00, best=1.732e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.712e+00, best=1.712e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.687e+00, best=1.687e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.658e+00, best=1.658e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.624e+00, best=1.624e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.582e+00, best=1.582e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.532e+00, best=1.532e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.471e+00, best=1.471e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.399e+00, best=1.399e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.313e+00, best=1.313e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.209e+00, best=1.209e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.084e+00, best=1.084e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.341e-01, best=9.341e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.544e-01, best=7.544e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.388e-01, best=5.388e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=5.388e-01, best=5.388e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=2.800e-01, best=2.800e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=3.044e-02, best=3.044e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=3.421e-01, best=3.044e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=1.181e-02, best=1.181e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=4.129e-01, best=1.181e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=9.423e-03, best=9.423e-03, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=4.748e-01, best=9.423e-03, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=1.479e-02, best=9.423e-03, lr=4.37e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=4.222e-01, best=9.423e-03, lr=4.15e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=7.062e-03, best=7.062e-03, lr=4.98e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=4.911e-01, best=7.062e-03, lr=4.73e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=1.785e-02, best=7.062e-03, lr=4.50e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=4.318e-01, best=7.062e-03, lr=4.27e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=4.634e-03, best=4.634e-03, lr=5.13e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=5.079e-01, best=4.634e-03, lr=4.87e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=2.099e-02, best=4.634e-03, lr=4.63e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=4.416e-01, best=4.634e-03, lr=4.39e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=2.135e-03, best=2.135e-03, lr=5.27e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=5.252e-01, best=2.135e-03, lr=5.01e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.99it/s, loss=2.423e-02, best=2.135e-03, lr=4.76e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.08it/s, loss=2.423e-02, best=2.135e-03, lr=4.76e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.08it/s, loss=4.517e-01, best=2.135e-03, lr=4.52e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.08it/s, loss=4.359e-04, best=4.359e-04, lr=5.43e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.08it/s, loss=5.421e-01, best=4.359e-04, lr=5.15e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.08it/s, loss=2.669e-02, best=4.359e-04, lr=4.90e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.08it/s, loss=4.630e-01, best=4.359e-04, lr=4.65e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.08it/s, loss=2.209e-03, best=4.359e-04, lr=4.42e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.08it/s, loss=4.397e-01, best=4.359e-04, lr=4.20e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.08it/s, loss=1.989e-02, best=4.359e-04, lr=3.99e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.08it/s, loss=3.789e-01, best=4.359e-04, lr=3.79e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.08it/s, loss=5.687e-05, best=5.687e-05, lr=4.55e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.08it/s, loss=4.546e-01, best=5.687e-05, lr=4.32e-01, worse_count=1]
                                                                                                                                       
(139/208) Processing tensor: layers.27.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.873e+00, best=1.873e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.864e+00, best=1.864e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.852e+00, best=1.852e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.838e+00, best=1.838e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.821e+00, best=1.821e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.801e+00, best=1.801e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.777e+00, best=1.777e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.748e+00, best=1.748e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.713e+00, best=1.713e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.671e+00, best=1.671e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.621e+00, best=1.621e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.561e+00, best=1.561e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.489e+00, best=1.489e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.402e+00, best=1.402e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.298e+00, best=1.298e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.173e+00, best=1.173e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.024e+00, best=1.024e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.439e-01, best=8.439e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.283e-01, best=6.283e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.695e-01, best=3.695e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=3.695e-01, best=3.695e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=5.905e-02, best=5.905e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=3.135e-01, best=5.905e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=4.042e-02, best=4.042e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=3.843e-01, best=4.042e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=1.918e-02, best=1.918e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=4.650e-01, best=1.918e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=5.029e-03, best=5.029e-03, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=5.470e-01, best=5.029e-03, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=2.257e-02, best=5.029e-03, lr=4.98e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=4.756e-01, best=5.029e-03, lr=4.73e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=2.338e-03, best=2.338e-03, lr=5.68e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=5.656e-01, best=2.338e-03, lr=5.39e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=2.606e-02, best=2.338e-03, lr=5.13e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=4.865e-01, best=2.338e-03, lr=4.87e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=4.307e-04, best=4.307e-04, lr=5.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=5.839e-01, best=4.307e-04, lr=5.55e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=2.878e-02, best=4.307e-04, lr=5.27e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=4.986e-01, best=4.307e-04, lr=5.01e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=2.418e-03, best=4.307e-04, lr=4.76e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=4.735e-01, best=4.307e-04, lr=4.52e-01, worse_count=5]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 196.22it/s, loss=2.138e-02, best=4.307e-04, lr=4.29e-01, worse_count=6]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 198.12it/s, loss=2.138e-02, best=4.307e-04, lr=4.29e-01, worse_count=6]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 198.12it/s, loss=4.081e-01, best=4.307e-04, lr=4.08e-01, worse_count=7]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 198.12it/s, loss=9.887e-05, best=9.887e-05, lr=4.90e-01, worse_count=0]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 198.12it/s, loss=4.895e-01, best=9.887e-05, lr=4.65e-01, worse_count=1]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 198.12it/s, loss=2.438e-02, best=9.887e-05, lr=4.42e-01, worse_count=2]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 198.12it/s, loss=4.175e-01, best=9.887e-05, lr=4.20e-01, worse_count=3]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 198.12it/s, loss=2.288e-03, best=9.887e-05, lr=3.99e-01, worse_count=4]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 198.12it/s, loss=3.965e-01, best=9.887e-05, lr=3.79e-01, worse_count=5]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 198.12it/s, loss=1.765e-02, best=9.887e-05, lr=3.60e-01, worse_count=6]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 198.12it/s, loss=3.423e-01, best=9.887e-05, lr=3.42e-01, worse_count=7]
                                                                                                                                       
(140/208) Skipping tensor: layers.28.adaLN_modulation.0.weight (Reason: In high-precision list)
(141/208) Processing tensor: layers.28.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.808e+00, best=1.808e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.799e+00, best=1.799e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.789e+00, best=1.789e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.777e+00, best=1.777e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.763e+00, best=1.763e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.747e+00, best=1.747e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.730e+00, best=1.730e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.709e+00, best=1.709e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.686e+00, best=1.686e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.660e+00, best=1.660e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.630e+00, best=1.630e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.596e+00, best=1.596e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.557e+00, best=1.557e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.512e+00, best=1.512e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.462e+00, best=1.462e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.404e+00, best=1.404e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.338e+00, best=1.338e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.263e+00, best=1.263e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.177e+00, best=1.177e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.079e+00, best=1.079e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.681e-01, best=9.681e-01, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.412e-01, best=8.412e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.966e-01, best=6.966e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.317e-01, best=5.317e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.437e-01, best=3.437e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.294e-01, best=1.294e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.149e-01, best=1.149e-01, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.636e-01, best=1.149e-01, lr=2.51e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.779e-02, best=8.779e-02, lr=2.87e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.988e-01, best=8.779e-02, lr=2.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.985e-02, best=5.985e-02, lr=2.95e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.350e-01, best=5.985e-02, lr=2.66e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.111e-02, best=3.111e-02, lr=3.03e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.722e-01, best=3.111e-02, lr=2.74e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.536e-03, best=1.536e-03, lr=3.12e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.105e-01, best=1.536e-03, lr=2.82e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.889e-02, best=1.536e-03, lr=2.54e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.253e-01, best=1.536e-03, lr=2.29e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.108e-03, best=1.536e-03, lr=2.07e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.029e-01, best=1.536e-03, lr=1.87e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.608e-02, best=1.536e-03, lr=1.69e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.526e-01, best=1.536e-03, lr=1.52e-01, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.639e-04, best=3.639e-04, lr=1.73e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.731e-01, best=3.639e-04, lr=1.57e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.655e-02, best=3.639e-04, lr=1.41e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.248e-01, best=3.639e-04, lr=1.28e-01, worse_count=3]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 457.25it/s, loss=1.248e-01, best=3.639e-04, lr=1.28e-01, worse_count=3]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 457.25it/s, loss=2.774e-03, best=3.639e-04, lr=1.15e-01, worse_count=4]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 457.25it/s, loss=1.123e-01, best=3.639e-04, lr=1.04e-01, worse_count=5]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 457.25it/s, loss=8.448e-03, best=3.639e-04, lr=9.37e-02, worse_count=6]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 457.25it/s, loss=8.530e-02, best=3.639e-04, lr=8.46e-02, worse_count=7]
                                                                                                                                       
(142/208) Processing tensor: layers.28.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.115e+00, best=2.115e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.105e+00, best=2.105e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.094e+00, best=2.094e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.080e+00, best=2.080e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.063e+00, best=2.063e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.043e+00, best=2.043e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.018e+00, best=2.018e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.989e+00, best=1.989e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.955e+00, best=1.955e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.913e+00, best=1.913e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.863e+00, best=1.863e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.803e+00, best=1.803e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.730e+00, best=1.730e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.644e+00, best=1.644e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.540e+00, best=1.540e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.415e+00, best=1.415e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.265e+00, best=1.265e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.086e+00, best=1.086e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=1.086e+00, best=1.086e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=8.699e-01, best=8.699e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=6.112e-01, best=6.112e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=3.007e-01, best=3.007e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=7.188e-02, best=7.188e-02, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=3.752e-01, best=7.188e-02, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=4.952e-02, best=4.952e-02, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=4.602e-01, best=4.952e-02, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=2.404e-02, best=2.404e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=5.570e-01, best=2.404e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=5.011e-03, best=5.011e-03, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=6.574e-01, best=5.011e-03, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=2.811e-02, best=5.011e-03, lr=5.98e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=5.697e-01, best=5.011e-03, lr=5.68e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=1.782e-03, best=1.782e-03, lr=6.81e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=6.797e-01, best=1.782e-03, lr=6.47e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=3.229e-02, best=1.782e-03, lr=6.15e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=5.828e-01, best=1.782e-03, lr=5.84e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 176.48it/s, loss=1.540e-03, best=1.540e-03, lr=7.01e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 177.33it/s, loss=1.540e-03, best=1.540e-03, lr=7.01e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 177.33it/s, loss=6.996e-01, best=1.540e-03, lr=6.66e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 177.33it/s, loss=3.352e-02, best=1.540e-03, lr=6.33e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 177.33it/s, loss=5.993e-01, best=1.540e-03, lr=6.01e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 177.33it/s, loss=1.878e-03, best=1.540e-03, lr=5.71e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 177.33it/s, loss=5.692e-01, best=1.540e-03, lr=5.43e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 177.33it/s, loss=2.668e-02, best=1.540e-03, lr=5.15e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 177.33it/s, loss=4.887e-01, best=1.540e-03, lr=4.90e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 177.33it/s, loss=9.061e-04, best=9.061e-04, lr=5.88e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 177.33it/s, loss=5.867e-01, best=9.061e-04, lr=5.58e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 177.33it/s, loss=2.847e-02, best=9.061e-04, lr=5.30e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 177.33it/s, loss=5.018e-01, best=9.061e-04, lr=5.04e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 177.33it/s, loss=1.958e-03, best=9.061e-04, lr=4.79e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 177.33it/s, loss=4.766e-01, best=9.061e-04, lr=4.55e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 177.33it/s, loss=2.197e-02, best=9.061e-04, lr=4.32e-01, worse_count=6]
                                                                                                                                       
(143/208) Processing tensor: layers.28.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.998e+00, best=1.998e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.989e+00, best=1.989e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.977e+00, best=1.977e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.963e+00, best=1.963e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.946e+00, best=1.946e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.926e+00, best=1.926e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.902e+00, best=1.902e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.873e+00, best=1.873e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.838e+00, best=1.838e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.796e+00, best=1.796e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.746e+00, best=1.746e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.686e+00, best=1.686e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.614e+00, best=1.614e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.527e+00, best=1.527e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.423e+00, best=1.423e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.298e+00, best=1.298e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.149e+00, best=1.149e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.688e-01, best=9.688e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.532e-01, best=7.532e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.945e-01, best=4.945e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=4.945e-01, best=4.945e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=1.840e-01, best=1.840e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=1.886e-01, best=1.840e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=1.654e-01, best=1.654e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=2.593e-01, best=1.654e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=1.442e-01, best=1.442e-01, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=3.400e-01, best=1.442e-01, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=1.199e-01, best=1.199e-01, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=4.320e-01, best=1.199e-01, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=9.234e-02, best=9.234e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=5.369e-01, best=9.234e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=6.088e-02, best=6.088e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=6.565e-01, best=6.088e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=2.501e-02, best=2.501e-02, lr=8.18e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=7.928e-01, best=2.501e-02, lr=7.77e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=1.588e-02, best=1.588e-02, lr=9.32e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=9.164e-01, best=1.588e-02, lr=8.86e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=3.074e-02, best=1.588e-02, lr=8.41e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=8.106e-01, best=1.588e-02, lr=7.99e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=1.133e-02, best=1.133e-02, lr=9.59e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.91it/s, loss=9.478e-01, best=1.133e-02, lr=9.11e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.88it/s, loss=9.478e-01, best=1.133e-02, lr=9.11e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.88it/s, loss=3.663e-02, best=1.133e-02, lr=8.66e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.88it/s, loss=8.290e-01, best=1.133e-02, lr=8.22e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.88it/s, loss=6.656e-03, best=6.656e-03, lr=9.87e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.88it/s, loss=9.802e-01, best=6.656e-03, lr=9.37e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.88it/s, loss=4.269e-02, best=6.656e-03, lr=8.91e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.88it/s, loss=8.479e-01, best=6.656e-03, lr=8.46e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.88it/s, loss=1.845e-03, best=1.845e-03, lr=1.02e+00, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.88it/s, loss=1.013e+00, best=1.845e-03, lr=9.64e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.88it/s, loss=4.892e-02, best=1.845e-03, lr=9.16e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.88it/s, loss=8.674e-01, best=1.845e-03, lr=8.70e-01, worse_count=3]
                                                                                                                                       
(144/208) Processing tensor: layers.28.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.749e+00, best=1.749e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.739e+00, best=1.739e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.728e+00, best=1.728e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.714e+00, best=1.714e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.697e+00, best=1.697e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.677e+00, best=1.677e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.653e+00, best=1.653e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.624e+00, best=1.624e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.589e+00, best=1.589e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.547e+00, best=1.547e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.497e+00, best=1.497e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.437e+00, best=1.437e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.364e+00, best=1.364e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.278e+00, best=1.278e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.174e+00, best=1.174e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.049e+00, best=1.049e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.993e-01, best=8.993e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.196e-01, best=7.196e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.040e-01, best=5.040e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=5.040e-01, best=5.040e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=2.453e-01, best=2.453e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=6.520e-02, best=6.520e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=3.074e-01, best=6.520e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=4.657e-02, best=4.657e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=3.782e-01, best=4.657e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=2.534e-02, best=2.534e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=4.589e-01, best=2.534e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=1.125e-03, best=1.125e-03, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=5.509e-01, best=1.125e-03, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=2.647e-02, best=1.125e-03, lr=4.98e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=4.717e-01, best=1.125e-03, lr=4.73e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=1.566e-03, best=1.125e-03, lr=4.50e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=4.480e-01, best=1.125e-03, lr=4.27e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=2.091e-02, best=1.125e-03, lr=4.06e-01, worse_count=6]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=3.848e-01, best=1.125e-03, lr=3.85e-01, worse_count=7]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=6.260e-04, best=6.260e-04, lr=4.63e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=4.619e-01, best=6.260e-04, lr=4.39e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=2.250e-02, best=6.260e-04, lr=4.17e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.17it/s, loss=3.950e-01, best=6.260e-04, lr=3.97e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.05it/s, loss=3.950e-01, best=6.260e-04, lr=3.97e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.05it/s, loss=1.629e-03, best=6.260e-04, lr=3.77e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.05it/s, loss=3.751e-01, best=6.260e-04, lr=3.58e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.05it/s, loss=1.721e-02, best=6.260e-04, lr=3.40e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.05it/s, loss=3.228e-01, best=6.260e-04, lr=3.23e-01, worse_count=7]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.05it/s, loss=2.080e-04, best=2.080e-04, lr=3.88e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.05it/s, loss=3.874e-01, best=2.080e-04, lr=3.68e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.05it/s, loss=1.917e-02, best=2.080e-04, lr=3.50e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.05it/s, loss=3.307e-01, best=2.080e-04, lr=3.32e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.05it/s, loss=1.682e-03, best=2.080e-04, lr=3.16e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.05it/s, loss=3.141e-01, best=2.080e-04, lr=3.00e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.05it/s, loss=1.411e-02, best=2.080e-04, lr=2.85e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.05it/s, loss=2.708e-01, best=2.080e-04, lr=2.71e-01, worse_count=7]
                                                                                                                                       
(145/208) Processing tensor: layers.28.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.792e+00, best=1.792e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.782e+00, best=1.782e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.771e+00, best=1.771e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.757e+00, best=1.757e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.740e+00, best=1.740e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.720e+00, best=1.720e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.695e+00, best=1.695e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.666e+00, best=1.666e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.632e+00, best=1.632e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.590e+00, best=1.590e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.540e+00, best=1.540e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.480e+00, best=1.480e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.407e+00, best=1.407e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.321e+00, best=1.321e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.217e+00, best=1.217e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.092e+00, best=1.092e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.422e-01, best=9.422e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.625e-01, best=7.625e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.469e-01, best=5.469e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.882e-01, best=2.882e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=2.882e-01, best=2.882e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=2.233e-02, best=2.233e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=3.502e-01, best=2.233e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=3.702e-03, best=3.702e-03, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=4.210e-01, best=3.702e-03, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=1.754e-02, best=3.702e-03, lr=3.83e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=3.658e-01, best=3.702e-03, lr=3.64e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=1.631e-03, best=1.631e-03, lr=4.37e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=4.354e-01, best=1.631e-03, lr=4.15e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=2.022e-02, best=1.631e-03, lr=3.94e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=3.742e-01, best=1.631e-03, lr=3.75e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=4.997e-04, best=4.997e-04, lr=4.50e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=4.491e-01, best=4.997e-04, lr=4.27e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=2.198e-02, best=4.997e-04, lr=4.06e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=3.838e-01, best=4.997e-04, lr=3.85e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=1.692e-03, best=4.997e-04, lr=3.66e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=3.645e-01, best=4.997e-04, lr=3.48e-01, worse_count=5]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=1.662e-02, best=4.997e-04, lr=3.30e-01, worse_count=6]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=3.139e-01, best=4.997e-04, lr=3.14e-01, worse_count=7]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=9.385e-05, best=9.385e-05, lr=3.77e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.58it/s, loss=3.767e-01, best=9.385e-05, lr=3.58e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.83it/s, loss=3.767e-01, best=9.385e-05, lr=3.58e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.83it/s, loss=1.874e-02, best=9.385e-05, lr=3.40e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.83it/s, loss=3.213e-01, best=9.385e-05, lr=3.23e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.83it/s, loss=1.743e-03, best=9.385e-05, lr=3.07e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.83it/s, loss=3.051e-01, best=9.385e-05, lr=2.92e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.83it/s, loss=1.360e-02, best=9.385e-05, lr=2.77e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.83it/s, loss=2.634e-01, best=9.385e-05, lr=2.63e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.83it/s, loss=2.472e-04, best=9.385e-05, lr=2.50e-01, worse_count=8]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.83it/s, loss=2.497e-01, best=9.385e-05, lr=2.37e-01, worse_count=9]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.83it/s, loss=1.225e-02, best=9.385e-05, lr=2.26e-01, worse_count=10]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.83it/s, loss=2.133e-01, best=9.385e-05, lr=2.14e-01, worse_count=11]
                                                                                                                                        
(146/208) Skipping tensor: layers.29.adaLN_modulation.0.weight (Reason: In high-precision list)
(147/208) Processing tensor: layers.29.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.967e+00, best=1.967e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.958e+00, best=1.958e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.947e+00, best=1.947e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.935e+00, best=1.935e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.922e+00, best=1.922e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.906e+00, best=1.906e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.888e+00, best=1.888e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.868e+00, best=1.868e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.845e+00, best=1.845e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.818e+00, best=1.818e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.788e+00, best=1.788e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.754e+00, best=1.754e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.715e+00, best=1.715e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.671e+00, best=1.671e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.620e+00, best=1.620e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.562e+00, best=1.562e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.496e+00, best=1.496e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.421e+00, best=1.421e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.336e+00, best=1.336e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.238e+00, best=1.238e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.127e+00, best=1.127e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.997e-01, best=9.997e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.550e-01, best=8.550e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.901e-01, best=6.901e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.022e-01, best=5.022e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.878e-01, best=2.878e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.354e-02, best=4.354e-02, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.350e-01, best=4.354e-02, lr=2.51e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.639e-02, best=1.639e-02, lr=2.87e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.702e-01, best=1.639e-02, lr=2.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.155e-02, best=1.155e-02, lr=2.95e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.833e-01, best=1.155e-02, lr=2.66e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.719e-02, best=1.155e-02, lr=2.40e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.229e-01, best=1.155e-02, lr=2.17e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.219e-03, best=6.219e-03, lr=2.47e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.408e-01, best=6.219e-03, lr=2.23e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.787e-02, best=6.219e-03, lr=2.01e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.834e-01, best=6.219e-03, lr=1.82e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.751e-03, best=1.751e-03, lr=2.07e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.053e-01, best=1.751e-03, lr=1.87e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.844e-02, best=1.751e-03, lr=1.69e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.502e-01, best=1.751e-03, lr=1.52e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.994e-03, best=1.751e-03, lr=1.37e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.354e-01, best=1.751e-03, lr=1.24e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.140e-02, best=1.751e-03, lr=1.12e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.005e-01, best=1.751e-03, lr=1.01e-01, worse_count=7]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 459.05it/s, loss=1.005e-01, best=1.751e-03, lr=1.01e-01, worse_count=7]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 459.05it/s, loss=4.903e-04, best=4.903e-04, lr=1.15e-01, worse_count=0]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 459.05it/s, loss=1.146e-01, best=4.903e-04, lr=1.04e-01, worse_count=1]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 459.05it/s, loss=1.073e-02, best=4.903e-04, lr=9.37e-02, worse_count=2]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 459.05it/s, loss=8.302e-02, best=4.903e-04, lr=8.46e-02, worse_count=3]
                                                                                                                                       
(148/208) Processing tensor: layers.29.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.386e+00, best=3.386e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.376e+00, best=3.376e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.365e+00, best=3.365e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.351e+00, best=3.351e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.334e+00, best=3.334e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.314e+00, best=3.314e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.289e+00, best=3.289e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.260e+00, best=3.260e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.226e+00, best=3.226e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.184e+00, best=3.184e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.134e+00, best=3.134e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.074e+00, best=3.074e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.001e+00, best=3.001e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.915e+00, best=2.915e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.811e+00, best=2.811e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.686e+00, best=2.686e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.536e+00, best=2.536e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.357e+00, best=2.357e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=2.357e+00, best=2.357e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=2.141e+00, best=2.141e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=1.882e+00, best=1.882e+00, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=1.572e+00, best=1.572e+00, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=1.199e+00, best=1.199e+00, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=7.521e-01, best=7.521e-01, lr=5.36e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=2.156e-01, best=2.156e-01, lr=6.44e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=4.282e-01, best=2.156e-01, lr=6.12e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=1.834e-01, best=1.834e-01, lr=7.34e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=5.505e-01, best=1.834e-01, lr=6.97e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=1.467e-01, best=1.467e-01, lr=8.37e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=6.900e-01, best=1.467e-01, lr=7.95e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=1.049e-01, best=1.049e-01, lr=9.54e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=8.490e-01, best=1.049e-01, lr=9.06e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=5.717e-02, best=5.717e-02, lr=1.09e+00, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=1.030e+00, best=5.717e-02, lr=1.03e+00, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=2.806e-03, best=2.806e-03, lr=1.24e+00, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=1.237e+00, best=2.806e-03, lr=1.18e+00, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.11it/s, loss=5.917e-02, best=2.806e-03, lr=1.12e+00, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.28it/s, loss=5.917e-02, best=2.806e-03, lr=1.12e+00, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.28it/s, loss=1.060e+00, best=2.806e-03, lr=1.06e+00, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.28it/s, loss=3.237e-03, best=2.806e-03, lr=1.01e+00, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.28it/s, loss=1.006e+00, best=2.806e-03, lr=9.59e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.28it/s, loss=4.725e-02, best=2.806e-03, lr=9.11e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.28it/s, loss=8.640e-01, best=2.806e-03, lr=8.66e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.28it/s, loss=1.685e-03, best=1.685e-03, lr=1.04e+00, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.28it/s, loss=1.037e+00, best=1.685e-03, lr=9.87e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.28it/s, loss=5.025e-02, best=1.685e-03, lr=9.37e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.28it/s, loss=8.872e-01, best=1.685e-03, lr=8.91e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.28it/s, loss=3.379e-03, best=1.685e-03, lr=8.46e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.28it/s, loss=8.427e-01, best=1.685e-03, lr=8.04e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.28it/s, loss=3.893e-02, best=1.685e-03, lr=7.64e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.28it/s, loss=7.247e-01, best=1.685e-03, lr=7.25e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.28it/s, loss=7.464e-04, best=7.464e-04, lr=8.70e-01, worse_count=0]
                                                                                                                                       
(149/208) Processing tensor: layers.29.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.921e+00, best=1.921e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.912e+00, best=1.912e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.900e+00, best=1.900e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.886e+00, best=1.886e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.869e+00, best=1.869e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.849e+00, best=1.849e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.825e+00, best=1.825e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.796e+00, best=1.796e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.761e+00, best=1.761e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.719e+00, best=1.719e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.669e+00, best=1.669e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.609e+00, best=1.609e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.537e+00, best=1.537e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.450e+00, best=1.450e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.346e+00, best=1.346e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.221e+00, best=1.221e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.072e+00, best=1.072e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.919e-01, best=8.919e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.763e-01, best=6.763e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.176e-01, best=4.176e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=4.176e-01, best=4.176e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=1.071e-01, best=1.071e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=2.655e-01, best=1.071e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=8.849e-02, best=8.849e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=3.362e-01, best=8.849e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=6.726e-02, best=6.726e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=4.169e-01, best=6.726e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=4.305e-02, best=4.305e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=5.089e-01, best=4.305e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=1.545e-02, best=1.545e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=6.138e-01, best=1.545e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=1.602e-02, best=1.545e-02, lr=5.68e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=5.519e-01, best=1.545e-02, lr=5.39e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=1.238e-02, best=1.238e-02, lr=6.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=6.350e-01, best=1.238e-02, lr=6.15e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=1.999e-02, best=1.238e-02, lr=5.84e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=5.643e-01, best=1.238e-02, lr=5.55e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=9.222e-03, best=9.222e-03, lr=6.66e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=6.569e-01, best=9.222e-03, lr=6.33e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=2.408e-02, best=9.222e-03, lr=6.01e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.17it/s, loss=5.771e-01, best=9.222e-03, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 188.35it/s, loss=5.771e-01, best=9.222e-03, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 188.35it/s, loss=5.975e-03, best=5.975e-03, lr=6.85e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 188.35it/s, loss=6.793e-01, best=5.975e-03, lr=6.51e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 188.35it/s, loss=2.829e-02, best=5.975e-03, lr=6.18e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 188.35it/s, loss=5.902e-01, best=5.975e-03, lr=5.88e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 188.35it/s, loss=2.634e-03, best=2.634e-03, lr=7.05e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 188.35it/s, loss=7.025e-01, best=2.634e-03, lr=6.70e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 188.35it/s, loss=3.262e-02, best=2.634e-03, lr=6.36e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 188.35it/s, loss=6.037e-01, best=2.634e-03, lr=6.04e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 188.35it/s, loss=8.039e-04, best=8.039e-04, lr=7.25e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 188.35it/s, loss=7.246e-01, best=8.039e-04, lr=6.89e-01, worse_count=1]
                                                                                                                                       
(150/208) Processing tensor: layers.29.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.645e+00, best=1.645e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.635e+00, best=1.635e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.623e+00, best=1.623e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.609e+00, best=1.609e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.592e+00, best=1.592e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.572e+00, best=1.572e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.548e+00, best=1.548e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.519e+00, best=1.519e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.484e+00, best=1.484e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.442e+00, best=1.442e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.392e+00, best=1.392e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.332e+00, best=1.332e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.260e+00, best=1.260e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.173e+00, best=1.173e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.069e+00, best=1.069e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.446e-01, best=9.446e-01, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.948e-01, best=7.948e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.151e-01, best=6.151e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.995e-01, best=3.995e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=3.995e-01, best=3.995e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=1.408e-01, best=1.408e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=1.697e-01, best=1.408e-01, lr=2.95e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=1.253e-01, best=1.253e-01, lr=3.54e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=2.287e-01, best=1.253e-01, lr=3.36e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=1.076e-01, best=1.076e-01, lr=4.03e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=2.959e-01, best=1.076e-01, lr=3.83e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=8.741e-02, best=8.741e-02, lr=4.60e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=3.726e-01, best=8.741e-02, lr=4.37e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=6.441e-02, best=6.441e-02, lr=5.24e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=4.600e-01, best=6.441e-02, lr=4.98e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=3.819e-02, best=3.819e-02, lr=5.98e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=5.596e-01, best=3.819e-02, lr=5.68e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=8.301e-03, best=8.301e-03, lr=6.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=6.732e-01, best=8.301e-03, lr=6.47e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=2.577e-02, best=8.301e-03, lr=6.15e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=5.893e-01, best=8.301e-03, lr=5.84e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=4.978e-03, best=4.978e-03, lr=7.01e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=6.962e-01, best=4.978e-03, lr=6.66e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.16it/s, loss=3.008e-02, best=4.978e-03, lr=6.33e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.32it/s, loss=3.008e-02, best=4.978e-03, lr=6.33e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.32it/s, loss=6.027e-01, best=4.978e-03, lr=6.01e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.32it/s, loss=1.560e-03, best=1.560e-03, lr=7.21e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.32it/s, loss=7.198e-01, best=1.560e-03, lr=6.85e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.32it/s, loss=3.451e-02, best=1.560e-03, lr=6.51e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.32it/s, loss=6.165e-01, best=1.560e-03, lr=6.18e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.32it/s, loss=1.956e-03, best=1.560e-03, lr=5.88e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.32it/s, loss=5.856e-01, best=1.560e-03, lr=5.58e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.32it/s, loss=2.742e-02, best=1.560e-03, lr=5.30e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.32it/s, loss=5.029e-01, best=1.560e-03, lr=5.04e-01, worse_count=7]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.32it/s, loss=9.082e-04, best=9.082e-04, lr=6.04e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.32it/s, loss=6.036e-01, best=9.082e-04, lr=5.74e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.32it/s, loss=2.932e-02, best=9.082e-04, lr=5.46e-01, worse_count=2]
                                                                                                                                       
(151/208) Processing tensor: layers.29.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.923e+00, best=1.923e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.913e+00, best=1.913e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.902e+00, best=1.902e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.888e+00, best=1.888e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.871e+00, best=1.871e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.851e+00, best=1.851e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.827e+00, best=1.827e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.798e+00, best=1.798e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.763e+00, best=1.763e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.721e+00, best=1.721e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.671e+00, best=1.671e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.611e+00, best=1.611e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.538e+00, best=1.538e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.452e+00, best=1.452e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.348e+00, best=1.348e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.223e+00, best=1.223e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.073e+00, best=1.073e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.936e-01, best=8.936e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.780e-01, best=6.780e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.193e-01, best=4.193e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=4.193e-01, best=4.193e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=1.088e-01, best=1.088e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=2.638e-01, best=1.088e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=9.018e-02, best=9.018e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=3.346e-01, best=9.018e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=6.894e-02, best=6.894e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=4.153e-01, best=6.894e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=4.473e-02, best=4.473e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=5.073e-01, best=4.473e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=1.713e-02, best=1.713e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=6.121e-01, best=1.713e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=1.433e-02, best=1.433e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=7.030e-01, best=1.433e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=2.153e-02, best=1.433e-02, lr=6.47e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=6.259e-01, best=1.433e-02, lr=6.15e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=1.084e-02, best=1.084e-02, lr=7.38e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=7.272e-01, best=1.084e-02, lr=7.01e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=2.607e-02, best=1.084e-02, lr=6.66e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=6.400e-01, best=1.084e-02, lr=6.33e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=7.239e-03, best=7.239e-03, lr=7.59e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 194.15it/s, loss=7.521e-01, best=7.239e-03, lr=7.21e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.96it/s, loss=7.521e-01, best=7.239e-03, lr=7.21e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.96it/s, loss=3.073e-02, best=7.239e-03, lr=6.85e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.96it/s, loss=6.546e-01, best=7.239e-03, lr=6.51e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.96it/s, loss=3.537e-03, best=3.537e-03, lr=7.81e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.96it/s, loss=7.777e-01, best=3.537e-03, lr=7.42e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.96it/s, loss=3.553e-02, best=3.537e-03, lr=7.05e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.96it/s, loss=6.696e-01, best=3.537e-03, lr=6.70e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.96it/s, loss=2.729e-04, best=2.729e-04, lr=8.04e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.96it/s, loss=8.035e-01, best=2.729e-04, lr=7.64e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.96it/s, loss=3.992e-02, best=2.729e-04, lr=7.25e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.96it/s, loss=6.855e-01, best=2.729e-04, lr=6.89e-01, worse_count=3]
                                                                                                                                       
(152/208) Skipping tensor: layers.3.adaLN_modulation.0.weight (Reason: In high-precision list)
(153/208) Processing tensor: layers.3.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.483e+00, best=1.483e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.474e+00, best=1.474e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.463e+00, best=1.463e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.451e+00, best=1.451e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.438e+00, best=1.438e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.422e+00, best=1.422e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.404e+00, best=1.404e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.384e+00, best=1.384e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.361e+00, best=1.361e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.335e+00, best=1.335e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.304e+00, best=1.304e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.270e+00, best=1.270e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.231e+00, best=1.231e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.187e+00, best=1.187e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.136e+00, best=1.136e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.078e+00, best=1.078e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.012e+00, best=1.012e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.372e-01, best=9.372e-01, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.516e-01, best=8.516e-01, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.540e-01, best=7.540e-01, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.427e-01, best=6.427e-01, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.158e-01, best=5.158e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.711e-01, best=3.711e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.062e-01, best=2.062e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.826e-02, best=1.826e-02, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.960e-01, best=1.826e-02, lr=1.93e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.632e-03, best=2.632e-03, lr=2.20e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.178e-01, best=2.632e-03, lr=1.99e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.886e-02, best=2.632e-03, lr=1.80e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.607e-01, best=2.632e-03, lr=1.62e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.355e-03, best=1.355e-03, lr=1.85e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.834e-01, best=1.355e-03, lr=1.67e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.666e-02, best=1.355e-03, lr=1.50e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.338e-01, best=1.355e-03, lr=1.36e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.986e-03, best=1.355e-03, lr=1.23e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.206e-01, best=1.355e-03, lr=1.11e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.965e-03, best=1.355e-03, lr=9.98e-02, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.987e-02, best=1.355e-03, lr=9.01e-02, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.306e-04, best=2.306e-04, lr=1.03e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.025e-01, best=2.306e-04, lr=9.27e-02, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.785e-03, best=2.306e-04, lr=8.37e-02, worse_count=2]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 402.09it/s, loss=9.785e-03, best=2.306e-04, lr=8.37e-02, worse_count=2]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 402.09it/s, loss=7.388e-02, best=2.306e-04, lr=7.55e-02, worse_count=3]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 402.09it/s, loss=1.627e-03, best=2.306e-04, lr=6.81e-02, worse_count=4]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 402.09it/s, loss=6.652e-02, best=2.306e-04, lr=6.15e-02, worse_count=5]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 402.09it/s, loss=5.017e-03, best=2.306e-04, lr=5.55e-02, worse_count=6]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 402.09it/s, loss=5.049e-02, best=2.306e-04, lr=5.01e-02, worse_count=7]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 402.09it/s, loss=3.947e-04, best=2.306e-04, lr=4.52e-02, worse_count=8]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 402.09it/s, loss=4.481e-02, best=2.306e-04, lr=4.08e-02, worse_count=9]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 402.09it/s, loss=4.013e-03, best=2.306e-04, lr=3.68e-02, worse_count=10]
    Optimizing (Original):  82%|████████▏ | 41/50 [00:00<00:00, 402.09it/s, loss=3.281e-02, best=2.306e-04, lr=3.32e-02, worse_count=11]
                                                                                                                                        
(154/208) Processing tensor: layers.3.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.743e+00, best=1.743e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.733e+00, best=1.733e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.721e+00, best=1.721e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.707e+00, best=1.707e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.691e+00, best=1.691e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.670e+00, best=1.670e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.646e+00, best=1.646e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.617e+00, best=1.617e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.582e+00, best=1.582e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.541e+00, best=1.541e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.490e+00, best=1.490e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.430e+00, best=1.430e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.358e+00, best=1.358e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.271e+00, best=1.271e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.167e+00, best=1.167e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.043e+00, best=1.043e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.929e-01, best=8.929e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.132e-01, best=7.132e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=7.132e-01, best=7.132e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=4.976e-01, best=4.976e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=2.389e-01, best=2.389e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=7.160e-02, best=7.160e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=3.010e-01, best=7.160e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=5.298e-02, best=5.298e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=3.718e-01, best=5.298e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=3.174e-02, best=3.174e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=4.525e-01, best=3.174e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=7.529e-03, best=7.529e-03, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=5.445e-01, best=7.529e-03, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=2.007e-02, best=7.529e-03, lr=4.98e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=4.781e-01, best=7.529e-03, lr=4.73e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=4.838e-03, best=4.838e-03, lr=5.68e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=5.631e-01, best=4.838e-03, lr=5.39e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=2.356e-02, best=4.838e-03, lr=5.13e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=4.890e-01, best=4.838e-03, lr=4.87e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=2.069e-03, best=2.069e-03, lr=5.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.36it/s, loss=5.822e-01, best=2.069e-03, lr=5.55e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.31it/s, loss=5.822e-01, best=2.069e-03, lr=5.55e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.31it/s, loss=2.715e-02, best=2.069e-03, lr=5.27e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.31it/s, loss=5.002e-01, best=2.069e-03, lr=5.01e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.31it/s, loss=7.793e-04, best=7.793e-04, lr=6.01e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.31it/s, loss=6.004e-01, best=7.793e-04, lr=5.71e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.31it/s, loss=2.928e-02, best=7.793e-04, lr=5.43e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.31it/s, loss=5.133e-01, best=7.793e-04, lr=5.15e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.31it/s, loss=2.151e-03, best=7.793e-04, lr=4.90e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.31it/s, loss=4.875e-01, best=7.793e-04, lr=4.65e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.31it/s, loss=2.233e-02, best=7.793e-04, lr=4.42e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.31it/s, loss=4.196e-01, best=7.793e-04, lr=4.20e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.31it/s, loss=2.363e-04, best=2.363e-04, lr=5.04e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.31it/s, loss=5.035e-01, best=2.363e-04, lr=4.79e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.31it/s, loss=2.495e-02, best=2.363e-04, lr=4.55e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.31it/s, loss=4.297e-01, best=2.363e-04, lr=4.32e-01, worse_count=3]
                                                                                                                                       
(155/208) Processing tensor: layers.3.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.730e+00, best=1.730e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.721e+00, best=1.721e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.709e+00, best=1.709e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.695e+00, best=1.695e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.678e+00, best=1.678e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.658e+00, best=1.658e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.634e+00, best=1.634e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.605e+00, best=1.605e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.570e+00, best=1.570e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.528e+00, best=1.528e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.478e+00, best=1.478e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.418e+00, best=1.418e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.346e+00, best=1.346e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.259e+00, best=1.259e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.155e+00, best=1.155e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.030e+00, best=1.030e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.806e-01, best=8.806e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.009e-01, best=7.009e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.853e-01, best=4.853e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.266e-01, best=2.266e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=2.266e-01, best=2.266e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=8.391e-02, best=8.391e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=2.887e-01, best=8.391e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=6.528e-02, best=6.528e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=3.595e-01, best=6.528e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=4.404e-02, best=4.404e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=4.402e-01, best=4.404e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=1.983e-02, best=1.983e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=5.322e-01, best=1.983e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=7.770e-03, best=7.770e-03, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=6.215e-01, best=7.770e-03, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=2.369e-02, best=7.770e-03, lr=5.68e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=5.442e-01, best=7.770e-03, lr=5.39e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=4.702e-03, best=4.702e-03, lr=6.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=6.427e-01, best=4.702e-03, lr=6.15e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=2.767e-02, best=4.702e-03, lr=5.84e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=5.566e-01, best=4.702e-03, lr=5.55e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=1.546e-03, best=1.546e-03, lr=6.66e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=6.646e-01, best=1.546e-03, lr=6.33e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=3.176e-02, best=1.546e-03, lr=6.01e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.78it/s, loss=5.694e-01, best=1.546e-03, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.61it/s, loss=5.694e-01, best=1.546e-03, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.61it/s, loss=1.702e-03, best=1.546e-03, lr=5.43e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.61it/s, loss=5.408e-01, best=1.546e-03, lr=5.15e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.61it/s, loss=2.543e-02, best=1.546e-03, lr=4.90e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.61it/s, loss=4.642e-01, best=1.546e-03, lr=4.65e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.61it/s, loss=9.433e-04, best=9.433e-04, lr=5.58e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.61it/s, loss=5.573e-01, best=9.433e-04, lr=5.30e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.61it/s, loss=2.697e-02, best=9.433e-04, lr=5.04e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.61it/s, loss=4.768e-01, best=9.433e-04, lr=4.79e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.61it/s, loss=1.778e-03, best=9.433e-04, lr=4.55e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.61it/s, loss=4.529e-01, best=9.433e-04, lr=4.32e-01, worse_count=5]
                                                                                                                                       
(156/208) Processing tensor: layers.3.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.810e+00, best=1.810e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.800e+00, best=1.800e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.789e+00, best=1.789e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.775e+00, best=1.775e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.758e+00, best=1.758e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.738e+00, best=1.738e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.714e+00, best=1.714e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.685e+00, best=1.685e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.650e+00, best=1.650e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.608e+00, best=1.608e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.558e+00, best=1.558e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.498e+00, best=1.498e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.425e+00, best=1.425e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.339e+00, best=1.339e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.235e+00, best=1.235e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.110e+00, best=1.110e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.604e-01, best=9.604e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.807e-01, best=7.807e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.651e-01, best=5.651e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=5.651e-01, best=5.651e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=3.063e-01, best=3.063e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=4.149e-03, best=4.149e-03, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=3.684e-01, best=4.149e-03, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=1.448e-02, best=4.149e-03, lr=3.36e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=3.218e-01, best=4.149e-03, lr=3.19e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=2.332e-03, best=2.332e-03, lr=3.83e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=3.810e-01, best=2.332e-03, lr=3.64e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=1.683e-02, best=2.332e-03, lr=3.46e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=3.291e-01, best=2.332e-03, lr=3.29e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=4.639e-04, best=4.639e-04, lr=3.94e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=3.939e-01, best=4.639e-04, lr=3.75e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=1.926e-02, best=4.639e-04, lr=3.56e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=3.367e-01, best=4.639e-04, lr=3.38e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=1.459e-03, best=4.639e-04, lr=3.21e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=3.198e-01, best=4.639e-04, lr=3.05e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=1.460e-02, best=4.639e-04, lr=2.90e-01, worse_count=6]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=2.753e-01, best=4.639e-04, lr=2.75e-01, worse_count=7]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=1.080e-04, best=1.080e-04, lr=3.30e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=3.304e-01, best=1.080e-04, lr=3.14e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.30it/s, loss=1.642e-02, best=1.080e-04, lr=2.98e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.32it/s, loss=1.642e-02, best=1.080e-04, lr=2.98e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.32it/s, loss=2.819e-01, best=1.080e-04, lr=2.83e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.32it/s, loss=1.503e-03, best=1.080e-04, lr=2.69e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.32it/s, loss=2.677e-01, best=1.080e-04, lr=2.56e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.32it/s, loss=1.196e-02, best=1.080e-04, lr=2.43e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.32it/s, loss=2.310e-01, best=1.080e-04, lr=2.31e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.32it/s, loss=1.912e-04, best=1.080e-04, lr=2.19e-01, worse_count=8]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.32it/s, loss=2.191e-01, best=1.080e-04, lr=2.08e-01, worse_count=9]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.32it/s, loss=1.077e-02, best=1.080e-04, lr=1.98e-01, worse_count=10]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.32it/s, loss=1.871e-01, best=1.080e-04, lr=1.88e-01, worse_count=11]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.32it/s, loss=8.778e-04, best=1.080e-04, lr=1.79e-01, worse_count=12]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.32it/s, loss=1.777e-01, best=1.080e-04, lr=1.70e-01, worse_count=13]
                                                                                                                                        
(157/208) Processing tensor: layers.3.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.694e+00, best=2.694e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.684e+00, best=2.684e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.672e+00, best=2.672e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.658e+00, best=2.658e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.642e+00, best=2.642e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.621e+00, best=2.621e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.597e+00, best=2.597e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.568e+00, best=2.568e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.533e+00, best=2.533e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.492e+00, best=2.492e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.441e+00, best=2.441e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.381e+00, best=2.381e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.309e+00, best=2.309e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.222e+00, best=2.222e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.118e+00, best=2.118e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.994e+00, best=1.994e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.844e+00, best=1.844e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.664e+00, best=1.664e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.449e+00, best=1.449e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=1.449e+00, best=1.449e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=1.190e+00, best=1.190e+00, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=8.794e-01, best=8.794e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=5.068e-01, best=5.068e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=5.976e-02, best=5.976e-02, lr=5.36e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=4.768e-01, best=5.976e-02, lr=5.10e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=3.293e-02, best=3.293e-02, lr=6.12e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=5.787e-01, best=3.293e-02, lr=5.81e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=2.351e-03, best=2.351e-03, lr=6.97e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=6.949e-01, best=2.351e-03, lr=6.62e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=3.251e-02, best=2.351e-03, lr=6.29e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=5.968e-01, best=2.351e-03, lr=5.98e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=1.049e-03, best=1.049e-03, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=7.163e-01, best=1.049e-03, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=3.482e-02, best=1.049e-03, lr=6.47e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=6.126e-01, best=1.049e-03, lr=6.15e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=2.449e-03, best=1.049e-03, lr=5.84e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=5.818e-01, best=1.049e-03, lr=5.55e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=2.677e-02, best=1.049e-03, lr=5.27e-01, worse_count=6]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=5.006e-01, best=1.049e-03, lr=5.01e-01, worse_count=7]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.30it/s, loss=4.006e-04, best=4.006e-04, lr=6.01e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.14it/s, loss=4.006e-04, best=4.006e-04, lr=6.01e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.14it/s, loss=6.008e-01, best=4.006e-04, lr=5.71e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.14it/s, loss=2.966e-02, best=4.006e-04, lr=5.43e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.14it/s, loss=5.129e-01, best=4.006e-04, lr=5.15e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.14it/s, loss=2.530e-03, best=4.006e-04, lr=4.90e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.14it/s, loss=4.871e-01, best=4.006e-04, lr=4.65e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.14it/s, loss=2.195e-02, best=4.006e-04, lr=4.42e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.14it/s, loss=4.200e-01, best=4.006e-04, lr=4.20e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.14it/s, loss=1.442e-04, best=1.442e-04, lr=5.04e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.14it/s, loss=5.036e-01, best=1.442e-04, lr=4.79e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.14it/s, loss=2.504e-02, best=1.442e-04, lr=4.55e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.14it/s, loss=4.296e-01, best=1.442e-04, lr=4.32e-01, worse_count=3]
                                                                                                                                       
(158/208) Skipping tensor: layers.4.adaLN_modulation.0.weight (Reason: In high-precision list)
(159/208) Processing tensor: layers.4.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.025e+00, best=2.025e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.016e+00, best=2.016e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.006e+00, best=2.006e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.994e+00, best=1.994e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.980e+00, best=1.980e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.964e+00, best=1.964e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.947e+00, best=1.947e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.926e+00, best=1.926e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.903e+00, best=1.903e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.877e+00, best=1.877e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.847e+00, best=1.847e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.813e+00, best=1.813e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.774e+00, best=1.774e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.729e+00, best=1.729e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.678e+00, best=1.678e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.621e+00, best=1.621e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.555e+00, best=1.555e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.480e+00, best=1.480e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.394e+00, best=1.394e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.296e+00, best=1.296e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.185e+00, best=1.185e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.058e+00, best=1.058e+00, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.135e-01, best=9.135e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.486e-01, best=7.486e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.606e-01, best=5.606e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.463e-01, best=3.463e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.020e-01, best=1.020e-01, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.765e-01, best=1.020e-01, lr=2.51e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.487e-02, best=7.487e-02, lr=2.87e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.117e-01, best=7.487e-02, lr=2.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.693e-02, best=4.693e-02, lr=2.95e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.479e-01, best=4.693e-02, lr=2.66e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.819e-02, best=1.819e-02, lr=3.03e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.851e-01, best=1.819e-02, lr=2.74e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.138e-02, best=1.138e-02, lr=3.12e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.007e-01, best=1.138e-02, lr=2.82e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.904e-02, best=1.138e-02, lr=2.54e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.351e-01, best=1.138e-02, lr=2.29e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.740e-03, best=5.740e-03, lr=2.61e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.558e-01, best=5.740e-03, lr=2.36e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.976e-02, best=5.740e-03, lr=2.13e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.932e-01, best=5.740e-03, lr=1.92e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.010e-03, best=1.010e-03, lr=2.19e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.181e-01, best=1.010e-03, lr=1.98e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.036e-02, best=1.010e-03, lr=1.78e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.581e-01, best=1.010e-03, lr=1.61e-01, worse_count=3]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 459.65it/s, loss=1.581e-01, best=1.010e-03, lr=1.61e-01, worse_count=3]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 459.65it/s, loss=2.953e-03, best=1.010e-03, lr=1.45e-01, worse_count=4]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 459.65it/s, loss=1.424e-01, best=1.010e-03, lr=1.31e-01, worse_count=5]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 459.65it/s, loss=1.122e-02, best=1.010e-03, lr=1.18e-01, worse_count=6]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 459.65it/s, loss=1.072e-01, best=1.010e-03, lr=1.07e-01, worse_count=7]
                                                                                                                                       
(160/208) Processing tensor: layers.4.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.808e+00, best=1.808e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.798e+00, best=1.798e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.786e+00, best=1.786e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.772e+00, best=1.772e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.755e+00, best=1.755e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.735e+00, best=1.735e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.711e+00, best=1.711e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.682e+00, best=1.682e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.647e+00, best=1.647e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.605e+00, best=1.605e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.555e+00, best=1.555e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.495e+00, best=1.495e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.423e+00, best=1.423e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.336e+00, best=1.336e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.232e+00, best=1.232e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.107e+00, best=1.107e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.578e-01, best=9.578e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=9.578e-01, best=9.578e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=7.781e-01, best=7.781e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=5.625e-01, best=5.625e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=3.037e-01, best=3.037e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=6.735e-03, best=6.735e-03, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=3.658e-01, best=6.735e-03, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=1.189e-02, best=6.735e-03, lr=3.36e-01, worse_count=2]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=3.244e-01, best=6.735e-03, lr=3.19e-01, worse_count=3]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=4.919e-03, best=4.919e-03, lr=3.83e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=3.784e-01, best=4.919e-03, lr=3.64e-01, worse_count=1]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=1.425e-02, best=4.919e-03, lr=3.46e-01, worse_count=2]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=3.317e-01, best=4.919e-03, lr=3.29e-01, worse_count=3]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=3.050e-03, best=3.050e-03, lr=3.94e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=3.913e-01, best=3.050e-03, lr=3.75e-01, worse_count=1]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=1.667e-02, best=3.050e-03, lr=3.56e-01, worse_count=2]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=3.393e-01, best=3.050e-03, lr=3.38e-01, worse_count=3]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=1.127e-03, best=1.127e-03, lr=4.06e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=4.046e-01, best=1.127e-03, lr=3.85e-01, worse_count=1]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=1.916e-02, best=1.127e-03, lr=3.66e-01, worse_count=2]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.57it/s, loss=3.470e-01, best=1.127e-03, lr=3.48e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.93it/s, loss=3.470e-01, best=1.127e-03, lr=3.48e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.93it/s, loss=8.508e-04, best=8.508e-04, lr=4.17e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.93it/s, loss=4.166e-01, best=8.508e-04, lr=3.97e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.93it/s, loss=2.002e-02, best=8.508e-04, lr=3.77e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.93it/s, loss=3.567e-01, best=8.508e-04, lr=3.58e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.93it/s, loss=1.184e-03, best=8.508e-04, lr=3.40e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.93it/s, loss=3.388e-01, best=8.508e-04, lr=3.23e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.93it/s, loss=1.582e-02, best=8.508e-04, lr=3.07e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.93it/s, loss=2.911e-01, best=8.508e-04, lr=2.92e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.93it/s, loss=4.734e-04, best=4.734e-04, lr=3.50e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.93it/s, loss=3.494e-01, best=4.734e-04, lr=3.32e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.93it/s, loss=1.702e-02, best=4.734e-04, lr=3.16e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.93it/s, loss=2.987e-01, best=4.734e-04, lr=3.00e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.93it/s, loss=1.232e-03, best=4.734e-04, lr=2.85e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.93it/s, loss=2.837e-01, best=4.734e-04, lr=2.71e-01, worse_count=5]
                                                                                                                                       
(161/208) Processing tensor: layers.4.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.900e+00, best=1.900e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.890e+00, best=1.890e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.879e+00, best=1.879e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.865e+00, best=1.865e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.848e+00, best=1.848e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.828e+00, best=1.828e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.804e+00, best=1.804e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.774e+00, best=1.774e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.740e+00, best=1.740e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.698e+00, best=1.698e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.648e+00, best=1.648e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.588e+00, best=1.588e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.515e+00, best=1.515e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.429e+00, best=1.429e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.325e+00, best=1.325e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.200e+00, best=1.200e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.050e+00, best=1.050e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.705e-01, best=8.705e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.549e-01, best=6.549e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.962e-01, best=3.962e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=3.962e-01, best=3.962e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=8.571e-02, best=8.571e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=2.869e-01, best=8.571e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=6.708e-02, best=6.708e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=3.577e-01, best=6.708e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=4.585e-02, best=4.585e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=4.384e-01, best=4.585e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=2.164e-02, best=2.164e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=5.304e-01, best=2.164e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=5.963e-03, best=5.963e-03, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=6.233e-01, best=5.963e-03, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=2.550e-02, best=5.963e-03, lr=5.68e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=5.424e-01, best=5.963e-03, lr=5.39e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=2.895e-03, best=2.895e-03, lr=6.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=6.445e-01, best=2.895e-03, lr=6.15e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=2.948e-02, best=2.895e-03, lr=5.84e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=5.548e-01, best=2.895e-03, lr=5.55e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=2.622e-04, best=2.622e-04, lr=6.66e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=6.658e-01, best=2.622e-04, lr=6.33e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=3.304e-02, best=2.622e-04, lr=6.01e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.71it/s, loss=5.681e-01, best=2.622e-04, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.44it/s, loss=5.681e-01, best=2.622e-04, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.44it/s, loss=2.985e-03, best=2.622e-04, lr=5.43e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.44it/s, loss=5.396e-01, best=2.622e-04, lr=5.15e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.44it/s, loss=2.414e-02, best=2.622e-04, lr=4.90e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.44it/s, loss=4.655e-01, best=2.622e-04, lr=4.65e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.44it/s, loss=3.407e-04, best=2.622e-04, lr=4.42e-01, worse_count=8]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.44it/s, loss=4.416e-01, best=2.622e-04, lr=4.20e-01, worse_count=9]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.44it/s, loss=2.175e-02, best=2.622e-04, lr=3.99e-01, worse_count=10]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.44it/s, loss=3.771e-01, best=2.622e-04, lr=3.79e-01, worse_count=11]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.44it/s, loss=1.814e-03, best=2.622e-04, lr=3.60e-01, worse_count=12]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 192.44it/s, loss=3.581e-01, best=2.622e-04, lr=3.42e-01, worse_count=13]
                                                                                                                                        
(162/208) Processing tensor: layers.4.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.748e+00, best=1.748e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.739e+00, best=1.739e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.727e+00, best=1.727e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.713e+00, best=1.713e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.696e+00, best=1.696e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.676e+00, best=1.676e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.652e+00, best=1.652e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.623e+00, best=1.623e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.588e+00, best=1.588e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.546e+00, best=1.546e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.496e+00, best=1.496e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.436e+00, best=1.436e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.364e+00, best=1.364e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.277e+00, best=1.277e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.173e+00, best=1.173e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.048e+00, best=1.048e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.985e-01, best=8.985e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.188e-01, best=7.188e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.032e-01, best=5.032e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=5.032e-01, best=5.032e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=2.444e-01, best=2.444e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=6.606e-02, best=6.606e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=3.065e-01, best=6.606e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=4.743e-02, best=4.743e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=3.773e-01, best=4.743e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=2.619e-02, best=2.619e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=4.580e-01, best=2.619e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=1.979e-03, best=1.979e-03, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=5.500e-01, best=1.979e-03, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=2.562e-02, best=1.979e-03, lr=4.98e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=4.726e-01, best=1.979e-03, lr=4.73e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=7.125e-04, best=7.125e-04, lr=5.68e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=5.672e-01, best=7.125e-04, lr=5.39e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=2.768e-02, best=7.125e-04, lr=5.13e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=4.849e-01, best=7.125e-04, lr=4.87e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=2.056e-03, best=7.125e-04, lr=4.63e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=4.605e-01, best=7.125e-04, lr=4.39e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=2.107e-02, best=7.125e-04, lr=4.17e-01, worse_count=6]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=3.964e-01, best=7.125e-04, lr=3.97e-01, worse_count=7]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.78it/s, loss=1.995e-04, best=1.995e-04, lr=4.76e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.49it/s, loss=1.995e-04, best=1.995e-04, lr=4.76e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.49it/s, loss=4.757e-01, best=1.995e-04, lr=4.52e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.49it/s, loss=2.360e-02, best=1.995e-04, lr=4.29e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.49it/s, loss=4.059e-01, best=1.995e-04, lr=4.08e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.49it/s, loss=2.121e-03, best=1.995e-04, lr=3.88e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.49it/s, loss=3.855e-01, best=1.995e-04, lr=3.68e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.49it/s, loss=1.726e-02, best=1.995e-04, lr=3.50e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.49it/s, loss=3.326e-01, best=1.995e-04, lr=3.32e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.49it/s, loss=2.312e-04, best=1.995e-04, lr=3.16e-01, worse_count=8]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.49it/s, loss=3.155e-01, best=1.995e-04, lr=3.00e-01, worse_count=9]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.49it/s, loss=1.556e-02, best=1.995e-04, lr=2.85e-01, worse_count=10]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.49it/s, loss=2.694e-01, best=1.995e-04, lr=2.71e-01, worse_count=11]
                                                                                                                                        
(163/208) Processing tensor: layers.4.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.813e+00, best=3.813e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.804e+00, best=3.804e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.792e+00, best=3.792e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.778e+00, best=3.778e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.761e+00, best=3.761e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.741e+00, best=3.741e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.717e+00, best=3.717e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.688e+00, best=3.688e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.653e+00, best=3.653e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.611e+00, best=3.611e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.561e+00, best=3.561e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.501e+00, best=3.501e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.429e+00, best=3.429e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.342e+00, best=3.342e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.238e+00, best=3.238e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.113e+00, best=3.113e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.963e+00, best=2.963e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.784e+00, best=2.784e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.568e+00, best=2.568e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.309e+00, best=2.309e+00, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=2.309e+00, best=2.309e+00, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=1.999e+00, best=1.999e+00, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=1.626e+00, best=1.626e+00, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=1.179e+00, best=1.179e+00, lr=5.36e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=6.428e-01, best=6.428e-01, lr=6.44e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=9.711e-04, best=9.711e-04, lr=7.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=7.716e-01, best=9.711e-04, lr=7.34e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=3.766e-02, best=9.711e-04, lr=6.97e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=6.596e-01, best=9.711e-04, lr=6.62e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=2.795e-03, best=9.711e-04, lr=6.29e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=6.265e-01, best=9.711e-04, lr=5.98e-01, worse_count=5]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=2.867e-02, best=9.711e-04, lr=5.68e-01, worse_count=6]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=5.392e-01, best=9.711e-04, lr=5.39e-01, worse_count=7]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=2.735e-04, best=2.735e-04, lr=6.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=6.471e-01, best=2.735e-04, lr=6.15e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=3.210e-02, best=2.735e-04, lr=5.84e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=5.522e-01, best=2.735e-04, lr=5.55e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=2.883e-03, best=2.735e-04, lr=5.27e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=5.244e-01, best=2.735e-04, lr=5.01e-01, worse_count=5]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=2.348e-02, best=2.735e-04, lr=4.76e-01, worse_count=6]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 193.99it/s, loss=4.524e-01, best=2.735e-04, lr=4.52e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.59it/s, loss=4.524e-01, best=2.735e-04, lr=4.52e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.59it/s, loss=3.127e-04, best=2.735e-04, lr=4.29e-01, worse_count=8]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.59it/s, loss=4.292e-01, best=2.735e-04, lr=4.08e-01, worse_count=9]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.59it/s, loss=2.116e-02, best=2.735e-04, lr=3.88e-01, worse_count=10]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.59it/s, loss=3.665e-01, best=2.735e-04, lr=3.68e-01, worse_count=11]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.59it/s, loss=1.781e-03, best=2.735e-04, lr=3.50e-01, worse_count=12]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.59it/s, loss=3.481e-01, best=2.735e-04, lr=3.32e-01, worse_count=13]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.59it/s, loss=1.571e-02, best=2.735e-04, lr=3.16e-01, worse_count=14]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.59it/s, loss=3.000e-01, best=2.735e-04, lr=3.00e-01, worse_count=15]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.59it/s, loss=7.724e-05, best=7.724e-05, lr=3.60e-01, worse_count=0] 
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.59it/s, loss=3.598e-01, best=7.724e-05, lr=3.42e-01, worse_count=1]
                                                                                                                                       
(164/208) Skipping tensor: layers.5.adaLN_modulation.0.weight (Reason: In high-precision list)
(165/208) Processing tensor: layers.5.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.837e+00, best=1.837e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.828e+00, best=1.828e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.817e+00, best=1.817e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.805e+00, best=1.805e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.792e+00, best=1.792e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.776e+00, best=1.776e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.758e+00, best=1.758e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.738e+00, best=1.738e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.715e+00, best=1.715e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.689e+00, best=1.689e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.659e+00, best=1.659e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.624e+00, best=1.624e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.585e+00, best=1.585e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.541e+00, best=1.541e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.490e+00, best=1.490e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.432e+00, best=1.432e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.367e+00, best=1.367e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.291e+00, best=1.291e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.206e+00, best=1.206e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.108e+00, best=1.108e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.968e-01, best=9.968e-01, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.700e-01, best=8.700e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.253e-01, best=7.253e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.604e-01, best=5.604e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.724e-01, best=3.724e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.581e-01, best=1.581e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.618e-02, best=8.618e-02, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.923e-01, best=8.618e-02, lr=2.51e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.903e-02, best=5.903e-02, lr=2.87e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.275e-01, best=5.903e-02, lr=2.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.109e-02, best=3.109e-02, lr=2.95e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.637e-01, best=3.109e-02, lr=2.66e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.346e-03, best=2.346e-03, lr=3.03e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.010e-01, best=2.346e-03, lr=2.74e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.723e-02, best=2.346e-03, lr=2.47e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.198e-01, best=2.346e-03, lr=2.23e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.140e-03, best=2.346e-03, lr=2.01e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.981e-01, best=2.346e-03, lr=1.82e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.648e-02, best=2.346e-03, lr=1.64e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.474e-01, best=2.346e-03, lr=1.48e-01, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.994e-04, best=4.994e-04, lr=1.69e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.681e-01, best=4.994e-04, lr=1.52e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.594e-02, best=4.994e-04, lr=1.37e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.214e-01, best=4.994e-04, lr=1.24e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.550e-03, best=4.994e-04, lr=1.12e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.093e-01, best=4.994e-04, lr=1.01e-01, worse_count=5]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 451.03it/s, loss=1.093e-01, best=4.994e-04, lr=1.01e-01, worse_count=5]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 451.03it/s, loss=8.357e-03, best=4.994e-04, lr=9.11e-02, worse_count=6]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 451.03it/s, loss=8.276e-02, best=4.994e-04, lr=8.22e-02, worse_count=7]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 451.03it/s, loss=5.271e-04, best=4.994e-04, lr=7.42e-02, worse_count=8]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 451.03it/s, loss=7.369e-02, best=4.994e-04, lr=6.70e-02, worse_count=9]
                                                                                                                                       
(166/208) Processing tensor: layers.5.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.797e+00, best=1.797e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.788e+00, best=1.788e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.776e+00, best=1.776e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.762e+00, best=1.762e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.745e+00, best=1.745e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.725e+00, best=1.725e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.701e+00, best=1.701e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.672e+00, best=1.672e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.637e+00, best=1.637e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.595e+00, best=1.595e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.545e+00, best=1.545e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.485e+00, best=1.485e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.413e+00, best=1.413e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.326e+00, best=1.326e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.222e+00, best=1.222e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.097e+00, best=1.097e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.477e-01, best=9.477e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.680e-01, best=7.680e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=7.680e-01, best=7.680e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=5.524e-01, best=5.524e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=2.937e-01, best=2.937e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=1.679e-02, best=1.679e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=3.558e-01, best=1.679e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=1.836e-03, best=1.836e-03, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=4.229e-01, best=1.836e-03, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=1.940e-02, best=1.836e-03, lr=3.83e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=3.639e-01, best=1.836e-03, lr=3.64e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=2.354e-04, best=2.354e-04, lr=4.37e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=4.368e-01, best=2.354e-04, lr=4.15e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=2.161e-02, best=2.354e-04, lr=3.94e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=3.728e-01, best=2.354e-04, lr=3.75e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=1.895e-03, best=2.354e-04, lr=3.56e-01, worse_count=4]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=3.540e-01, best=2.354e-04, lr=3.38e-01, worse_count=5]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=1.590e-02, best=2.354e-04, lr=3.21e-01, worse_count=6]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=3.053e-01, best=2.354e-04, lr=3.05e-01, worse_count=7]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=1.604e-04, best=1.604e-04, lr=3.66e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.97it/s, loss=3.660e-01, best=1.604e-04, lr=3.48e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.87it/s, loss=3.660e-01, best=1.604e-04, lr=3.48e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.87it/s, loss=1.815e-02, best=1.604e-04, lr=3.30e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.87it/s, loss=3.123e-01, best=1.604e-04, lr=3.14e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.87it/s, loss=1.625e-03, best=1.604e-04, lr=2.98e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.87it/s, loss=2.966e-01, best=1.604e-04, lr=2.83e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.87it/s, loss=1.329e-02, best=1.604e-04, lr=2.69e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.87it/s, loss=2.559e-01, best=1.604e-04, lr=2.56e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.87it/s, loss=1.712e-04, best=1.604e-04, lr=2.43e-01, worse_count=8]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.87it/s, loss=2.428e-01, best=1.604e-04, lr=2.31e-01, worse_count=9]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.87it/s, loss=1.198e-02, best=1.604e-04, lr=2.19e-01, worse_count=10]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.87it/s, loss=2.073e-01, best=1.604e-04, lr=2.08e-01, worse_count=11]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.87it/s, loss=1.013e-03, best=1.604e-04, lr=1.98e-01, worse_count=12]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.87it/s, loss=1.969e-01, best=1.604e-04, lr=1.88e-01, worse_count=13]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.87it/s, loss=8.881e-03, best=1.604e-04, lr=1.79e-01, worse_count=14]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 176.87it/s, loss=1.697e-01, best=1.604e-04, lr=1.70e-01, worse_count=15]
                                                                                                                                        
(167/208) Processing tensor: layers.5.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.798e+00, best=1.798e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.788e+00, best=1.788e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.776e+00, best=1.776e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.762e+00, best=1.762e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.745e+00, best=1.745e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.725e+00, best=1.725e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.701e+00, best=1.701e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.672e+00, best=1.672e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.637e+00, best=1.637e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.595e+00, best=1.595e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.545e+00, best=1.545e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.485e+00, best=1.485e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.413e+00, best=1.413e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.326e+00, best=1.326e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.222e+00, best=1.222e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.097e+00, best=1.097e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.477e-01, best=9.477e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.680e-01, best=7.680e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.524e-01, best=5.524e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=5.524e-01, best=5.524e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=2.937e-01, best=2.937e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=1.680e-02, best=1.680e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=3.558e-01, best=1.680e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=1.826e-03, best=1.826e-03, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=4.229e-01, best=1.826e-03, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=1.941e-02, best=1.826e-03, lr=3.83e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=3.639e-01, best=1.826e-03, lr=3.64e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=2.456e-04, best=2.456e-04, lr=4.37e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=4.368e-01, best=2.456e-04, lr=4.15e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=2.160e-02, best=2.456e-04, lr=3.94e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=3.728e-01, best=2.456e-04, lr=3.75e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=1.885e-03, best=2.456e-04, lr=3.56e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=3.541e-01, best=2.456e-04, lr=3.38e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=1.591e-02, best=2.456e-04, lr=3.21e-01, worse_count=6]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=3.053e-01, best=2.456e-04, lr=3.05e-01, worse_count=7]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=1.502e-04, best=1.502e-04, lr=3.66e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=3.661e-01, best=1.502e-04, lr=3.48e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=1.816e-02, best=1.502e-04, lr=3.30e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=3.123e-01, best=1.502e-04, lr=3.14e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=1.635e-03, best=1.502e-04, lr=2.98e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.92it/s, loss=2.966e-01, best=1.502e-04, lr=2.83e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 197.00it/s, loss=2.966e-01, best=1.502e-04, lr=2.83e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 197.00it/s, loss=1.328e-02, best=1.502e-04, lr=2.69e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 197.00it/s, loss=2.559e-01, best=1.502e-04, lr=2.56e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 197.00it/s, loss=1.814e-04, best=1.502e-04, lr=2.43e-01, worse_count=8]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 197.00it/s, loss=2.428e-01, best=1.502e-04, lr=2.31e-01, worse_count=9]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 197.00it/s, loss=1.197e-02, best=1.502e-04, lr=2.19e-01, worse_count=10]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 197.00it/s, loss=2.073e-01, best=1.502e-04, lr=2.08e-01, worse_count=11]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 197.00it/s, loss=1.003e-03, best=1.502e-04, lr=1.98e-01, worse_count=12]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 197.00it/s, loss=1.969e-01, best=1.502e-04, lr=1.88e-01, worse_count=13]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 197.00it/s, loss=8.891e-03, best=1.502e-04, lr=1.79e-01, worse_count=14]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 197.00it/s, loss=1.697e-01, best=1.502e-04, lr=1.70e-01, worse_count=15]
                                                                                                                                        
(168/208) Processing tensor: layers.5.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.894e+00, best=1.894e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.884e+00, best=1.884e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.873e+00, best=1.873e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.859e+00, best=1.859e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.842e+00, best=1.842e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.822e+00, best=1.822e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.798e+00, best=1.798e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.769e+00, best=1.769e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.734e+00, best=1.734e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.692e+00, best=1.692e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.642e+00, best=1.642e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.582e+00, best=1.582e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.509e+00, best=1.509e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.423e+00, best=1.423e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.319e+00, best=1.319e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.194e+00, best=1.194e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.044e+00, best=1.044e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.646e-01, best=8.646e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.490e-01, best=6.490e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=6.490e-01, best=6.490e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=3.903e-01, best=3.903e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=7.979e-02, best=7.979e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=2.928e-01, best=7.979e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=6.116e-02, best=6.116e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=3.636e-01, best=6.116e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=3.993e-02, best=3.993e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=4.443e-01, best=3.993e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=1.572e-02, best=1.572e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=5.363e-01, best=1.572e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=1.188e-02, best=1.188e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=6.174e-01, best=1.188e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=1.958e-02, best=1.188e-02, lr=5.68e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=5.483e-01, best=1.188e-02, lr=5.39e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=8.816e-03, best=8.816e-03, lr=6.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=6.386e-01, best=8.816e-03, lr=6.15e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=2.356e-02, best=8.816e-03, lr=5.84e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=5.607e-01, best=8.816e-03, lr=5.55e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=5.660e-03, best=5.660e-03, lr=6.66e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=6.604e-01, best=5.660e-03, lr=6.33e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.74it/s, loss=2.765e-02, best=5.660e-03, lr=6.01e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.29it/s, loss=2.765e-02, best=5.660e-03, lr=6.01e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.29it/s, loss=5.735e-01, best=5.660e-03, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.29it/s, loss=2.413e-03, best=2.413e-03, lr=6.85e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.29it/s, loss=6.829e-01, best=2.413e-03, lr=6.51e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.29it/s, loss=3.185e-02, best=2.413e-03, lr=6.18e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.29it/s, loss=5.867e-01, best=2.413e-03, lr=5.88e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.29it/s, loss=9.288e-04, best=9.288e-04, lr=7.05e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.29it/s, loss=7.042e-01, best=9.288e-04, lr=6.70e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.29it/s, loss=3.433e-02, best=9.288e-04, lr=6.36e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.29it/s, loss=6.020e-01, best=9.288e-04, lr=6.04e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.29it/s, loss=2.509e-03, best=9.288e-04, lr=5.74e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.29it/s, loss=5.718e-01, best=9.288e-04, lr=5.46e-01, worse_count=5]
                                                                                                                                       
(169/208) Processing tensor: layers.5.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.925e+00, best=2.925e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.915e+00, best=2.915e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.903e+00, best=2.903e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.889e+00, best=2.889e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.872e+00, best=2.872e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.852e+00, best=2.852e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.828e+00, best=2.828e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.799e+00, best=2.799e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.764e+00, best=2.764e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.722e+00, best=2.722e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.672e+00, best=2.672e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.612e+00, best=2.612e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.540e+00, best=2.540e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.453e+00, best=2.453e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.349e+00, best=2.349e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.225e+00, best=2.225e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.075e+00, best=2.075e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.895e+00, best=1.895e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.680e+00, best=1.680e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.421e+00, best=1.421e+00, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=1.421e+00, best=1.421e+00, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=1.110e+00, best=1.110e+00, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=7.378e-01, best=7.378e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=2.907e-01, best=2.907e-01, lr=5.36e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=2.458e-01, best=2.458e-01, lr=6.44e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=3.980e-01, best=2.458e-01, lr=6.12e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=2.136e-01, best=2.136e-01, lr=7.34e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=5.203e-01, best=2.136e-01, lr=6.97e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=1.769e-01, best=1.769e-01, lr=8.37e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=6.598e-01, best=1.769e-01, lr=7.95e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=1.351e-01, best=1.351e-01, lr=9.54e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=8.187e-01, best=1.351e-01, lr=9.06e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=8.740e-02, best=8.740e-02, lr=1.09e+00, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=1.000e+00, best=8.740e-02, lr=1.03e+00, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=3.304e-02, best=3.304e-02, lr=1.24e+00, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=1.207e+00, best=3.304e-02, lr=1.18e+00, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=2.894e-02, best=2.894e-02, lr=1.41e+00, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=1.384e+00, best=2.894e-02, lr=1.34e+00, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=4.171e-02, best=2.894e-02, lr=1.28e+00, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=1.234e+00, best=2.894e-02, lr=1.21e+00, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.29it/s, loss=2.205e-02, best=2.205e-02, lr=1.45e+00, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.26it/s, loss=2.205e-02, best=2.205e-02, lr=1.45e+00, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.26it/s, loss=1.432e+00, best=2.205e-02, lr=1.38e+00, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.26it/s, loss=5.064e-02, best=2.205e-02, lr=1.31e+00, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.26it/s, loss=1.262e+00, best=2.205e-02, lr=1.25e+00, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.26it/s, loss=1.497e-02, best=1.497e-02, lr=1.50e+00, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.26it/s, loss=1.481e+00, best=1.497e-02, lr=1.42e+00, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.26it/s, loss=5.983e-02, best=1.497e-02, lr=1.35e+00, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.26it/s, loss=1.290e+00, best=1.497e-02, lr=1.28e+00, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.26it/s, loss=7.674e-03, best=7.674e-03, lr=1.54e+00, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.26it/s, loss=1.531e+00, best=7.674e-03, lr=1.46e+00, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 193.26it/s, loss=6.928e-02, best=7.674e-03, lr=1.39e+00, worse_count=2]
                                                                                                                                       
(170/208) Skipping tensor: layers.6.adaLN_modulation.0.weight (Reason: In high-precision list)
(171/208) Processing tensor: layers.6.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.850e+00, best=1.850e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.841e+00, best=1.841e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.831e+00, best=1.831e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.819e+00, best=1.819e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.805e+00, best=1.805e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.789e+00, best=1.789e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.772e+00, best=1.772e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.751e+00, best=1.751e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.728e+00, best=1.728e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.702e+00, best=1.702e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.672e+00, best=1.672e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.638e+00, best=1.638e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.599e+00, best=1.599e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.554e+00, best=1.554e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.503e+00, best=1.503e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.446e+00, best=1.446e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.380e+00, best=1.380e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.305e+00, best=1.305e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.219e+00, best=1.219e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.121e+00, best=1.121e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.010e+00, best=1.010e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.831e-01, best=8.831e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.385e-01, best=7.385e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.736e-01, best=5.736e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.856e-01, best=3.856e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.713e-01, best=1.713e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.303e-02, best=7.303e-02, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.055e-01, best=7.303e-02, lr=2.51e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.587e-02, best=4.587e-02, lr=2.87e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.407e-01, best=4.587e-02, lr=2.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.794e-02, best=1.794e-02, lr=2.95e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.769e-01, best=1.794e-02, lr=2.66e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.081e-02, best=1.081e-02, lr=3.03e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.925e-01, best=1.081e-02, lr=2.74e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.877e-02, best=1.081e-02, lr=2.47e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.283e-01, best=1.081e-02, lr=2.23e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.322e-03, best=5.322e-03, lr=2.54e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.489e-01, best=5.322e-03, lr=2.29e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.946e-02, best=5.322e-03, lr=2.07e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.876e-01, best=5.322e-03, lr=1.87e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.246e-04, best=7.246e-04, lr=2.13e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.123e-01, best=7.246e-04, lr=1.92e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.004e-02, best=7.246e-04, lr=1.73e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.534e-01, best=7.246e-04, lr=1.57e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.128e-03, best=7.246e-04, lr=1.41e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.382e-01, best=7.246e-04, lr=1.28e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.065e-02, best=7.246e-04, lr=1.15e-01, worse_count=6]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 463.41it/s, loss=1.065e-02, best=7.246e-04, lr=1.15e-01, worse_count=6]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 463.41it/s, loss=1.044e-01, best=7.246e-04, lr=1.04e-01, worse_count=7]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 463.41it/s, loss=5.721e-04, best=5.721e-04, lr=1.18e-01, worse_count=0]
    Optimizing (Original):  94%|█████████▍| 47/50 [00:00<00:00, 463.41it/s, loss=1.178e-01, best=5.721e-04, lr=1.07e-01, worse_count=1]
                                                                                                                                       
(172/208) Processing tensor: layers.6.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.735e+00, best=1.735e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.726e+00, best=1.726e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.714e+00, best=1.714e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.700e+00, best=1.700e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.683e+00, best=1.683e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.663e+00, best=1.663e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.639e+00, best=1.639e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.610e+00, best=1.610e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.575e+00, best=1.575e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.533e+00, best=1.533e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.483e+00, best=1.483e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.423e+00, best=1.423e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.351e+00, best=1.351e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.264e+00, best=1.264e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.160e+00, best=1.160e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.035e+00, best=1.035e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.856e-01, best=8.856e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=8.856e-01, best=8.856e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=7.059e-01, best=7.059e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=4.903e-01, best=4.903e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=2.316e-01, best=2.316e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=7.891e-02, best=7.891e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=2.937e-01, best=7.891e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=6.028e-02, best=6.028e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=3.645e-01, best=6.028e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=3.904e-02, best=3.904e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=4.452e-01, best=3.904e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=1.483e-02, best=1.483e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=5.372e-01, best=1.483e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=1.277e-02, best=1.277e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=6.165e-01, best=1.277e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=1.870e-02, best=1.277e-02, lr=5.68e-01, worse_count=2]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=5.492e-01, best=1.277e-02, lr=5.39e-01, worse_count=3]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=9.699e-03, best=9.699e-03, lr=6.47e-01, worse_count=0]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=6.377e-01, best=9.699e-03, lr=6.15e-01, worse_count=1]
    Optimizing (Original):  34%|███▍      | 17/50 [00:00<00:00, 169.60it/s, loss=2.267e-02, best=9.699e-03, lr=5.84e-01, worse_count=2]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=2.267e-02, best=9.699e-03, lr=5.84e-01, worse_count=2]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=5.616e-01, best=9.699e-03, lr=5.55e-01, worse_count=3]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=6.543e-03, best=6.543e-03, lr=6.66e-01, worse_count=0]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=6.596e-01, best=6.543e-03, lr=6.33e-01, worse_count=1]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=2.676e-02, best=6.543e-03, lr=6.01e-01, worse_count=2]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=5.744e-01, best=6.543e-03, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=3.295e-03, best=3.295e-03, lr=6.85e-01, worse_count=0]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=6.820e-01, best=3.295e-03, lr=6.51e-01, worse_count=1]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=3.097e-02, best=3.295e-03, lr=6.18e-01, worse_count=2]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=5.875e-01, best=3.295e-03, lr=5.88e-01, worse_count=3]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=5.181e-05, best=5.181e-05, lr=7.05e-01, worse_count=0]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=7.051e-01, best=5.181e-05, lr=6.70e-01, worse_count=1]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=3.520e-02, best=5.181e-05, lr=6.36e-01, worse_count=2]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=6.012e-01, best=5.181e-05, lr=6.04e-01, worse_count=3]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=3.386e-03, best=5.181e-05, lr=5.74e-01, worse_count=4]
    Optimizing (Original):  70%|███████   | 35/50 [00:00<00:00, 172.34it/s, loss=5.709e-01, best=5.181e-05, lr=5.46e-01, worse_count=5]
                                                                                                                                       
(173/208) Processing tensor: layers.6.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.782e+00, best=1.782e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.773e+00, best=1.773e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.761e+00, best=1.761e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.747e+00, best=1.747e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.730e+00, best=1.730e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.710e+00, best=1.710e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.686e+00, best=1.686e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.657e+00, best=1.657e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.622e+00, best=1.622e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.580e+00, best=1.580e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.530e+00, best=1.530e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.470e+00, best=1.470e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.398e+00, best=1.398e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.311e+00, best=1.311e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.207e+00, best=1.207e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.082e+00, best=1.082e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.324e-01, best=9.324e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.528e-01, best=7.528e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.371e-01, best=5.371e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.784e-01, best=2.784e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=2.784e-01, best=2.784e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=3.208e-02, best=3.208e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=3.405e-01, best=3.208e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=1.345e-02, best=1.345e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=4.113e-01, best=1.345e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=7.788e-03, best=7.788e-03, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=4.764e-01, best=7.788e-03, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=1.642e-02, best=7.788e-03, lr=4.37e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=4.206e-01, best=7.788e-03, lr=4.15e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=5.428e-03, best=5.428e-03, lr=4.98e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=4.927e-01, best=5.428e-03, lr=4.73e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=1.948e-02, best=5.428e-03, lr=4.50e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=4.301e-01, best=5.428e-03, lr=4.27e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=2.999e-03, best=2.999e-03, lr=5.13e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=5.095e-01, best=2.999e-03, lr=4.87e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=2.263e-02, best=2.999e-03, lr=4.63e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=4.399e-01, best=2.999e-03, lr=4.39e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=5.012e-04, best=5.012e-04, lr=5.27e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=5.268e-01, best=5.012e-04, lr=5.01e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=2.587e-02, best=5.012e-04, lr=4.76e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.31it/s, loss=4.501e-01, best=5.012e-04, lr=4.52e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=4.501e-01, best=5.012e-04, lr=4.52e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=2.070e-03, best=5.012e-04, lr=4.29e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=4.274e-01, best=5.012e-04, lr=4.08e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=1.941e-02, best=5.012e-04, lr=3.88e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=3.682e-01, best=5.012e-04, lr=3.68e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=2.885e-05, best=2.885e-05, lr=4.42e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=4.419e-01, best=2.885e-05, lr=4.20e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=2.207e-02, best=2.885e-05, lr=3.99e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=3.768e-01, best=2.885e-05, lr=3.79e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=2.126e-03, best=2.885e-05, lr=3.60e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.81it/s, loss=3.578e-01, best=2.885e-05, lr=3.42e-01, worse_count=5]
                                                                                                                                       
(174/208) Processing tensor: layers.6.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.020e+00, best=2.020e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.010e+00, best=2.010e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.998e+00, best=1.998e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.984e+00, best=1.984e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.967e+00, best=1.967e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.947e+00, best=1.947e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.923e+00, best=1.923e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.894e+00, best=1.894e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.859e+00, best=1.859e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.817e+00, best=1.817e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.767e+00, best=1.767e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.707e+00, best=1.707e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.635e+00, best=1.635e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.548e+00, best=1.548e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.444e+00, best=1.444e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.319e+00, best=1.319e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.170e+00, best=1.170e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.900e-01, best=9.900e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.744e-01, best=7.744e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=7.744e-01, best=7.744e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=5.157e-01, best=5.157e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=2.052e-01, best=2.052e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=1.674e-01, best=1.674e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=2.797e-01, best=1.674e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=1.450e-01, best=1.450e-01, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=3.647e-01, best=1.450e-01, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=1.195e-01, best=1.195e-01, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=4.615e-01, best=1.195e-01, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=9.047e-02, best=9.047e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=5.719e-01, best=9.047e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=5.735e-02, best=5.735e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=6.978e-01, best=5.735e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=1.960e-02, best=1.960e-02, lr=8.61e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=8.412e-01, best=1.960e-02, lr=8.18e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=2.344e-02, best=1.960e-02, lr=7.77e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=7.535e-01, best=1.960e-02, lr=7.38e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=1.540e-02, best=1.540e-02, lr=8.86e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=8.703e-01, best=1.540e-02, lr=8.41e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.84it/s, loss=2.888e-02, best=1.540e-02, lr=7.99e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 182.80it/s, loss=2.888e-02, best=1.540e-02, lr=7.99e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 182.80it/s, loss=7.704e-01, best=1.540e-02, lr=7.59e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 182.80it/s, loss=1.108e-02, best=1.108e-02, lr=9.11e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 182.80it/s, loss=9.001e-01, best=1.108e-02, lr=8.66e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 182.80it/s, loss=3.448e-02, best=1.108e-02, lr=8.22e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 182.80it/s, loss=7.879e-01, best=1.108e-02, lr=7.81e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 182.80it/s, loss=6.642e-03, best=6.642e-03, lr=9.37e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 182.80it/s, loss=9.309e-01, best=6.642e-03, lr=8.91e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 182.80it/s, loss=4.023e-02, best=6.642e-03, lr=8.46e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 182.80it/s, loss=8.059e-01, best=6.642e-03, lr=8.04e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 182.80it/s, loss=2.071e-03, best=2.071e-03, lr=9.64e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 182.80it/s, loss=9.625e-01, best=2.071e-03, lr=9.16e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 182.80it/s, loss=4.616e-02, best=2.071e-03, lr=8.70e-01, worse_count=2]
                                                                                                                                       
(175/208) Processing tensor: layers.6.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.936e+00, best=2.936e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.927e+00, best=2.927e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.915e+00, best=2.915e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.901e+00, best=2.901e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.884e+00, best=2.884e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.864e+00, best=2.864e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.840e+00, best=2.840e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.811e+00, best=2.811e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.776e+00, best=2.776e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.734e+00, best=2.734e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.684e+00, best=2.684e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.624e+00, best=2.624e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.552e+00, best=2.552e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.465e+00, best=2.465e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.361e+00, best=2.361e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.236e+00, best=2.236e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.087e+00, best=2.087e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.907e+00, best=1.907e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.691e+00, best=1.691e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=1.691e+00, best=1.691e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=1.433e+00, best=1.433e+00, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=1.122e+00, best=1.122e+00, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=7.495e-01, best=7.495e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=3.024e-01, best=3.024e-01, lr=5.36e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=2.341e-01, best=2.341e-01, lr=6.44e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=4.097e-01, best=2.341e-01, lr=6.12e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=2.019e-01, best=2.019e-01, lr=7.34e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=5.320e-01, best=2.019e-01, lr=6.97e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=1.652e-01, best=1.652e-01, lr=8.37e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=6.715e-01, best=1.652e-01, lr=7.95e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=1.234e-01, best=1.234e-01, lr=9.54e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=8.304e-01, best=1.234e-01, lr=9.06e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=7.570e-02, best=7.570e-02, lr=1.09e+00, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=1.012e+00, best=7.570e-02, lr=1.03e+00, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=2.133e-02, best=2.133e-02, lr=1.24e+00, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=1.218e+00, best=2.133e-02, lr=1.18e+00, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=4.065e-02, best=2.133e-02, lr=1.12e+00, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=1.078e+00, best=2.133e-02, lr=1.06e+00, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.80it/s, loss=1.529e-02, best=1.529e-02, lr=1.28e+00, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.61it/s, loss=1.529e-02, best=1.529e-02, lr=1.28e+00, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.61it/s, loss=1.260e+00, best=1.529e-02, lr=1.21e+00, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.61it/s, loss=4.848e-02, best=1.529e-02, lr=1.15e+00, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.61it/s, loss=1.103e+00, best=1.529e-02, lr=1.09e+00, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.61it/s, loss=9.072e-03, best=9.072e-03, lr=1.31e+00, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.61it/s, loss=1.303e+00, best=9.072e-03, lr=1.25e+00, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.61it/s, loss=5.653e-02, best=9.072e-03, lr=1.18e+00, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.61it/s, loss=1.128e+00, best=9.072e-03, lr=1.12e+00, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.61it/s, loss=2.676e-03, best=2.676e-03, lr=1.35e+00, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.61it/s, loss=1.347e+00, best=2.676e-03, lr=1.28e+00, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.61it/s, loss=6.482e-02, best=2.676e-03, lr=1.22e+00, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.61it/s, loss=1.154e+00, best=2.676e-03, lr=1.16e+00, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 188.61it/s, loss=3.905e-03, best=2.676e-03, lr=1.10e+00, worse_count=4]
                                                                                                                                       
(176/208) Skipping tensor: layers.7.adaLN_modulation.0.weight (Reason: In high-precision list)
(177/208) Processing tensor: layers.7.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.229e+00, best=2.229e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.219e+00, best=2.219e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.209e+00, best=2.209e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.197e+00, best=2.197e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.183e+00, best=2.183e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.168e+00, best=2.168e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.150e+00, best=2.150e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.130e+00, best=2.130e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.106e+00, best=2.106e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.080e+00, best=2.080e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.050e+00, best=2.050e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.016e+00, best=2.016e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.977e+00, best=1.977e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.932e+00, best=1.932e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.882e+00, best=1.882e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.824e+00, best=1.824e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.758e+00, best=1.758e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.683e+00, best=1.683e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.597e+00, best=1.597e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.500e+00, best=1.500e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.388e+00, best=1.388e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.261e+00, best=1.261e+00, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.117e+00, best=1.117e+00, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.518e-01, best=9.518e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.639e-01, best=7.639e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.496e-01, best=5.496e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.053e-01, best=3.053e-01, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.675e-02, best=2.675e-02, lr=3.17e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.907e-01, best=2.675e-02, lr=2.87e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.202e-03, best=4.202e-03, lr=3.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.224e-01, best=4.202e-03, lr=2.95e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.765e-02, best=4.202e-03, lr=2.66e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.384e-01, best=4.202e-03, lr=2.40e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.706e-03, best=1.706e-03, lr=2.74e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.720e-01, best=1.706e-03, lr=2.47e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.498e-02, best=1.706e-03, lr=2.23e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.980e-01, best=1.706e-03, lr=2.01e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.245e-03, best=1.706e-03, lr=1.82e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.784e-01, best=1.706e-03, lr=1.64e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.446e-02, best=1.706e-03, lr=1.48e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.335e-01, best=1.706e-03, lr=1.33e-01, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.043e-05, best=4.043e-05, lr=1.52e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.521e-01, best=4.043e-05, lr=1.37e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.480e-02, best=4.043e-05, lr=1.24e-01, worse_count=2]
    Optimizing (Original):  88%|████████▊ | 44/50 [00:00<00:00, 437.82it/s, loss=1.480e-02, best=4.043e-05, lr=1.24e-01, worse_count=2]
    Optimizing (Original):  88%|████████▊ | 44/50 [00:00<00:00, 437.82it/s, loss=1.092e-01, best=4.043e-05, lr=1.12e-01, worse_count=3]
    Optimizing (Original):  88%|████████▊ | 44/50 [00:00<00:00, 437.82it/s, loss=2.712e-03, best=4.043e-05, lr=1.01e-01, worse_count=4]
    Optimizing (Original):  88%|████████▊ | 44/50 [00:00<00:00, 437.82it/s, loss=9.825e-02, best=4.043e-05, lr=9.11e-02, worse_count=5]
    Optimizing (Original):  88%|████████▊ | 44/50 [00:00<00:00, 437.82it/s, loss=7.132e-03, best=4.043e-05, lr=8.22e-02, worse_count=6]
    Optimizing (Original):  88%|████████▊ | 44/50 [00:00<00:00, 437.82it/s, loss=7.510e-02, best=4.043e-05, lr=7.42e-02, worse_count=7]
    Optimizing (Original):  88%|████████▊ | 44/50 [00:00<00:00, 437.82it/s, loss=8.861e-04, best=4.043e-05, lr=6.70e-02, worse_count=8]
                                                                                                                                       
(178/208) Processing tensor: layers.7.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.000e+00, best=2.000e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.991e+00, best=1.991e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.979e+00, best=1.979e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.965e+00, best=1.965e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.948e+00, best=1.948e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.928e+00, best=1.928e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.904e+00, best=1.904e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.875e+00, best=1.875e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.840e+00, best=1.840e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.798e+00, best=1.798e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.748e+00, best=1.748e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.688e+00, best=1.688e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.616e+00, best=1.616e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.529e+00, best=1.529e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.425e+00, best=1.425e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.300e+00, best=1.300e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.151e+00, best=1.151e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.710e-01, best=9.710e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=9.710e-01, best=9.710e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=7.554e-01, best=7.554e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=4.967e-01, best=4.967e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=1.862e-01, best=1.862e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=1.864e-01, best=1.862e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=1.676e-01, best=1.676e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=2.571e-01, best=1.676e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=1.464e-01, best=1.464e-01, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=3.378e-01, best=1.464e-01, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=1.221e-01, best=1.221e-01, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=4.298e-01, best=1.221e-01, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=9.455e-02, best=9.455e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=5.347e-01, best=9.455e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=6.309e-02, best=6.309e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=6.543e-01, best=6.309e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=2.722e-02, best=2.722e-02, lr=8.18e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=7.906e-01, best=2.722e-02, lr=7.77e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=1.367e-02, best=1.367e-02, lr=9.32e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.07it/s, loss=9.186e-01, best=1.367e-02, lr=8.86e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.94it/s, loss=9.186e-01, best=1.367e-02, lr=8.86e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.94it/s, loss=3.294e-02, best=1.367e-02, lr=8.41e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.94it/s, loss=8.084e-01, best=1.367e-02, lr=7.99e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.94it/s, loss=9.127e-03, best=9.127e-03, lr=9.59e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.94it/s, loss=9.500e-01, best=9.127e-03, lr=9.11e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.94it/s, loss=3.883e-02, best=9.127e-03, lr=8.66e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.94it/s, loss=8.268e-01, best=9.127e-03, lr=8.22e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.94it/s, loss=4.451e-03, best=4.451e-03, lr=9.87e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.94it/s, loss=9.824e-01, best=4.451e-03, lr=9.37e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.94it/s, loss=4.489e-02, best=4.451e-03, lr=8.91e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.94it/s, loss=8.457e-01, best=4.451e-03, lr=8.46e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.94it/s, loss=3.615e-04, best=3.615e-04, lr=1.02e+00, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.94it/s, loss=1.015e+00, best=3.615e-04, lr=9.64e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.94it/s, loss=5.040e-02, best=3.615e-04, lr=9.16e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 172.94it/s, loss=8.659e-01, best=3.615e-04, lr=8.70e-01, worse_count=3]
                                                                                                                                       
(179/208) Processing tensor: layers.7.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.827e+00, best=1.827e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.818e+00, best=1.818e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.806e+00, best=1.806e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.792e+00, best=1.792e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.775e+00, best=1.775e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.755e+00, best=1.755e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.731e+00, best=1.731e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.702e+00, best=1.702e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.667e+00, best=1.667e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.625e+00, best=1.625e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.575e+00, best=1.575e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.515e+00, best=1.515e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.443e+00, best=1.443e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.356e+00, best=1.356e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.252e+00, best=1.252e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.127e+00, best=1.127e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.775e-01, best=9.775e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.978e-01, best=7.978e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.822e-01, best=5.822e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.235e-01, best=3.235e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=3.235e-01, best=3.235e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=1.300e-02, best=1.300e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=3.596e-01, best=1.300e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=5.627e-03, best=5.627e-03, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=4.191e-01, best=5.627e-03, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=1.561e-02, best=5.627e-03, lr=3.83e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=3.677e-01, best=5.627e-03, lr=3.64e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=3.556e-03, best=3.556e-03, lr=4.37e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=4.334e-01, best=3.556e-03, lr=4.15e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=1.829e-02, best=3.556e-03, lr=3.94e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=3.761e-01, best=3.556e-03, lr=3.75e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=1.426e-03, best=1.426e-03, lr=4.50e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=4.482e-01, best=1.426e-03, lr=4.27e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=2.105e-02, best=1.426e-03, lr=4.06e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=3.847e-01, best=1.426e-03, lr=3.85e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=7.662e-04, best=7.662e-04, lr=4.63e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=4.618e-01, best=7.662e-04, lr=4.39e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=2.236e-02, best=7.662e-04, lr=4.17e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=3.951e-01, best=7.662e-04, lr=3.97e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=1.489e-03, best=7.662e-04, lr=3.77e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 192.71it/s, loss=3.753e-01, best=7.662e-04, lr=3.58e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.38it/s, loss=3.753e-01, best=7.662e-04, lr=3.58e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.38it/s, loss=1.735e-02, best=7.662e-04, lr=3.40e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.38it/s, loss=3.227e-01, best=7.662e-04, lr=3.23e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.38it/s, loss=3.480e-04, best=3.480e-04, lr=3.88e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.38it/s, loss=3.873e-01, best=3.480e-04, lr=3.68e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.38it/s, loss=1.903e-02, best=3.480e-04, lr=3.50e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.38it/s, loss=3.308e-01, best=3.480e-04, lr=3.32e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.38it/s, loss=1.542e-03, best=3.480e-04, lr=3.16e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.38it/s, loss=3.142e-01, best=3.480e-04, lr=3.00e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.38it/s, loss=1.424e-02, best=3.480e-04, lr=2.85e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 195.38it/s, loss=2.707e-01, best=3.480e-04, lr=2.71e-01, worse_count=7]
                                                                                                                                       
(180/208) Processing tensor: layers.7.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.170e+00, best=2.170e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.160e+00, best=2.160e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.148e+00, best=2.148e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.134e+00, best=2.134e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.118e+00, best=2.118e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.098e+00, best=2.098e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.073e+00, best=2.073e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.044e+00, best=2.044e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.010e+00, best=2.010e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.968e+00, best=1.968e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.918e+00, best=1.918e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.857e+00, best=1.857e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.785e+00, best=1.785e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.699e+00, best=1.699e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.595e+00, best=1.595e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.470e+00, best=1.470e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.320e+00, best=1.320e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.140e+00, best=1.140e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.248e-01, best=9.248e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=9.248e-01, best=9.248e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=6.661e-01, best=6.661e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=3.556e-01, best=3.556e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=1.700e-02, best=1.700e-02, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=4.301e-01, best=1.700e-02, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=5.353e-03, best=5.353e-03, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=5.043e-01, best=5.353e-03, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=2.013e-02, best=5.353e-03, lr=4.60e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=4.399e-01, best=5.353e-03, lr=4.37e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=2.869e-03, best=2.869e-03, lr=5.24e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=5.215e-01, best=2.869e-03, lr=4.98e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=2.335e-02, best=2.869e-03, lr=4.73e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=4.499e-01, best=2.869e-03, lr=4.50e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=3.130e-04, best=3.130e-04, lr=5.39e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=5.392e-01, best=3.130e-04, lr=5.13e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=2.666e-02, best=3.130e-04, lr=4.87e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=4.602e-01, best=3.130e-04, lr=4.63e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=2.317e-03, best=3.130e-04, lr=4.39e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=4.371e-01, best=3.130e-04, lr=4.17e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=1.965e-02, best=3.130e-04, lr=3.97e-01, worse_count=6]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 182.00it/s, loss=3.769e-01, best=3.130e-04, lr=3.77e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.45it/s, loss=3.769e-01, best=3.130e-04, lr=3.77e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.45it/s, loss=1.760e-04, best=1.760e-04, lr=4.52e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.45it/s, loss=4.519e-01, best=1.760e-04, lr=4.29e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.45it/s, loss=2.243e-02, best=1.760e-04, lr=4.08e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.45it/s, loss=3.856e-01, best=1.760e-04, lr=3.88e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.45it/s, loss=2.028e-03, best=1.760e-04, lr=3.68e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.45it/s, loss=3.662e-01, best=1.760e-04, lr=3.50e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.45it/s, loss=1.638e-02, best=1.760e-04, lr=3.32e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.45it/s, loss=3.160e-01, best=1.760e-04, lr=3.16e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.45it/s, loss=2.334e-04, best=1.760e-04, lr=3.00e-01, worse_count=8]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.45it/s, loss=2.997e-01, best=1.760e-04, lr=2.85e-01, worse_count=9]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 187.45it/s, loss=1.476e-02, best=1.760e-04, lr=2.71e-01, worse_count=10]
                                                                                                                                        
(181/208) Processing tensor: layers.7.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.308e+00, best=2.308e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.299e+00, best=2.299e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.287e+00, best=2.287e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.273e+00, best=2.273e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.256e+00, best=2.256e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.236e+00, best=2.236e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.212e+00, best=2.212e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.183e+00, best=2.183e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.148e+00, best=2.148e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.106e+00, best=2.106e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.056e+00, best=2.056e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.996e+00, best=1.996e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.924e+00, best=1.924e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.837e+00, best=1.837e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.733e+00, best=1.733e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.608e+00, best=1.608e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.459e+00, best=1.459e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.279e+00, best=1.279e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.063e+00, best=1.063e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=1.063e+00, best=1.063e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=8.045e-01, best=8.045e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=4.940e-01, best=4.940e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=1.215e-01, best=1.215e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=3.256e-01, best=1.215e-01, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=9.910e-02, best=9.910e-02, lr=5.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=4.106e-01, best=9.910e-02, lr=4.84e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=7.362e-02, best=7.362e-02, lr=5.81e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=5.074e-01, best=7.362e-02, lr=5.52e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=4.456e-02, best=4.456e-02, lr=6.62e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=6.178e-01, best=4.456e-02, lr=6.29e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=1.144e-02, best=1.144e-02, lr=7.55e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=7.437e-01, best=1.144e-02, lr=7.17e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=2.631e-02, best=1.144e-02, lr=6.81e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=6.552e-01, best=1.144e-02, lr=6.47e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=7.763e-03, best=7.763e-03, lr=7.77e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=7.691e-01, best=7.763e-03, lr=7.38e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=3.108e-02, best=7.763e-03, lr=7.01e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=6.701e-01, best=7.763e-03, lr=6.66e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=3.975e-03, best=3.975e-03, lr=7.99e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.67it/s, loss=7.953e-01, best=3.975e-03, lr=7.59e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.01it/s, loss=7.953e-01, best=3.975e-03, lr=7.59e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.01it/s, loss=3.599e-02, best=3.975e-03, lr=7.21e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.01it/s, loss=6.854e-01, best=3.975e-03, lr=6.85e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.01it/s, loss=8.298e-05, best=8.298e-05, lr=8.22e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.01it/s, loss=8.223e-01, best=8.298e-05, lr=7.81e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.01it/s, loss=4.104e-02, best=8.298e-05, lr=7.42e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.01it/s, loss=7.011e-01, best=8.298e-05, lr=7.05e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.01it/s, loss=3.926e-03, best=8.298e-05, lr=6.70e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.01it/s, loss=6.659e-01, best=8.298e-05, lr=6.36e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.01it/s, loss=2.956e-02, best=8.298e-05, lr=6.04e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.01it/s, loss=5.749e-01, best=8.298e-05, lr=5.74e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.01it/s, loss=6.614e-04, best=8.298e-05, lr=5.46e-01, worse_count=8]
                                                                                                                                       
(182/208) Skipping tensor: layers.8.adaLN_modulation.0.weight (Reason: In high-precision list)
(183/208) Processing tensor: layers.8.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.957e+00, best=1.957e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.948e+00, best=1.948e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.937e+00, best=1.937e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.925e+00, best=1.925e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.912e+00, best=1.912e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.896e+00, best=1.896e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.878e+00, best=1.878e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.858e+00, best=1.858e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.835e+00, best=1.835e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.809e+00, best=1.809e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.779e+00, best=1.779e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.744e+00, best=1.744e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.705e+00, best=1.705e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.661e+00, best=1.661e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.610e+00, best=1.610e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.552e+00, best=1.552e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.486e+00, best=1.486e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.411e+00, best=1.411e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.326e+00, best=1.326e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.228e+00, best=1.228e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.117e+00, best=1.117e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.899e-01, best=9.899e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.453e-01, best=8.453e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.804e-01, best=6.804e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.924e-01, best=4.924e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.781e-01, best=2.781e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.378e-02, best=3.378e-02, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.447e-01, best=3.378e-02, lr=2.51e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.626e-03, best=6.626e-03, lr=2.87e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.799e-01, best=6.626e-03, lr=2.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.131e-02, best=6.626e-03, lr=2.33e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.121e-01, best=6.626e-03, lr=2.11e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.443e-03, best=1.443e-03, lr=2.40e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.387e-01, best=1.443e-03, lr=2.17e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.197e-02, best=1.443e-03, lr=1.96e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.736e-01, best=1.443e-03, lr=1.77e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.899e-03, best=1.443e-03, lr=1.59e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.564e-01, best=1.443e-03, lr=1.44e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.263e-02, best=1.443e-03, lr=1.30e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.171e-01, best=1.443e-03, lr=1.17e-01, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.962e-05, best=1.962e-05, lr=1.33e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.335e-01, best=1.962e-05, lr=1.20e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.300e-02, best=1.962e-05, lr=1.09e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.573e-02, best=1.962e-05, lr=9.81e-02, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.395e-03, best=1.962e-05, lr=8.86e-02, worse_count=4]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 446.46it/s, loss=2.395e-03, best=1.962e-05, lr=8.86e-02, worse_count=4]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 446.46it/s, loss=8.617e-02, best=1.962e-05, lr=7.99e-02, worse_count=5]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 446.46it/s, loss=6.240e-03, best=1.962e-05, lr=7.21e-02, worse_count=6]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 446.46it/s, loss=6.589e-02, best=1.962e-05, lr=6.51e-02, worse_count=7]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 446.46it/s, loss=7.933e-04, best=1.962e-05, lr=5.88e-02, worse_count=8]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 446.46it/s, loss=5.796e-02, best=1.962e-05, lr=5.30e-02, worse_count=9]
                                                                                                                                       
(184/208) Processing tensor: layers.8.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.898e+00, best=1.898e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.889e+00, best=1.889e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.877e+00, best=1.877e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.863e+00, best=1.863e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.846e+00, best=1.846e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.826e+00, best=1.826e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.802e+00, best=1.802e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.773e+00, best=1.773e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.738e+00, best=1.738e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.696e+00, best=1.696e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.646e+00, best=1.646e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.586e+00, best=1.586e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.514e+00, best=1.514e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.427e+00, best=1.427e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.323e+00, best=1.323e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.198e+00, best=1.198e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.049e+00, best=1.049e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.689e-01, best=8.689e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=8.689e-01, best=8.689e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=6.533e-01, best=6.533e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=3.945e-01, best=3.945e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=8.406e-02, best=8.406e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=2.885e-01, best=8.406e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=6.543e-02, best=6.543e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=3.593e-01, best=6.543e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=4.420e-02, best=4.420e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=4.400e-01, best=4.420e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=1.999e-02, best=1.999e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=5.320e-01, best=1.999e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=7.614e-03, best=7.614e-03, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=6.217e-01, best=7.614e-03, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=2.385e-02, best=7.614e-03, lr=5.68e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=5.441e-01, best=7.614e-03, lr=5.39e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=4.546e-03, best=4.546e-03, lr=6.47e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=6.429e-01, best=4.546e-03, lr=6.15e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=2.783e-02, best=4.546e-03, lr=5.84e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=5.565e-01, best=4.546e-03, lr=5.55e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.60it/s, loss=1.390e-03, best=1.390e-03, lr=6.66e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.30it/s, loss=1.390e-03, best=1.390e-03, lr=6.66e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.30it/s, loss=6.647e-01, best=1.390e-03, lr=6.33e-01, worse_count=1]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.30it/s, loss=3.191e-02, best=1.390e-03, lr=6.01e-01, worse_count=2]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.30it/s, loss=5.692e-01, best=1.390e-03, lr=5.71e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.30it/s, loss=1.857e-03, best=1.390e-03, lr=5.43e-01, worse_count=4]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.30it/s, loss=5.407e-01, best=1.390e-03, lr=5.15e-01, worse_count=5]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.30it/s, loss=2.527e-02, best=1.390e-03, lr=4.90e-01, worse_count=6]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.30it/s, loss=4.644e-01, best=1.390e-03, lr=4.65e-01, worse_count=7]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.30it/s, loss=7.877e-04, best=7.877e-04, lr=5.58e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.30it/s, loss=5.574e-01, best=7.877e-04, lr=5.30e-01, worse_count=1]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.30it/s, loss=2.712e-02, best=7.877e-04, lr=5.04e-01, worse_count=2]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.30it/s, loss=4.766e-01, best=7.877e-04, lr=4.79e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.30it/s, loss=1.934e-03, best=7.877e-04, lr=4.55e-01, worse_count=4]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.30it/s, loss=4.527e-01, best=7.877e-04, lr=4.32e-01, worse_count=5]
                                                                                                                                       
(185/208) Processing tensor: layers.8.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.864e+00, best=1.864e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.855e+00, best=1.855e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.843e+00, best=1.843e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.829e+00, best=1.829e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.812e+00, best=1.812e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.792e+00, best=1.792e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.768e+00, best=1.768e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.739e+00, best=1.739e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.704e+00, best=1.704e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.662e+00, best=1.662e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.612e+00, best=1.612e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.552e+00, best=1.552e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.480e+00, best=1.480e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.393e+00, best=1.393e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.289e+00, best=1.289e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.164e+00, best=1.164e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.015e+00, best=1.015e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.349e-01, best=8.349e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.193e-01, best=6.193e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=6.193e-01, best=6.193e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=3.606e-01, best=3.606e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=5.008e-02, best=5.008e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=3.225e-01, best=5.008e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=3.145e-02, best=3.145e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=3.933e-01, best=3.145e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=1.021e-02, best=1.021e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=4.740e-01, best=1.021e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=1.400e-02, best=1.021e-02, lr=4.37e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=4.230e-01, best=1.021e-02, lr=4.15e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=7.850e-03, best=7.850e-03, lr=4.98e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=4.903e-01, best=7.850e-03, lr=4.73e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=1.706e-02, best=7.850e-03, lr=4.50e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=4.325e-01, best=7.850e-03, lr=4.27e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=5.421e-03, best=5.421e-03, lr=5.13e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=5.071e-01, best=5.421e-03, lr=4.87e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=2.021e-02, best=5.421e-03, lr=4.63e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=4.424e-01, best=5.421e-03, lr=4.39e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=2.922e-03, best=2.922e-03, lr=5.27e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=5.244e-01, best=2.922e-03, lr=5.01e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=2.344e-02, best=2.922e-03, lr=4.76e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.61it/s, loss=4.525e-01, best=2.922e-03, lr=4.52e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.67it/s, loss=4.525e-01, best=2.922e-03, lr=4.52e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.67it/s, loss=3.522e-04, best=3.522e-04, lr=5.43e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.67it/s, loss=5.422e-01, best=3.522e-04, lr=5.15e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.67it/s, loss=2.678e-02, best=3.522e-04, lr=4.90e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.67it/s, loss=4.629e-01, best=3.522e-04, lr=4.65e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.67it/s, loss=2.293e-03, best=3.522e-04, lr=4.42e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.67it/s, loss=4.396e-01, best=3.522e-04, lr=4.20e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.67it/s, loss=1.980e-02, best=3.522e-04, lr=3.99e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.67it/s, loss=3.790e-01, best=3.522e-04, lr=3.79e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.67it/s, loss=1.395e-04, best=1.395e-04, lr=4.55e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 196.67it/s, loss=4.545e-01, best=1.395e-04, lr=4.32e-01, worse_count=1]
                                                                                                                                       
(186/208) Processing tensor: layers.8.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.983e+00, best=1.983e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.973e+00, best=1.973e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.962e+00, best=1.962e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.948e+00, best=1.948e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.931e+00, best=1.931e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.911e+00, best=1.911e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.887e+00, best=1.887e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.858e+00, best=1.858e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.823e+00, best=1.823e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.781e+00, best=1.781e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.731e+00, best=1.731e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.671e+00, best=1.671e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.598e+00, best=1.598e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.512e+00, best=1.512e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.408e+00, best=1.408e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.283e+00, best=1.283e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.133e+00, best=1.133e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.536e-01, best=9.536e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.380e-01, best=7.380e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=7.380e-01, best=7.380e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=4.792e-01, best=4.792e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=1.687e-01, best=1.687e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=2.038e-01, best=1.687e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=1.501e-01, best=1.501e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=2.746e-01, best=1.501e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=1.289e-01, best=1.289e-01, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=3.553e-01, best=1.289e-01, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=1.047e-01, best=1.047e-01, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=4.473e-01, best=1.047e-01, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=7.706e-02, best=7.706e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=5.522e-01, best=7.706e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=4.560e-02, best=4.560e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=6.718e-01, best=4.560e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=9.728e-03, best=9.728e-03, lr=8.18e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=8.081e-01, best=9.728e-03, lr=7.77e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=3.116e-02, best=9.728e-03, lr=7.38e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=7.069e-01, best=9.728e-03, lr=7.01e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=5.741e-03, best=5.741e-03, lr=8.41e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 181.78it/s, loss=8.357e-01, best=5.741e-03, lr=7.99e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.77it/s, loss=8.357e-01, best=5.741e-03, lr=7.99e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.77it/s, loss=3.633e-02, best=5.741e-03, lr=7.59e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.77it/s, loss=7.230e-01, best=5.741e-03, lr=7.21e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.77it/s, loss=1.640e-03, best=1.640e-03, lr=8.66e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.77it/s, loss=8.640e-01, best=1.640e-03, lr=8.22e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.77it/s, loss=4.164e-02, best=1.640e-03, lr=7.81e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.77it/s, loss=7.396e-01, best=1.640e-03, lr=7.42e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.77it/s, loss=2.581e-03, best=1.640e-03, lr=7.05e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.77it/s, loss=7.025e-01, best=1.640e-03, lr=6.70e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.77it/s, loss=3.267e-02, best=1.640e-03, lr=6.36e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.77it/s, loss=6.037e-01, best=1.640e-03, lr=6.04e-01, worse_count=7]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.77it/s, loss=8.569e-04, best=8.569e-04, lr=7.25e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 184.77it/s, loss=7.246e-01, best=8.569e-04, lr=6.89e-01, worse_count=1]
                                                                                                                                       
(187/208) Processing tensor: layers.8.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.452e+00, best=2.452e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.442e+00, best=2.442e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.430e+00, best=2.430e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.416e+00, best=2.416e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.400e+00, best=2.400e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.379e+00, best=2.379e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.355e+00, best=2.355e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.326e+00, best=2.326e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.291e+00, best=2.291e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.250e+00, best=2.250e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.199e+00, best=2.199e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.139e+00, best=2.139e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.067e+00, best=2.067e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.980e+00, best=1.980e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.876e+00, best=1.876e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.752e+00, best=1.752e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.602e+00, best=1.602e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.422e+00, best=1.422e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.207e+00, best=1.207e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.479e-01, best=9.479e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=9.479e-01, best=9.479e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=6.374e-01, best=6.374e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=2.649e-01, best=2.649e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=1.822e-01, best=1.822e-01, lr=5.36e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=3.543e-01, best=1.822e-01, lr=5.10e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=1.554e-01, best=1.554e-01, lr=6.12e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=4.562e-01, best=1.554e-01, lr=5.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=1.248e-01, best=1.248e-01, lr=6.97e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=5.724e-01, best=1.248e-01, lr=6.62e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=8.997e-02, best=8.997e-02, lr=7.95e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=7.049e-01, best=8.997e-02, lr=7.55e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=5.022e-02, best=5.022e-02, lr=9.06e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=8.559e-01, best=5.022e-02, lr=8.61e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=4.916e-03, best=4.916e-03, lr=1.03e+00, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=1.028e+00, best=4.916e-03, lr=9.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=4.673e-02, best=4.916e-03, lr=9.32e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=8.856e-01, best=4.916e-03, lr=8.86e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=1.254e-04, best=1.254e-04, lr=1.06e+00, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=1.063e+00, best=1.254e-04, lr=1.01e+00, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=5.302e-02, best=1.254e-04, lr=9.59e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.76it/s, loss=9.062e-01, best=1.254e-04, lr=9.11e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.90it/s, loss=9.062e-01, best=1.254e-04, lr=9.11e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.90it/s, loss=5.056e-03, best=1.254e-04, lr=8.66e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.90it/s, loss=8.606e-01, best=1.254e-04, lr=8.22e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.90it/s, loss=3.823e-02, best=1.254e-04, lr=7.81e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.90it/s, loss=7.430e-01, best=1.254e-04, lr=7.42e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.90it/s, loss=8.362e-04, best=1.254e-04, lr=7.05e-01, worse_count=8]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.90it/s, loss=7.043e-01, best=1.254e-04, lr=6.70e-01, worse_count=9]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.90it/s, loss=3.442e-02, best=1.254e-04, lr=6.36e-01, worse_count=10]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.90it/s, loss=6.019e-01, best=1.254e-04, lr=6.04e-01, worse_count=11]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.90it/s, loss=2.601e-03, best=1.254e-04, lr=5.74e-01, worse_count=12]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 189.90it/s, loss=5.717e-01, best=1.254e-04, lr=5.46e-01, worse_count=13]
                                                                                                                                        
(188/208) Skipping tensor: layers.9.adaLN_modulation.0.weight (Reason: In high-precision list)
(189/208) Processing tensor: layers.9.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.954e+00, best=1.954e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.944e+00, best=1.944e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.934e+00, best=1.934e+00, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.922e+00, best=1.922e+00, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.908e+00, best=1.908e+00, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.893e+00, best=1.893e+00, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.875e+00, best=1.875e+00, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.855e+00, best=1.855e+00, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.831e+00, best=1.831e+00, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.805e+00, best=1.805e+00, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.775e+00, best=1.775e+00, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.741e+00, best=1.741e+00, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.702e+00, best=1.702e+00, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.657e+00, best=1.657e+00, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.607e+00, best=1.607e+00, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.549e+00, best=1.549e+00, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.483e+00, best=1.483e+00, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.408e+00, best=1.408e+00, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.322e+00, best=1.322e+00, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.225e+00, best=1.225e+00, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.113e+00, best=1.113e+00, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.864e-01, best=9.864e-01, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.417e-01, best=8.417e-01, lr=1.65e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.768e-01, best=6.768e-01, lr=1.88e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.888e-01, best=4.888e-01, lr=2.14e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.745e-01, best=2.745e-01, lr=2.44e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.023e-02, best=3.023e-02, lr=2.78e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.483e-01, best=3.023e-02, lr=2.51e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.076e-03, best=3.076e-03, lr=2.87e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.835e-01, best=3.076e-03, lr=2.59e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.486e-02, best=3.076e-03, lr=2.33e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.085e-01, best=3.076e-03, lr=2.11e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.107e-03, best=2.107e-03, lr=2.40e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.380e-01, best=2.107e-03, lr=2.17e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.131e-02, best=2.107e-03, lr=1.96e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.743e-01, best=2.107e-03, lr=1.77e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.236e-03, best=2.107e-03, lr=1.59e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.571e-01, best=2.107e-03, lr=1.44e-01, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.330e-02, best=2.107e-03, lr=1.30e-01, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.165e-01, best=2.107e-03, lr=1.17e-01, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.450e-04, best=6.450e-04, lr=1.33e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.329e-01, best=6.450e-04, lr=1.20e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.237e-02, best=6.450e-04, lr=1.09e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.636e-02, best=6.450e-04, lr=9.81e-02, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.769e-03, best=6.450e-04, lr=8.86e-02, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.680e-02, best=6.450e-04, lr=7.99e-02, worse_count=5]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 456.79it/s, loss=8.680e-02, best=6.450e-04, lr=7.99e-02, worse_count=5]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 456.79it/s, loss=6.866e-03, best=6.450e-04, lr=7.21e-02, worse_count=6]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 456.79it/s, loss=6.527e-02, best=6.450e-04, lr=6.51e-02, worse_count=7]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 456.79it/s, loss=1.677e-04, best=1.677e-04, lr=7.42e-02, worse_count=0]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 456.79it/s, loss=7.405e-02, best=1.677e-04, lr=6.70e-02, worse_count=1]
                                                                                                                                       
(190/208) Processing tensor: layers.9.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.776e+00, best=1.776e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.766e+00, best=1.766e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.754e+00, best=1.754e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.741e+00, best=1.741e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.724e+00, best=1.724e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.704e+00, best=1.704e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.679e+00, best=1.679e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.650e+00, best=1.650e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.616e+00, best=1.616e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.574e+00, best=1.574e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.524e+00, best=1.524e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.463e+00, best=1.463e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.391e+00, best=1.391e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.305e+00, best=1.305e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.201e+00, best=1.201e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.076e+00, best=1.076e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.261e-01, best=9.261e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.464e-01, best=7.464e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=7.464e-01, best=7.464e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=5.308e-01, best=5.308e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=2.721e-01, best=2.721e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=3.842e-02, best=3.842e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=3.342e-01, best=3.842e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=1.979e-02, best=1.979e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=4.049e-01, best=1.979e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=1.446e-03, best=1.446e-03, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=4.828e-01, best=1.446e-03, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=2.276e-02, best=1.446e-03, lr=4.37e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=4.142e-01, best=1.446e-03, lr=4.15e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=9.143e-04, best=9.143e-04, lr=4.98e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=4.973e-01, best=9.143e-04, lr=4.73e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=2.399e-02, best=9.143e-04, lr=4.50e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=4.256e-01, best=9.143e-04, lr=4.27e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=1.514e-03, best=9.143e-04, lr=4.06e-01, worse_count=4]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=4.042e-01, best=9.143e-04, lr=3.85e-01, worse_count=5]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=1.877e-02, best=9.143e-04, lr=3.66e-01, worse_count=6]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 173.20it/s, loss=3.474e-01, best=9.143e-04, lr=3.48e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.80it/s, loss=3.474e-01, best=9.143e-04, lr=3.48e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.80it/s, loss=4.639e-04, best=4.639e-04, lr=4.17e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.80it/s, loss=4.170e-01, best=4.639e-04, lr=3.97e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.80it/s, loss=2.041e-02, best=4.639e-04, lr=3.77e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.80it/s, loss=3.564e-01, best=4.639e-04, lr=3.58e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.80it/s, loss=1.571e-03, best=4.639e-04, lr=3.40e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.80it/s, loss=3.385e-01, best=4.639e-04, lr=3.23e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.80it/s, loss=1.543e-02, best=4.639e-04, lr=3.07e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.80it/s, loss=2.914e-01, best=4.639e-04, lr=2.92e-01, worse_count=7]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.80it/s, loss=8.714e-05, best=8.714e-05, lr=3.50e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.80it/s, loss=3.498e-01, best=8.714e-05, lr=3.32e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.80it/s, loss=1.741e-02, best=8.714e-05, lr=3.16e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.80it/s, loss=2.983e-01, best=8.714e-05, lr=3.00e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.80it/s, loss=1.618e-03, best=8.714e-05, lr=2.85e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 175.80it/s, loss=2.833e-01, best=8.714e-05, lr=2.71e-01, worse_count=5]
                                                                                                                                       
(191/208) Processing tensor: layers.9.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.853e+00, best=1.853e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.843e+00, best=1.843e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.831e+00, best=1.831e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.817e+00, best=1.817e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.801e+00, best=1.801e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.780e+00, best=1.780e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.756e+00, best=1.756e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.727e+00, best=1.727e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.692e+00, best=1.692e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.651e+00, best=1.651e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.601e+00, best=1.601e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.540e+00, best=1.540e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.468e+00, best=1.468e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.381e+00, best=1.381e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.278e+00, best=1.278e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.153e+00, best=1.153e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.003e+00, best=1.003e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.233e-01, best=8.233e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.077e-01, best=6.077e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.490e-01, best=3.490e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=3.490e-01, best=3.490e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=3.851e-02, best=3.851e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=3.341e-01, best=3.851e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=1.988e-02, best=1.988e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=4.049e-01, best=1.988e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=1.355e-03, best=1.355e-03, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=4.828e-01, best=1.355e-03, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=2.286e-02, best=1.355e-03, lr=4.37e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=4.141e-01, best=1.355e-03, lr=4.15e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=1.006e-03, best=1.006e-03, lr=4.98e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=4.972e-01, best=1.006e-03, lr=4.73e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=2.390e-02, best=1.006e-03, lr=4.50e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=4.257e-01, best=1.006e-03, lr=4.27e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=1.423e-03, best=1.006e-03, lr=4.06e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=4.043e-01, best=1.006e-03, lr=3.85e-01, worse_count=5]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=1.887e-02, best=1.006e-03, lr=3.66e-01, worse_count=6]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=3.473e-01, best=1.006e-03, lr=3.48e-01, worse_count=7]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=5.554e-04, best=5.554e-04, lr=4.17e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=4.169e-01, best=5.554e-04, lr=3.97e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=2.032e-02, best=5.554e-04, lr=3.77e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 190.41it/s, loss=3.564e-01, best=5.554e-04, lr=3.58e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.28it/s, loss=3.564e-01, best=5.554e-04, lr=3.58e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.28it/s, loss=1.480e-03, best=5.554e-04, lr=3.40e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.28it/s, loss=3.386e-01, best=5.554e-04, lr=3.23e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.28it/s, loss=1.552e-02, best=5.554e-04, lr=3.07e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.28it/s, loss=2.914e-01, best=5.554e-04, lr=2.92e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.28it/s, loss=1.782e-04, best=1.782e-04, lr=3.50e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.28it/s, loss=3.497e-01, best=1.782e-04, lr=3.32e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.28it/s, loss=1.731e-02, best=1.782e-04, lr=3.16e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.28it/s, loss=2.984e-01, best=1.782e-04, lr=3.00e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.28it/s, loss=1.527e-03, best=1.782e-04, lr=2.85e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 190.28it/s, loss=2.834e-01, best=1.782e-04, lr=2.71e-01, worse_count=5]
                                                                                                                                       
(192/208) Processing tensor: layers.9.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.187e+00, best=2.187e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.178e+00, best=2.178e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.166e+00, best=2.166e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.152e+00, best=2.152e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.135e+00, best=2.135e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.115e+00, best=2.115e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.091e+00, best=2.091e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.062e+00, best=2.062e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.027e+00, best=2.027e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.985e+00, best=1.985e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.935e+00, best=1.935e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.875e+00, best=1.875e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.803e+00, best=1.803e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.716e+00, best=1.716e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.612e+00, best=1.612e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.487e+00, best=1.487e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.337e+00, best=1.337e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.158e+00, best=1.158e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.422e-01, best=9.422e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=9.422e-01, best=9.422e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=6.835e-01, best=6.835e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=3.730e-01, best=3.730e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=3.935e-04, best=3.935e-04, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=4.467e-01, best=3.935e-04, lr=4.25e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=2.196e-02, best=3.935e-04, lr=4.03e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=3.815e-01, best=3.935e-04, lr=3.83e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=1.786e-03, best=3.935e-04, lr=3.64e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=3.624e-01, best=3.935e-04, lr=3.46e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=1.642e-02, best=3.935e-04, lr=3.29e-01, worse_count=6]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=3.122e-01, best=3.935e-04, lr=3.12e-01, worse_count=7]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=1.916e-05, best=1.916e-05, lr=3.75e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=3.746e-01, best=1.916e-05, lr=3.56e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=1.871e-02, best=1.916e-05, lr=3.38e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=3.194e-01, best=1.916e-05, lr=3.21e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=1.808e-03, best=1.916e-05, lr=3.05e-01, worse_count=4]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=3.033e-01, best=1.916e-05, lr=2.90e-01, worse_count=5]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=1.345e-02, best=1.916e-05, lr=2.75e-01, worse_count=6]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=2.619e-01, best=1.916e-05, lr=2.62e-01, worse_count=7]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=3.202e-04, best=1.916e-05, lr=2.49e-01, worse_count=8]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 187.27it/s, loss=2.482e-01, best=1.916e-05, lr=2.36e-01, worse_count=9]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.62it/s, loss=2.482e-01, best=1.916e-05, lr=2.36e-01, worse_count=9]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.62it/s, loss=1.211e-02, best=1.916e-05, lr=2.24e-01, worse_count=10]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.62it/s, loss=2.122e-01, best=1.916e-05, lr=2.13e-01, worse_count=11]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.62it/s, loss=8.915e-04, best=1.916e-05, lr=2.02e-01, worse_count=12]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.62it/s, loss=2.015e-01, best=1.916e-05, lr=1.92e-01, worse_count=13]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.62it/s, loss=9.231e-03, best=1.916e-05, lr=1.83e-01, worse_count=14]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.62it/s, loss=1.735e-01, best=1.916e-05, lr=1.74e-01, worse_count=15]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.62it/s, loss=9.576e-05, best=1.916e-05, lr=1.65e-01, worse_count=16]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.62it/s, loss=1.648e-01, best=1.916e-05, lr=1.57e-01, worse_count=17]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.62it/s, loss=8.149e-03, best=1.916e-05, lr=1.49e-01, worse_count=18]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.62it/s, loss=1.407e-01, best=1.916e-05, lr=1.41e-01, worse_count=19]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 191.62it/s, loss=7.081e-04, best=1.916e-05, lr=1.34e-01, worse_count=20]
                                                                                                                                        
(193/208) Processing tensor: layers.9.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.821e+00, best=1.821e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.812e+00, best=1.812e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.800e+00, best=1.800e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.786e+00, best=1.786e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.769e+00, best=1.769e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.749e+00, best=1.749e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.725e+00, best=1.725e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.696e+00, best=1.696e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.661e+00, best=1.661e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.619e+00, best=1.619e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.569e+00, best=1.569e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.509e+00, best=1.509e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.437e+00, best=1.437e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.350e+00, best=1.350e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.246e+00, best=1.246e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.121e+00, best=1.121e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.716e-01, best=9.716e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.919e-01, best=7.919e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.763e-01, best=5.763e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=5.763e-01, best=5.763e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=3.176e-01, best=3.176e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=7.081e-03, best=7.081e-03, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=3.655e-01, best=7.081e-03, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=1.155e-02, best=7.081e-03, lr=3.36e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=3.247e-01, best=7.081e-03, lr=3.19e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=5.264e-03, best=5.264e-03, lr=3.83e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=3.781e-01, best=5.264e-03, lr=3.64e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=1.390e-02, best=5.264e-03, lr=3.46e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=3.321e-01, best=5.264e-03, lr=3.29e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=3.396e-03, best=3.396e-03, lr=3.94e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=3.910e-01, best=3.396e-03, lr=3.75e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=1.632e-02, best=3.396e-03, lr=3.56e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=3.396e-01, best=3.396e-03, lr=3.38e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=1.473e-03, best=1.473e-03, lr=4.06e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=4.043e-01, best=1.473e-03, lr=3.85e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=1.882e-02, best=1.473e-03, lr=3.66e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=3.474e-01, best=1.473e-03, lr=3.48e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=5.053e-04, best=5.053e-04, lr=4.17e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=4.170e-01, best=5.053e-04, lr=3.97e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 189.12it/s, loss=2.037e-02, best=5.053e-04, lr=3.77e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 194.03it/s, loss=2.037e-02, best=5.053e-04, lr=3.77e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 194.03it/s, loss=3.564e-01, best=5.053e-04, lr=3.58e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 194.03it/s, loss=1.530e-03, best=5.053e-04, lr=3.40e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 194.03it/s, loss=3.385e-01, best=5.053e-04, lr=3.23e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 194.03it/s, loss=1.547e-02, best=5.053e-04, lr=3.07e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 194.03it/s, loss=2.914e-01, best=5.053e-04, lr=2.92e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 194.03it/s, loss=1.283e-04, best=1.283e-04, lr=3.50e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 194.03it/s, loss=3.497e-01, best=1.283e-04, lr=3.32e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 194.03it/s, loss=1.736e-02, best=1.283e-04, lr=3.16e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 194.03it/s, loss=2.984e-01, best=1.283e-04, lr=3.00e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 194.03it/s, loss=1.577e-03, best=1.283e-04, lr=2.85e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 194.03it/s, loss=2.834e-01, best=1.283e-04, lr=2.71e-01, worse_count=5]
                                                                                                                                       
(194/208) Skipping tensor: noise_refiner.0.adaLN_modulation.0.weight (Reason: In high-precision list)
(195/208) Processing tensor: noise_refiner.0.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.966e-01, best=9.966e-01, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.874e-01, best=9.874e-01, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.769e-01, best=9.769e-01, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.649e-01, best=9.649e-01, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.512e-01, best=9.512e-01, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.356e-01, best=9.356e-01, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.178e-01, best=9.178e-01, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.976e-01, best=8.976e-01, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.745e-01, best=8.745e-01, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.481e-01, best=8.481e-01, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.181e-01, best=8.181e-01, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.839e-01, best=7.839e-01, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.449e-01, best=7.449e-01, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.004e-01, best=7.004e-01, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.497e-01, best=6.497e-01, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.919e-01, best=5.919e-01, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.260e-01, best=5.260e-01, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.509e-01, best=4.509e-01, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.652e-01, best=3.652e-01, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.676e-01, best=2.676e-01, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.563e-01, best=1.563e-01, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.940e-02, best=2.940e-02, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.152e-01, best=2.940e-02, lr=1.31e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.530e-02, best=1.530e-02, lr=1.49e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.335e-01, best=1.530e-02, lr=1.34e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.899e-04, best=7.899e-04, lr=1.53e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.523e-01, best=7.899e-04, lr=1.38e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.414e-02, best=7.899e-04, lr=1.25e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.106e-01, best=7.899e-04, lr=1.13e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.979e-03, best=7.899e-04, lr=1.02e-01, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.960e-02, best=7.899e-04, lr=9.17e-02, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.924e-03, best=7.899e-04, lr=8.27e-02, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.481e-02, best=7.899e-04, lr=7.47e-02, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.422e-04, best=1.422e-04, lr=8.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.498e-02, best=1.422e-04, lr=7.68e-02, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.157e-03, best=1.422e-04, lr=6.93e-02, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.117e-02, best=1.422e-04, lr=6.26e-02, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.397e-03, best=1.422e-04, lr=5.65e-02, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.507e-02, best=1.422e-04, lr=5.10e-02, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.109e-03, best=1.422e-04, lr=4.60e-02, worse_count=6]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.189e-02, best=1.422e-04, lr=4.15e-02, worse_count=7]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.760e-04, best=1.422e-04, lr=3.75e-02, worse_count=8]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.709e-02, best=1.422e-04, lr=3.38e-02, worse_count=9]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.277e-03, best=1.422e-04, lr=3.05e-02, worse_count=10]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.724e-02, best=1.422e-04, lr=2.75e-02, worse_count=11]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 438.66it/s, loss=2.724e-02, best=1.422e-04, lr=2.75e-02, worse_count=11]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 438.66it/s, loss=3.016e-04, best=1.422e-04, lr=2.49e-02, worse_count=12]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 438.66it/s, loss=2.455e-02, best=1.422e-04, lr=2.24e-02, worse_count=13]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 438.66it/s, loss=2.122e-03, best=1.422e-04, lr=2.02e-02, worse_count=14]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 438.66it/s, loss=1.812e-02, best=1.422e-04, lr=1.83e-02, worse_count=15]
    Optimizing (Original):  90%|█████████ | 45/50 [00:00<00:00, 438.66it/s, loss=1.480e-04, best=1.422e-04, lr=1.65e-02, worse_count=16]
                                                                                                                                        
(196/208) Processing tensor: noise_refiner.0.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.527e+00, best=1.527e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.517e+00, best=1.517e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.506e+00, best=1.506e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.492e+00, best=1.492e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.475e+00, best=1.475e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.455e+00, best=1.455e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.431e+00, best=1.431e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.402e+00, best=1.402e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.367e+00, best=1.367e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.325e+00, best=1.325e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.275e+00, best=1.275e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.215e+00, best=1.215e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.142e+00, best=1.142e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.056e+00, best=1.056e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.519e-01, best=9.519e-01, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.271e-01, best=8.271e-01, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.774e-01, best=6.774e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.977e-01, best=4.977e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=4.977e-01, best=4.977e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=2.821e-01, best=2.821e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=2.338e-02, best=2.338e-02, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=2.871e-01, best=2.338e-02, lr=2.95e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=7.856e-03, best=7.856e-03, lr=3.54e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=3.461e-01, best=7.856e-03, lr=3.36e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=9.841e-03, best=7.856e-03, lr=3.19e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=3.096e-01, best=7.856e-03, lr=3.03e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=6.130e-03, best=6.130e-03, lr=3.64e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=3.580e-01, best=6.130e-03, lr=3.46e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=1.208e-02, best=6.130e-03, lr=3.29e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=3.166e-01, best=6.130e-03, lr=3.12e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=4.355e-03, best=4.355e-03, lr=3.75e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=3.703e-01, best=4.355e-03, lr=3.56e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=1.438e-02, best=4.355e-03, lr=3.38e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=3.237e-01, best=4.355e-03, lr=3.21e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=2.529e-03, best=2.529e-03, lr=3.85e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=3.829e-01, best=2.529e-03, lr=3.66e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=1.674e-02, best=2.529e-03, lr=3.48e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 172.31it/s, loss=3.311e-01, best=2.529e-03, lr=3.30e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.72it/s, loss=3.311e-01, best=2.529e-03, lr=3.30e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.72it/s, loss=6.498e-04, best=6.498e-04, lr=3.97e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.72it/s, loss=3.959e-01, best=6.498e-04, lr=3.77e-01, worse_count=1]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.72it/s, loss=1.918e-02, best=6.498e-04, lr=3.58e-01, worse_count=2]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.72it/s, loss=3.387e-01, best=6.498e-04, lr=3.40e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.72it/s, loss=1.284e-03, best=6.498e-04, lr=3.23e-01, worse_count=4]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.72it/s, loss=3.217e-01, best=6.498e-04, lr=3.07e-01, worse_count=5]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.72it/s, loss=1.487e-02, best=6.498e-04, lr=2.92e-01, worse_count=6]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.72it/s, loss=2.767e-01, best=6.498e-04, lr=2.77e-01, worse_count=7]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.72it/s, loss=2.913e-04, best=2.913e-04, lr=3.32e-01, worse_count=0]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.72it/s, loss=3.320e-01, best=2.913e-04, lr=3.16e-01, worse_count=1]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.72it/s, loss=1.633e-02, best=2.913e-04, lr=3.00e-01, worse_count=2]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.72it/s, loss=2.836e-01, best=2.913e-04, lr=2.85e-01, worse_count=3]
    Optimizing (Original):  74%|███████▍  | 37/50 [00:00<00:00, 177.72it/s, loss=1.329e-03, best=2.913e-04, lr=2.71e-01, worse_count=4]
                                                                                                                                       
(197/208) Processing tensor: noise_refiner.0.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.862e+00, best=1.862e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.852e+00, best=1.852e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.841e+00, best=1.841e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.827e+00, best=1.827e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.810e+00, best=1.810e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.790e+00, best=1.790e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.765e+00, best=1.765e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.736e+00, best=1.736e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.702e+00, best=1.702e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.660e+00, best=1.660e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.610e+00, best=1.610e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.550e+00, best=1.550e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.477e+00, best=1.477e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.391e+00, best=1.391e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.287e+00, best=1.287e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.162e+00, best=1.162e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.012e+00, best=1.012e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.326e-01, best=8.326e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.170e-01, best=6.170e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=6.170e-01, best=6.170e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=3.582e-01, best=3.582e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=4.778e-02, best=4.778e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=3.248e-01, best=4.778e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=2.915e-02, best=2.915e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=3.956e-01, best=2.915e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=7.911e-03, best=7.911e-03, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=4.763e-01, best=7.911e-03, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=1.630e-02, best=7.911e-03, lr=4.37e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=4.207e-01, best=7.911e-03, lr=4.15e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=5.551e-03, best=5.551e-03, lr=4.98e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=4.926e-01, best=5.551e-03, lr=4.73e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=1.936e-02, best=5.551e-03, lr=4.50e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=4.302e-01, best=5.551e-03, lr=4.27e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=3.122e-03, best=3.122e-03, lr=5.13e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=5.094e-01, best=3.122e-03, lr=4.87e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=2.250e-02, best=3.122e-03, lr=4.63e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=4.400e-01, best=3.122e-03, lr=4.39e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=6.240e-04, best=6.240e-04, lr=5.27e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=5.267e-01, best=6.240e-04, lr=5.01e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 186.87it/s, loss=2.574e-02, best=6.240e-04, lr=4.76e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.93it/s, loss=2.574e-02, best=6.240e-04, lr=4.76e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.93it/s, loss=4.502e-01, best=6.240e-04, lr=4.52e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.93it/s, loss=1.947e-03, best=6.240e-04, lr=4.29e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.93it/s, loss=4.275e-01, best=6.240e-04, lr=4.08e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.93it/s, loss=1.953e-02, best=6.240e-04, lr=3.88e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.93it/s, loss=3.681e-01, best=6.240e-04, lr=3.68e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.93it/s, loss=1.480e-04, best=1.480e-04, lr=4.42e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.93it/s, loss=4.417e-01, best=1.480e-04, lr=4.20e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.93it/s, loss=2.195e-02, best=1.480e-04, lr=3.99e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.93it/s, loss=3.769e-01, best=1.480e-04, lr=3.79e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.93it/s, loss=2.006e-03, best=1.480e-04, lr=3.60e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 193.93it/s, loss=3.579e-01, best=1.480e-04, lr=3.42e-01, worse_count=5]
                                                                                                                                       
(198/208) Processing tensor: noise_refiner.0.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.844e+00, best=1.844e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.835e+00, best=1.835e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.823e+00, best=1.823e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.809e+00, best=1.809e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.792e+00, best=1.792e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.772e+00, best=1.772e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.748e+00, best=1.748e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.719e+00, best=1.719e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.684e+00, best=1.684e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.642e+00, best=1.642e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.592e+00, best=1.592e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.532e+00, best=1.532e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.460e+00, best=1.460e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.373e+00, best=1.373e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.269e+00, best=1.269e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.144e+00, best=1.144e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.947e-01, best=9.947e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.150e-01, best=8.150e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.994e-01, best=5.994e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=5.994e-01, best=5.994e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=3.407e-01, best=3.407e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=3.024e-02, best=3.024e-02, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=3.423e-01, best=3.024e-02, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=1.161e-02, best=1.161e-02, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=4.131e-01, best=1.161e-02, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=9.628e-03, best=9.628e-03, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=4.746e-01, best=9.628e-03, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=1.458e-02, best=9.628e-03, lr=4.37e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=4.224e-01, best=9.628e-03, lr=4.15e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=7.268e-03, best=7.268e-03, lr=4.98e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=4.909e-01, best=7.268e-03, lr=4.73e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=1.764e-02, best=7.268e-03, lr=4.50e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=4.319e-01, best=7.268e-03, lr=4.27e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=4.839e-03, best=4.839e-03, lr=5.13e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=5.077e-01, best=4.839e-03, lr=4.87e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=2.079e-02, best=4.839e-03, lr=4.63e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=4.418e-01, best=4.839e-03, lr=4.39e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=2.341e-03, best=2.341e-03, lr=5.27e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.04it/s, loss=5.250e-01, best=2.341e-03, lr=5.01e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.54it/s, loss=5.250e-01, best=2.341e-03, lr=5.01e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.54it/s, loss=2.403e-02, best=2.341e-03, lr=4.76e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.54it/s, loss=4.519e-01, best=2.341e-03, lr=4.52e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.54it/s, loss=2.311e-04, best=2.311e-04, lr=5.43e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.54it/s, loss=5.423e-01, best=2.311e-04, lr=5.15e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.54it/s, loss=2.690e-02, best=2.311e-04, lr=4.90e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.54it/s, loss=4.627e-01, best=2.311e-04, lr=4.65e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.54it/s, loss=2.414e-03, best=2.311e-04, lr=4.42e-01, worse_count=4]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.54it/s, loss=4.395e-01, best=2.311e-04, lr=4.20e-01, worse_count=5]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.54it/s, loss=1.968e-02, best=2.311e-04, lr=3.99e-01, worse_count=6]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.54it/s, loss=3.791e-01, best=2.311e-04, lr=3.79e-01, worse_count=7]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.54it/s, loss=2.603e-04, best=2.311e-04, lr=3.60e-01, worse_count=8]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 186.54it/s, loss=3.597e-01, best=2.311e-04, lr=3.42e-01, worse_count=9]
                                                                                                                                       
(199/208) Processing tensor: noise_refiner.0.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.810e+00, best=2.810e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.800e+00, best=2.800e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.788e+00, best=2.788e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.774e+00, best=2.774e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.757e+00, best=2.757e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.737e+00, best=2.737e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.713e+00, best=2.713e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.684e+00, best=2.684e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.649e+00, best=2.649e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.607e+00, best=2.607e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.557e+00, best=2.557e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.497e+00, best=2.497e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.425e+00, best=2.425e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.338e+00, best=2.338e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.234e+00, best=2.234e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.110e+00, best=2.110e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.960e+00, best=1.960e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.780e+00, best=1.780e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.565e+00, best=1.565e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.306e+00, best=1.306e+00, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=1.306e+00, best=1.306e+00, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=9.954e-01, best=9.954e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=6.228e-01, best=6.228e-01, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=1.758e-01, best=1.758e-01, lr=5.36e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=3.607e-01, best=1.758e-01, lr=5.10e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=1.489e-01, best=1.489e-01, lr=6.12e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=4.627e-01, best=1.489e-01, lr=5.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=1.183e-01, best=1.183e-01, lr=6.97e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=5.789e-01, best=1.183e-01, lr=6.62e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=8.349e-02, best=8.349e-02, lr=7.95e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=7.114e-01, best=8.349e-02, lr=7.55e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=4.374e-02, best=4.374e-02, lr=9.06e-01, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=8.624e-01, best=4.374e-02, lr=8.61e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=1.562e-03, best=1.562e-03, lr=1.03e+00, worse_count=0]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=1.031e+00, best=1.562e-03, lr=9.81e-01, worse_count=1]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=5.009e-02, best=1.562e-03, lr=9.32e-01, worse_count=2]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=8.822e-01, best=1.562e-03, lr=8.86e-01, worse_count=3]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=3.474e-03, best=1.562e-03, lr=8.41e-01, worse_count=4]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=8.379e-01, best=1.562e-03, lr=7.99e-01, worse_count=5]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=3.859e-02, best=1.562e-03, lr=7.59e-01, worse_count=6]
    Optimizing (Original):  40%|████      | 20/50 [00:00<00:00, 191.13it/s, loss=7.207e-01, best=1.562e-03, lr=7.21e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.74it/s, loss=7.207e-01, best=1.562e-03, lr=7.21e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.74it/s, loss=6.289e-04, best=6.289e-04, lr=8.66e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.74it/s, loss=8.650e-01, best=6.289e-04, lr=8.22e-01, worse_count=1]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.74it/s, loss=4.265e-02, best=6.289e-04, lr=7.81e-01, worse_count=2]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.74it/s, loss=7.386e-01, best=6.289e-04, lr=7.42e-01, worse_count=3]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.74it/s, loss=3.591e-03, best=6.289e-04, lr=7.05e-01, worse_count=4]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.74it/s, loss=7.015e-01, best=6.289e-04, lr=6.70e-01, worse_count=5]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.74it/s, loss=3.166e-02, best=6.289e-04, lr=6.36e-01, worse_count=6]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.74it/s, loss=6.047e-01, best=6.289e-04, lr=6.04e-01, worse_count=7]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.74it/s, loss=1.566e-04, best=1.566e-04, lr=7.25e-01, worse_count=0]
    Optimizing (Original):  80%|████████  | 40/50 [00:00<00:00, 194.74it/s, loss=7.252e-01, best=1.566e-04, lr=6.89e-01, worse_count=1]
                                                                                                                                       
(200/208) Skipping tensor: noise_refiner.1.adaLN_modulation.0.weight (Reason: In high-precision list)
(201/208) Processing tensor: noise_refiner.1.attention.out.weight
    - Tensor shape: [3840, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.018e+00, best=1.018e+00, lr=9.23e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.009e+00, best=1.009e+00, lr=1.05e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.986e-01, best=9.986e-01, lr=1.20e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.866e-01, best=9.866e-01, lr=1.37e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.729e-01, best=9.729e-01, lr=1.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.573e-01, best=9.573e-01, lr=1.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.395e-01, best=9.395e-01, lr=2.03e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.193e-01, best=9.193e-01, lr=2.31e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.962e-01, best=8.962e-01, lr=2.63e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.698e-01, best=8.698e-01, lr=3.00e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.398e-01, best=8.398e-01, lr=3.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.056e-01, best=8.056e-01, lr=3.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.666e-01, best=7.666e-01, lr=4.45e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.221e-01, best=7.221e-01, lr=5.07e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.714e-01, best=6.714e-01, lr=5.78e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.136e-01, best=6.136e-01, lr=6.59e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.477e-01, best=5.477e-01, lr=7.51e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.726e-01, best=4.726e-01, lr=8.56e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.869e-01, best=3.869e-01, lr=9.76e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.893e-01, best=2.893e-01, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.780e-01, best=1.780e-01, lr=1.27e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.110e-02, best=5.110e-02, lr=1.45e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.354e-02, best=5.110e-02, lr=1.31e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.700e-02, best=3.700e-02, lr=1.49e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.118e-01, best=3.700e-02, lr=1.34e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.249e-02, best=2.249e-02, lr=1.53e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.306e-01, best=2.249e-02, lr=1.38e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.560e-03, best=7.560e-03, lr=1.58e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.500e-01, best=7.560e-03, lr=1.42e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.799e-03, best=7.560e-03, lr=1.28e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.205e-01, best=7.560e-03, lr=1.16e-01, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.711e-03, best=4.711e-03, lr=1.32e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.273e-01, best=4.711e-03, lr=1.19e-01, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.160e-03, best=4.711e-03, lr=1.08e-01, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.936e-02, best=4.711e-03, lr=9.70e-02, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.324e-03, best=2.324e-03, lr=1.11e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.083e-01, best=2.324e-03, lr=9.98e-02, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.462e-03, best=2.324e-03, lr=9.01e-02, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.164e-02, best=2.324e-03, lr=8.13e-02, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.228e-04, best=3.228e-04, lr=9.27e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.238e-02, best=3.228e-04, lr=8.37e-02, worse_count=1]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.716e-03, best=3.228e-04, lr=7.55e-02, worse_count=2]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.679e-02, best=3.228e-04, lr=6.81e-02, worse_count=3]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.354e-03, best=3.228e-04, lr=6.15e-02, worse_count=4]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.015e-02, best=3.228e-04, lr=5.55e-02, worse_count=5]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=4.643e-03, best=3.228e-04, lr=5.01e-02, worse_count=6]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 454.54it/s, loss=4.643e-03, best=3.228e-04, lr=5.01e-02, worse_count=6]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 454.54it/s, loss=4.545e-02, best=3.228e-04, lr=4.52e-02, worse_count=7]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 454.54it/s, loss=2.415e-04, best=2.415e-04, lr=5.15e-02, worse_count=0]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 454.54it/s, loss=5.130e-02, best=2.415e-04, lr=4.65e-02, worse_count=1]
    Optimizing (Original):  92%|█████████▏| 46/50 [00:00<00:00, 454.54it/s, loss=4.784e-03, best=2.415e-04, lr=4.20e-02, worse_count=2]
                                                                                                                                       
(202/208) Processing tensor: noise_refiner.1.attention.qkv.weight
    - Tensor shape: [11520, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.681e+00, best=1.681e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.671e+00, best=1.671e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.660e+00, best=1.660e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.646e+00, best=1.646e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.629e+00, best=1.629e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.609e+00, best=1.609e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.585e+00, best=1.585e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.556e+00, best=1.556e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.521e+00, best=1.521e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.479e+00, best=1.479e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.429e+00, best=1.429e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.369e+00, best=1.369e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.297e+00, best=1.297e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.210e+00, best=1.210e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.106e+00, best=1.106e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.812e-01, best=9.812e-01, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.315e-01, best=8.315e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.518e-01, best=6.518e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=6.518e-01, best=6.518e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=4.362e-01, best=4.362e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=1.775e-01, best=1.775e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=1.330e-01, best=1.330e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=2.395e-01, best=1.330e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=1.144e-01, best=1.144e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=3.103e-01, best=1.144e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=9.315e-02, best=9.315e-02, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=3.910e-01, best=9.315e-02, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=6.894e-02, best=6.894e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=4.830e-01, best=6.894e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=4.134e-02, best=4.134e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=5.879e-01, best=4.134e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=9.879e-03, best=9.879e-03, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=7.075e-01, best=9.879e-03, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=2.599e-02, best=9.879e-03, lr=6.47e-01, worse_count=2]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=6.214e-01, best=9.879e-03, lr=6.15e-01, worse_count=3]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=6.382e-03, best=6.382e-03, lr=7.38e-01, worse_count=0]
    Optimizing (Original):  36%|███▌      | 18/50 [00:00<00:00, 170.75it/s, loss=7.316e-01, best=6.382e-03, lr=7.01e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.23it/s, loss=7.316e-01, best=6.382e-03, lr=7.01e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.23it/s, loss=3.052e-02, best=6.382e-03, lr=6.66e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.23it/s, loss=6.356e-01, best=6.382e-03, lr=6.33e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.23it/s, loss=2.784e-03, best=2.784e-03, lr=7.59e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.23it/s, loss=7.565e-01, best=2.784e-03, lr=7.21e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.23it/s, loss=3.518e-02, best=2.784e-03, lr=6.85e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.23it/s, loss=6.501e-01, best=2.784e-03, lr=6.51e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.23it/s, loss=9.179e-04, best=9.179e-04, lr=7.81e-01, worse_count=0]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.23it/s, loss=7.803e-01, best=9.179e-04, lr=7.42e-01, worse_count=1]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.23it/s, loss=3.814e-02, best=9.179e-04, lr=7.05e-01, worse_count=2]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.23it/s, loss=6.669e-01, best=9.179e-04, lr=6.70e-01, worse_count=3]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.23it/s, loss=2.891e-03, best=9.179e-04, lr=6.36e-01, worse_count=4]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.23it/s, loss=6.334e-01, best=9.179e-04, lr=6.04e-01, worse_count=5]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.23it/s, loss=2.893e-02, best=9.179e-04, lr=5.74e-01, worse_count=6]
    Optimizing (Original):  72%|███████▏  | 36/50 [00:00<00:00, 173.23it/s, loss=5.454e-01, best=9.179e-04, lr=5.46e-01, worse_count=7]
                                                                                                                                       
(203/208) Processing tensor: noise_refiner.1.feed_forward.w1.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.357e+00, best=1.357e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.347e+00, best=1.347e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.336e+00, best=1.336e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.322e+00, best=1.322e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.305e+00, best=1.305e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.285e+00, best=1.285e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.260e+00, best=1.260e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.231e+00, best=1.231e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.197e+00, best=1.197e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.155e+00, best=1.155e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.105e+00, best=1.105e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.045e+00, best=1.045e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.723e-01, best=9.723e-01, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=8.857e-01, best=8.857e-01, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.817e-01, best=7.817e-01, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=6.569e-01, best=6.569e-01, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=5.072e-01, best=5.072e-01, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.275e-01, best=3.275e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.119e-01, best=1.119e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=1.119e-01, best=1.119e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=1.468e-01, best=1.119e-01, lr=2.46e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=9.900e-02, best=9.900e-02, lr=2.95e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=1.959e-01, best=9.900e-02, lr=2.80e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=8.425e-02, best=8.425e-02, lr=3.36e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=2.520e-01, best=8.425e-02, lr=3.19e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=6.744e-02, best=6.744e-02, lr=3.83e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=3.159e-01, best=6.744e-02, lr=3.64e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=4.827e-02, best=4.827e-02, lr=4.37e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=3.887e-01, best=4.827e-02, lr=4.15e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=2.643e-02, best=2.643e-02, lr=4.98e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=4.717e-01, best=2.643e-02, lr=4.73e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=1.518e-03, best=1.518e-03, lr=5.68e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=5.664e-01, best=1.518e-03, lr=5.39e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=2.688e-02, best=1.518e-03, lr=5.13e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=4.857e-01, best=1.518e-03, lr=4.87e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=1.251e-03, best=1.251e-03, lr=5.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=5.830e-01, best=1.251e-03, lr=5.55e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=2.796e-02, best=1.251e-03, lr=5.27e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=4.994e-01, best=1.251e-03, lr=5.01e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 183.98it/s, loss=1.597e-03, best=1.251e-03, lr=4.76e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.37it/s, loss=1.597e-03, best=1.251e-03, lr=4.76e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.37it/s, loss=4.743e-01, best=1.251e-03, lr=4.52e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.37it/s, loss=2.220e-02, best=1.251e-03, lr=4.29e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.37it/s, loss=4.073e-01, best=1.251e-03, lr=4.08e-01, worse_count=7]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.37it/s, loss=7.228e-04, best=7.228e-04, lr=4.90e-01, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.37it/s, loss=4.889e-01, best=7.228e-04, lr=4.65e-01, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.37it/s, loss=2.376e-02, best=7.228e-04, lr=4.42e-01, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.37it/s, loss=4.181e-01, best=7.228e-04, lr=4.20e-01, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.37it/s, loss=1.664e-03, best=7.228e-04, lr=3.99e-01, worse_count=4]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.37it/s, loss=3.971e-01, best=7.228e-04, lr=3.79e-01, worse_count=5]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.37it/s, loss=1.828e-02, best=7.228e-04, lr=3.60e-01, worse_count=6]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 189.37it/s, loss=3.417e-01, best=7.228e-04, lr=3.42e-01, worse_count=7]
                                                                                                                                       
(204/208) Processing tensor: noise_refiner.1.feed_forward.w2.weight
    - Tensor shape: [3840, 10240], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.956e+00, best=1.956e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.947e+00, best=1.947e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.935e+00, best=1.935e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.921e+00, best=1.921e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.904e+00, best=1.904e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.884e+00, best=1.884e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.860e+00, best=1.860e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.831e+00, best=1.831e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.796e+00, best=1.796e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.754e+00, best=1.754e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.704e+00, best=1.704e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.644e+00, best=1.644e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.572e+00, best=1.572e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.485e+00, best=1.485e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.381e+00, best=1.381e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.256e+00, best=1.256e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=1.107e+00, best=1.107e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=9.268e-01, best=9.268e-01, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=7.112e-01, best=7.112e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=7.112e-01, best=7.112e-01, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=4.525e-01, best=4.525e-01, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=1.420e-01, best=1.420e-01, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=2.305e-01, best=1.420e-01, lr=3.54e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=1.234e-01, best=1.234e-01, lr=4.25e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=3.013e-01, best=1.234e-01, lr=4.03e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=1.022e-01, best=1.022e-01, lr=4.84e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=3.820e-01, best=1.022e-01, lr=4.60e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=7.796e-02, best=7.796e-02, lr=5.52e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=4.740e-01, best=7.796e-02, lr=5.24e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=5.037e-02, best=5.037e-02, lr=6.29e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=5.789e-01, best=5.037e-02, lr=5.98e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=1.890e-02, best=1.890e-02, lr=7.17e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=6.984e-01, best=1.890e-02, lr=6.81e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=1.696e-02, best=1.696e-02, lr=8.18e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=8.008e-01, best=1.696e-02, lr=7.77e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=2.393e-02, best=1.696e-02, lr=7.38e-01, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=7.141e-01, best=1.696e-02, lr=7.01e-01, worse_count=3]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=1.298e-02, best=1.298e-02, lr=8.41e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 185.13it/s, loss=8.284e-01, best=1.298e-02, lr=7.99e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.46it/s, loss=8.284e-01, best=1.298e-02, lr=7.99e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.46it/s, loss=2.909e-02, best=1.298e-02, lr=7.59e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.46it/s, loss=7.302e-01, best=1.298e-02, lr=7.21e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.46it/s, loss=8.874e-03, best=8.874e-03, lr=8.66e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.46it/s, loss=8.568e-01, best=8.874e-03, lr=8.22e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.46it/s, loss=3.441e-02, best=8.874e-03, lr=7.81e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.46it/s, loss=7.468e-01, best=8.874e-03, lr=7.42e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.46it/s, loss=4.654e-03, best=4.654e-03, lr=8.91e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.46it/s, loss=8.859e-01, best=4.654e-03, lr=8.46e-01, worse_count=1]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.46it/s, loss=3.988e-02, best=4.654e-03, lr=8.04e-01, worse_count=2]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.46it/s, loss=7.639e-01, best=4.654e-03, lr=7.64e-01, worse_count=3]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.46it/s, loss=3.140e-04, best=3.140e-04, lr=9.16e-01, worse_count=0]
    Optimizing (Original):  76%|███████▌  | 38/50 [00:00<00:00, 187.46it/s, loss=9.160e-01, best=3.140e-04, lr=8.70e-01, worse_count=1]
                                                                                                                                       
(205/208) Processing tensor: noise_refiner.1.feed_forward.w3.weight
    - Tensor shape: [10240, 3840], Max rank: 3840. Using k=384 components.
Trying svd_lowrank

    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.422e+00, best=3.422e+00, lr=9.72e-03, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.412e+00, best=3.412e+00, lr=1.17e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.401e+00, best=3.401e+00, lr=1.40e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.387e+00, best=3.387e+00, lr=1.68e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.370e+00, best=3.370e+00, lr=2.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.350e+00, best=3.350e+00, lr=2.42e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.325e+00, best=3.325e+00, lr=2.90e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.296e+00, best=3.296e+00, lr=3.48e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.262e+00, best=3.262e+00, lr=4.18e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.220e+00, best=3.220e+00, lr=5.01e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.170e+00, best=3.170e+00, lr=6.02e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.110e+00, best=3.110e+00, lr=7.22e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=3.037e+00, best=3.037e+00, lr=8.66e-02, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.951e+00, best=2.951e+00, lr=1.04e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.847e+00, best=2.847e+00, lr=1.25e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.722e+00, best=2.722e+00, lr=1.50e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.572e+00, best=2.572e+00, lr=1.80e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.393e+00, best=2.393e+00, lr=2.16e-01, worse_count=0]
    Optimizing (Original):   0%|          | 0/50 [00:00<?, ?it/s, loss=2.177e+00, best=2.177e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=2.177e+00, best=2.177e+00, lr=2.59e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=1.918e+00, best=1.918e+00, lr=3.10e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=1.608e+00, best=1.608e+00, lr=3.73e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=1.235e+00, best=1.235e+00, lr=4.47e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=7.881e-01, best=7.881e-01, lr=5.36e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=2.516e-01, best=2.516e-01, lr=6.44e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=3.922e-01, best=2.516e-01, lr=6.12e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=2.194e-01, best=2.194e-01, lr=7.34e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=5.145e-01, best=2.194e-01, lr=6.97e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=1.828e-01, best=1.828e-01, lr=8.37e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=6.539e-01, best=1.828e-01, lr=7.95e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=1.409e-01, best=1.409e-01, lr=9.54e-01, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=8.129e-01, best=1.409e-01, lr=9.06e-01, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=9.323e-02, best=9.323e-02, lr=1.09e+00, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=9.941e-01, best=9.323e-02, lr=1.03e+00, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=3.886e-02, best=3.886e-02, lr=1.24e+00, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=1.201e+00, best=3.886e-02, lr=1.18e+00, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=2.312e-02, best=2.312e-02, lr=1.41e+00, worse_count=0]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=1.390e+00, best=2.312e-02, lr=1.34e+00, worse_count=1]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=4.754e-02, best=2.312e-02, lr=1.28e+00, worse_count=2]
    Optimizing (Original):  38%|███▊      | 19/50 [00:00<00:00, 184.30it/s, loss=1.228e+00, best=2.312e-02, lr=1.21e+00, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.74it/s, loss=1.228e+00, best=2.312e-02, lr=1.21e+00, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.74it/s, loss=1.623e-02, best=1.623e-02, lr=1.45e+00, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.74it/s, loss=1.438e+00, best=1.623e-02, lr=1.38e+00, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.74it/s, loss=5.646e-02, best=1.623e-02, lr=1.31e+00, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.74it/s, loss=1.256e+00, best=1.623e-02, lr=1.25e+00, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.74it/s, loss=9.142e-03, best=9.142e-03, lr=1.50e+00, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.74it/s, loss=1.487e+00, best=9.142e-03, lr=1.42e+00, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.74it/s, loss=6.565e-02, best=9.142e-03, lr=1.35e+00, worse_count=2]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.74it/s, loss=1.284e+00, best=9.142e-03, lr=1.28e+00, worse_count=3]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.74it/s, loss=1.850e-03, best=1.850e-03, lr=1.54e+00, worse_count=0]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.74it/s, loss=1.537e+00, best=1.850e-03, lr=1.46e+00, worse_count=1]
    Optimizing (Original):  78%|███████▊  | 39/50 [00:00<00:00, 190.74it/s, loss=7.510e-02, best=1.850e-03, lr=1.39e+00, worse_count=2]
                                                                                                                                       
(206/208) Skipping tensor: t_embedder.mlp.0.weight (Reason: In high-precision list)
(207/208) Skipping tensor: t_embedder.mlp.2.weight (Reason: In high-precision list)
(208/208) Skipping tensor: x_embedder.weight (Reason: In high-precision list)
Saved quantized model to: F:\models\diffusion_models\z_image_turbo_bf16_calib.safetensors
